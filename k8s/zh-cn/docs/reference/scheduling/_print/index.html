<!doctype html><html lang=zh-cn class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/reference/scheduling/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/reference/scheduling/><link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/reference/scheduling/><link rel=alternate hreflang=hi href=https://kubernetes.io/hi/docs/reference/scheduling/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/zh-cn/docs/reference/scheduling/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>调度 | Kubernetes</title><meta property="og:title" content="调度"><meta property="og:description" content="生产级别的容器编排系统"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/zh-cn/docs/reference/scheduling/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="调度"><meta itemprop=description content="生产级别的容器编排系统"><meta name=twitter:card content="summary"><meta name=twitter:title content="调度"><meta name=twitter:description content="生产级别的容器编排系统"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content=" "><meta property="og:description" content=" "><meta name=twitter:description content=" "><meta property="og:url" content="https://kubernetes.io/zh-cn/docs/reference/scheduling/"><meta property="og:title" content="调度"><meta name=twitter:title content="调度"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/zh-cn/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/zh-cn/docs/>文档</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh-cn/blog/>Kubernetes 博客</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh-cn/training/>培训</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh-cn/partners/>合作伙伴</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh-cn/community/>社区</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/zh-cn/case-studies/>案例分析</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>版本列表</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/zh-cn/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/zh-cn/docs/reference/scheduling/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/zh-cn/docs/reference/scheduling/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/zh-cn/docs/reference/scheduling/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/zh-cn/docs/reference/scheduling/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/zh-cn/docs/reference/scheduling/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>中文 (Chinese)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/reference/scheduling/>English</a>
<a class=dropdown-item href=/ko/docs/reference/scheduling/>한국어 (Korean)</a>
<a class=dropdown-item href=/ja/docs/reference/scheduling/>日本語 (Japanese)</a>
<a class=dropdown-item href=/hi/docs/reference/scheduling/>हिन्दी (Hindi)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>这是本节的多页打印视图。
<a href=# onclick="return print(),!1">点击此处打印</a>.</p><p><a href=/zh-cn/docs/reference/scheduling/>返回本页常规视图</a>.</p></div><h1 class=title>调度</h1><ul><li>1: <a href=#pg-ef4fb938b6b63c95f5f26f9b1cec3054>调度器配置</a></li><li>2: <a href=#pg-5a0a68fb6a7ffefb6d5f861100fa0ae3>调度策略</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-ef4fb938b6b63c95f5f26f9b1cec3054>1 - 调度器配置</h1><div style=margin-top:10px;margin-bottom:10px><b>特性状态：</b> <code>Kubernetes v1.25 [stable]</code></div><p>你可以通过编写配置文件，并将其路径传给 <code>kube-scheduler</code> 的命令行参数，定制 <code>kube-scheduler</code> 的行为。</p><p>调度模板（Profile）允许你配置 <a class=glossary-tooltip title='控制平面组件，负责监视新创建的、未指定运行节点的 Pod，选择节点让 Pod 在上面运行。' data-toggle=tooltip data-placement=top href=/zh-cn/docs/reference/command-line-tools-reference/kube-scheduler/ target=_blank aria-label=kube-scheduler>kube-scheduler</a>
中的不同调度阶段。每个阶段都暴露于某个扩展点中。插件通过实现一个或多个扩展点来提供调度行为。</p><p>你可以通过运行 <code>kube-scheduler --config &lt;filename></code> 来设置调度模板，
使用 KubeSchedulerConfiguration（<a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1beta3/>v1beta3</a>
或 <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1/>v1</a>）结构体。</p><p>最简单的配置如下：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>clientConnection</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>kubeconfig</span>:<span style=color:#bbb> </span>/etc/srv/kubernetes/kube-scheduler/kubeconfig<span style=color:#bbb>
</span></span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>说明：</strong><p>KubeSchedulerConfiguration <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1beta2/>v1beta2</a>
在 v1.25 中已弃用，并将在 v1.26 中移除。在将 Kubernetes 升级到 v1.25 之前，请将 KubeSchedulerConfiguration 迁移到
<a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1beta3/>v1beta3</a> 或 <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1/>v1</a>。</div><h2 id=profiles>配置文件</h2><p>通过调度配置文件，你可以配置 <a class=glossary-tooltip title='控制平面组件，负责监视新创建的、未指定运行节点的 Pod，选择节点让 Pod 在上面运行。' data-toggle=tooltip data-placement=top href=/zh-cn/docs/reference/command-line-tools-reference/kube-scheduler/ target=_blank aria-label=kube-scheduler>kube-scheduler</a> 在不同阶段的调度行为。
每个阶段都在一个<a href=#extension-points>扩展点</a>中公开。
<a href=#scheduling-plugins>调度插件</a>通过实现一个或多个扩展点，来提供调度行为。</p><p>你可以配置同一 <code>kube-scheduler</code> 实例使用<a href=#multiple-profiles>多个配置文件</a>。</p><h3 id=extensions-points>扩展点</h3><p>调度行为发生在一系列阶段中，这些阶段是通过以下扩展点公开的：</p><ol><li><code>queueSort</code>：这些插件对调度队列中的悬决的 Pod 排序。
一次只能启用一个队列排序插件。</li></ol><ol start=2><li><code>preFilter</code>：这些插件用于在过滤之前预处理或检查 Pod 或集群的信息。
它们可以将 Pod 标记为不可调度。</li></ol><ol start=3><li><code>filter</code>：这些插件相当于调度策略中的断言（Predicates），用于过滤不能运行 Pod 的节点。
过滤器的调用顺序是可配置的。
如果没有一个节点通过所有过滤器的筛选，Pod 将会被标记为不可调度。</li></ol><ol start=4><li><code>postFilter</code>：当无法为 Pod 找到可用节点时，按照这些插件的配置顺序调用他们。
如果任何 <code>postFilter</code> 插件将 Pod 标记为<strong>可调度</strong>，则不会调用其余插件。</li></ol><ol start=5><li><code>preScore</code>：这是一个信息扩展点，可用于预打分工作。</li></ol><ol start=6><li><code>score</code>：这些插件给通过筛选阶段的节点打分。调度器会选择得分最高的节点。</li></ol><ol start=7><li><code>reserve</code>：这是一个信息扩展点，当资源已经预留给 Pod 时，会通知插件。
这些插件还实现了 <code>Unreserve</code> 接口，在 <code>Reserve</code> 期间或之后出现故障时调用。</li></ol><ol start=8><li><code>permit</code>：这些插件可以阻止或延迟 Pod 绑定。</li></ol><ol start=9><li><code>preBind</code>：这些插件在 Pod 绑定节点之前执行。</li></ol><ol start=10><li><code>bind</code>：这个插件将 Pod 与节点绑定。<code>bind</code> 插件是按顺序调用的，只要有一个插件完成了绑定，其余插件都会跳过。<code>bind</code> 插件至少需要一个。</li></ol><ol start=11><li><code>postBind</code>：这是一个信息扩展点，在 Pod 绑定了节点之后调用。</li></ol><ol start=12><li><code>multiPoint</code>：这是一个仅配置字段，允许同时为所有适用的扩展点启用或禁用插件。</li></ol><p>对每个扩展点，你可以禁用<a href=#scheduling-plugins>默认插件</a>或者是启用自己的插件，例如：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>PodTopologySpread<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyCustomPluginA<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>2</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyCustomPluginB<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>你可以在 <code>disabled</code> 数组中使用 <code>*</code> 禁用该扩展点的所有默认插件。
如果需要，这个字段也可以用来对插件重新顺序。</p><h3 id=scheduling-plugins>调度插件</h3><p>下面默认启用的插件实现了一个或多个扩展点：</p><ul><li><p><code>ImageLocality</code>：选择已经存在 Pod 运行所需容器镜像的节点。</p><p>实现的扩展点：<code>score</code>。</p></li></ul><ul><li><p><code>TaintToleration</code>：实现了<a href=/zh-cn/docs/concepts/scheduling-eviction/taint-and-toleration/>污点和容忍</a>。</p><p>实现的扩展点：<code>filter</code>、<code>preScore</code>、<code>score</code>。</p></li></ul><ul><li><p><code>NodeName</code>：检查 Pod 指定的节点名称与当前节点是否匹配。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>NodePorts</code>：检查 Pod 请求的端口在节点上是否可用。</p><p>实现的扩展点：<code>preFilter</code>、<code>filter</code>。</p></li></ul><ul><li><p><code>NodeAffinity</code>：实现了<a href=/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#nodeselector>节点选择器</a>
和<a href=/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#node-affinity>节点亲和性</a>。</p><p>实现的扩展点：<code>filter</code>、<code>score</code>。</p></li></ul><ul><li><p><code>PodTopologySpread</code>：实现了 <a href=/zh-cn/docs/concepts/scheduling-eviction/topology-spread-constraints/>Pod 拓扑分布</a>。</p><p>实现的扩展点：<code>preFilter</code>、<code>filter</code>、<code>preScore</code>、<code>score</code>。</p></li></ul><ul><li><p><code>NodeUnschedulable</code>：过滤 <code>.spec.unschedulable</code> 值为 true 的节点。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>NodeResourcesFit</code>：检查节点是否拥有 Pod 请求的所有资源。
得分可以使用以下三种策略之一：<code>LeastAllocated</code>（默认）、<code>MostAllocated</code>
和 <code>RequestedToCapacityRatio</code>。</p><p>实现的扩展点：<code>preFilter</code>、<code>filter</code>、<code>score</code>。</p></li></ul><ul><li><p><code>NodeResourcesBalancedAllocation</code>：调度 Pod 时，选择资源使用更为均衡的节点。</p><p>实现的扩展点：<code>score</code>。</p></li></ul><ul><li><p><code>VolumeBinding</code>：检查节点是否有请求的卷，或是否可以绑定请求的<a class=glossary-tooltip title='包含可被 Pod 中容器访问的数据的目录。' data-toggle=tooltip data-placement=top href=/zh-cn/docs/concepts/storage/volumes/ target=_blank aria-label=卷>卷</a>。
实现的扩展点：<code>preFilter</code>、<code>filter</code>、<code>reserve</code>、<code>preBind</code> 和 <code>score</code>。</p><div class="alert alert-info note callout" role=alert><strong>说明：</strong><p>当 <code>VolumeCapacityPriority</code> 特性被启用时，<code>score</code> 扩展点也被启用。
它优先考虑可以满足所需卷大小的最小 PV。</div></li></ul><ul><li><p><code>VolumeRestrictions</code>：检查挂载到节点上的卷是否满足卷提供程序的限制。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>VolumeZone</code>：检查请求的卷是否在任何区域都满足。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>NodeVolumeLimits</code>：检查该节点是否满足 CSI 卷限制。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>EBSLimits</code>：检查节点是否满足 AWS EBS 卷限制。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>GCEPDLimits</code>：检查该节点是否满足 GCP-PD 卷限制。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>AzureDiskLimits</code>：检查该节点是否满足 Azure 卷限制。</p><p>实现的扩展点：<code>filter</code>。</p></li></ul><ul><li><p><code>InterPodAffinity</code>：实现 <a href=/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity>Pod 间亲和性与反亲和性</a>。</p><p>实现的扩展点：<code>preFilter</code>、<code>filter</code>、<code>preScore</code>、<code>score</code>。</p></li></ul><ul><li><p><code>PrioritySort</code>：提供默认的基于优先级的排序。</p><p>实现的扩展点：<code>queueSort</code>。</p></li></ul><ul><li><p><code>DefaultBinder</code>：提供默认的绑定机制。</p><p>实现的扩展点：<code>bind</code>。</p></li></ul><ul><li><p><code>DefaultPreemption</code>：提供默认的抢占机制。</p><p>实现的扩展点：<code>postFilter</code>。</p></li></ul><p>你也可以通过组件配置 API 启用以下插件（默认不启用）：</p><ul><li><code>CinderLimits</code>：检查是否可以满足节点的 <a href=https://docs.openstack.org/cinder/>OpenStack Cinder</a> 卷限制。
实现的扩展点：<code>filter</code>。</li></ul><h3 id=multiple-profiles>多配置文件</h3><p>你可以配置 <code>kube-scheduler</code> 运行多个配置文件。
每个配置文件都有一个关联的调度器名称，并且可以在其扩展点中配置一组不同的插件。</p><p>使用下面的配置样例，调度器将运行两个配置文件：一个使用默认插件，另一个禁用所有打分插件。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>default-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span><span style=color:#a2f;font-weight:700>no</span>-scoring-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>preScore</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;*&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;*&#39;</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>对于那些希望根据特定配置文件来进行调度的 Pod，可以在 <code>.spec.schedulerName</code> 字段指定相应的调度器名称。</p><p>默认情况下，将创建一个调度器名为 <code>default-scheduler</code> 的配置文件。
这个配置文件包括上面描述的所有默认插件。
声明多个配置文件时，每个配置文件中调度器名称必须唯一。</p><p>如果 Pod 未指定调度器名称，kube-apiserver 将会把调度器名设置为 <code>default-scheduler</code>。
因此，应该存在一个调度器名为 <code>default-scheduler</code> 的配置文件来调度这些 Pod。</p><div class="alert alert-info note callout" role=alert><strong>说明：</strong><p>Pod 的调度事件把 <code>.spec.schedulerName</code> 字段值作为 ReportingController。
领导者选举事件使用列表中第一个配置文件的调度器名称。</div><div class="alert alert-info note callout" role=alert><strong>说明：</strong><p>所有配置文件必须在 <code>queueSort</code> 扩展点使用相同的插件，并具有相同的配置参数（如果适用）。
这是因为调度器只有一个保存 pending 状态 Pod 的队列。</div><h3 id=multipoint>应用于多个扩展点的插件</h3><p>从 <code>kubescheduler.config.k8s.io/v1beta3</code> 开始，配置文件配置中有一个附加字段 <code>multiPoint</code>，它允许跨多个扩展点轻松启用或禁用插件。
<code>multiPoint</code> 配置的目的是简化用户和管理员在使用自定义配置文件时所需的配置。</p><p>考虑一个插件，<code>MyPlugin</code>，它实现了 <code>preScore</code>、<code>score</code>、<code>preFilter</code> 和 <code>filter</code> 扩展点。
要为其所有可用的扩展点启用 <code>MyPlugin</code>，配置文件配置如下所示：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>multipoint-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>multiPoint</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyPlugin<span style=color:#bbb>
</span></span></span></code></pre></div><p>这相当于为所有扩展点手动启用 <code>MyPlugin</code>，如下所示：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>non-multipoint-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>preScore</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyPlugin<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyPlugin<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>preFilter</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyPlugin<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>filter</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>MyPlugin<span style=color:#bbb>
</span></span></span></code></pre></div><p>在这里使用 <code>multiPoint</code> 的一个好处是，如果 <code>MyPlugin</code> 将来实现另一个扩展点，<code>multiPoint</code> 配置将自动为新扩展启用它。</p><p>可以使用该扩展点的 <code>disabled</code> 字段将特定扩展点从 <code>MultiPoint</code> 扩展中排除。
这适用于禁用默认插件、非默认插件或使用通配符 (<code>'*'</code>) 来禁用所有插件。
禁用 <code>Score</code> 和 <code>PreScore</code> 的一个例子是：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>non-multipoint-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>multiPoint</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;MyPlugin&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>preScore</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;*&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;*&#39;</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>从 <code>kubescheduler.config.k8s.io/v1beta3</code> 开始，所有<a href=#scheduling-plugins>默认插件</a>都通过 <code>MultiPoint</code> 在内部启用。
但是，仍然可以使用单独的扩展点来灵活地重新配置默认值（例如排序和分数权重）。
例如，考虑两个 Score 插件 <code>DefaultScore1</code> 和 <code>DefaultScore2</code>，每个插件的权重为 <code>1</code>。
它们可以用不同的权重重新排序，如下所示：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>multipoint-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultScore2&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>5</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>在这个例子中，没有必要在 <code>MultiPoint</code> 中明确指定插件，因为它们是默认插件。
<code>Score</code> 中指定的唯一插件是 <code>DefaultScore2</code>。
这是因为通过特定扩展点设置的插件将始终优先于 <code>MultiPoint</code> 插件。
因此，此代码段实质上重新排序了这两个插件，而无需同时指定它们。</p><p>配置 <code>MultiPoint</code> 插件时优先级的一般层次结构如下：</p><ol><li>特定的扩展点首先运行，它们的设置会覆盖其他地方的设置</li><li>通过 <code>MultiPoint</code> 手动配置的插件及其设置</li><li>默认插件及其默认设置</li></ol><p>为了演示上述层次结构，以下示例基于这些插件：</p><table><thead><tr><th>插件</th><th>扩展点</th></tr></thead><tbody><tr><td><code>DefaultQueueSort</code></td><td><code>QueueSort</code></td></tr><tr><td><code>CustomQueueSort</code></td><td><code>QueueSort</code></td></tr><tr><td><code>DefaultPlugin1</code></td><td><code>Score</code>, <code>Filter</code></td></tr><tr><td><code>DefaultPlugin2</code></td><td><code>Score</code></td></tr><tr><td><code>CustomPlugin1</code></td><td><code>Score</code>, <code>Filter</code></td></tr><tr><td><code>CustomPlugin2</code></td><td><code>Score</code>, <code>Filter</code></td></tr></tbody></table><p>这些插件的一个有效示例配置是：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>multipoint-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>multiPoint</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;CustomQueueSort&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;CustomPlugin1&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;CustomPlugin2&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultQueueSort&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>filter</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultPlugin1&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultPlugin2&#39;</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>请注意，在特定扩展点中重新声明 <code>MultiPoint</code> 插件不会出错。
重新声明被忽略（并记录），因为特定的扩展点优先。</p><p>除了将大部分配置保存在一个位置之外，此示例还做了一些事情：</p><ul><li>启用自定义 <code>queueSort</code> 插件并禁用默认插件</li><li>启用 <code>CustomPlugin1</code> 和 <code>CustomPlugin2</code>，这将首先为它们的所有扩展点运行</li><li>禁用 <code>DefaultPlugin1</code>，但仅适用于 <code>filter</code></li><li>重新排序 <code>DefaultPlugin2</code> 以在 <code>score</code> 中首先运行（甚至在自定义插件之前）</li></ul><p>在 <code>v1beta3</code> 之前的配置版本中，没有 <code>multiPoint</code>，上面的代码片段等同于：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1beta2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>schedulerName</span>:<span style=color:#bbb> </span>multipoint-scheduler<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>plugins</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#080;font-style:italic># 禁用默认的 QueueSort 插件</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>queueSort</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;CustomQueueSort&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultQueueSort&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#080;font-style:italic># 启用自定义的 Filter 插件</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>filter</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;CustomPlugin1&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;CustomPlugin2&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultPlugin2&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>disabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultPlugin1&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:#080;font-style:italic># 启用并重新排序自定义的打分插件</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>score</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>enabled</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultPlugin2&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span><span style=color:#b44>&#39;DefaultPlugin1&#39;</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>3</span><span style=color:#bbb>
</span></span></span></code></pre></div><p>虽然这是一个复杂的例子，但它展示了 <code>MultiPoint</code> 配置的灵活性以及它与配置扩展点的现有方法的无缝集成。</p><h2 id=scheduler-configuration-migrations>调度程序配置迁移</h2><ul class="nav nav-tabs" id=tab-with-md role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#tab-with-md-0 role=tab aria-controls=tab-with-md-0 aria-selected=true>v1beta1 → v1beta2</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#tab-with-md-1 role=tab aria-controls=tab-with-md-1>v1beta2 → v1beta3</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#tab-with-md-2 role=tab aria-controls=tab-with-md-2>v1beta3 → v1</a></li></ul><div class=tab-content id=tab-with-md><div id=tab-with-md-0 class="tab-pane show active" role=tabpanel aria-labelledby=tab-with-md-0><p><ul><li><p>在 v1beta2 配置版本中，你可以为 <code>NodeResourcesFit</code> 插件使用新的 score 扩展。
新的扩展结合了 <code>NodeResourcesLeastAllocated</code>、<code>NodeResourcesMostAllocated</code> 和 <code>RequestedToCapacityRatio</code> 插件的功能。
例如，如果你之前使用了 <code>NodeResourcesMostAllocated</code> 插件，
则可以改用 <code>NodeResourcesFit</code>（默认启用）并添加一个 <code>pluginConfig</code> 和 <code>scoreStrategy</code>，类似于：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>kubescheduler.config.k8s.io/v1beta2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>KubeSchedulerConfiguration<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>profiles</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>- <span style=color:green;font-weight:700>pluginConfig</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>args</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>scoringStrategy</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>resources</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>cpu<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>          </span><span style=color:green;font-weight:700>weight</span>:<span style=color:#bbb> </span><span style=color:#666>1</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>type</span>:<span style=color:#bbb> </span>MostAllocated<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>NodeResourcesFit<span style=color:#bbb>
</span></span></span></code></pre></div></li></ul><ul><li>调度器插件 <code>NodeLabel</code> 已弃用；
相反，要使用 <a href=/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#affinity-and-anti-affinity><code>NodeAffinity</code></a>
插件（默认启用）来实现类似的行为。</li></ul><ul><li>调度程序插件 <code>ServiceAffinity</code> 已弃用；
相反，使用 <a href=/zh-cn/docs/concepts/scheduling-eviction/assign-pod-node/#inter-pod-affinity-and-anti-affinity><code>InterPodAffinity</code></a>
插件（默认启用）来实现类似的行为。</li></ul><ul><li>调度器插件 <code>NodePreferAvoidPods</code> 已弃用；
相反，使用 <a href=/zh-cn/docs/concepts/scheduling-eviction/taint-and-toleration/>节点污点</a> 来实现类似的行为。</li></ul><ul><li>在 v1beta2 配置文件中启用的插件优先于该插件的默认配置。</li></ul><ul><li>调度器的健康检查和审计的绑定地址，所配置的 <code>host</code> 或 <code>port</code> 无效将导致验证失败。</li></ul></div><div id=tab-with-md-1 class=tab-pane role=tabpanel aria-labelledby=tab-with-md-1><p><ul><li>默认增加三个插件的权重：<ul><li><code>InterPodAffinity</code> 从 1 到 2</li><li><code>NodeAffinity</code> 从 1 到 2</li><li><code>TaintToleration</code> 从 1 到 3</li></ul></li></ul></div><div id=tab-with-md-2 class=tab-pane role=tabpanel aria-labelledby=tab-with-md-2><p><ul><li>调度器插件 <code>SelectorSpread</code> 被移除，改为使用 <code>PodTopologySpread</code> 插件（默认启用）来实现类似的行为。</li></ul></div></div><h2 id=接下来>接下来</h2><ul><li>阅读 <a href=/zh-cn/docs/reference/command-line-tools-reference/kube-scheduler/>kube-scheduler 参考</a></li><li>了解<a href=/zh-cn/docs/concepts/scheduling-eviction/kube-scheduler/>调度</a></li><li>阅读 <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1beta2/>kube-scheduler 配置 (v1beta2)</a> 参考</li><li>阅读 <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1beta3/>kube-scheduler 配置 (v1beta3)</a> 参考</li><li>阅读 <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1/>kube-scheduler 配置 (v1)</a> 参考</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-5a0a68fb6a7ffefb6d5f861100fa0ae3>2 - 调度策略</h1><p>在 Kubernetes v1.23 版本之前，可以使用调度策略来指定 <strong>predicates</strong> 和 <strong>priorities</strong> 进程。
例如，可以通过运行 <code>kube-scheduler --policy-config-file &lt;filename></code> 或者
<code>kube-scheduler --policy-configmap &lt;ConfigMap></code> 设置调度策略。</p><p>但是从 Kubernetes v1.23 版本开始，不再支持这种调度策略。
同样地也不支持相关的 <code>policy-config-file</code>、<code>policy-configmap</code>、<code>policy-configmap-namespace</code> 和 <code>use-legacy-policy-config</code> 标志。
你可以通过使用<a href=/zh-cn/docs/reference/scheduling/config/>调度配置</a>来实现类似的行为。</p><h2 id=接下来>接下来</h2><ul><li>了解<a href=/zh-cn/docs/concepts/scheduling-eviction/kube-scheduler/>调度</a></li><li>了解 <a href=/zh-cn/docs/reference/scheduling/config/>kube-scheduler 配置</a></li><li>阅读 <a href=/zh-cn/docs/reference/config-api/kube-scheduler-config.v1/>kube-scheduler 配置参考 (v1)</a></li></ul></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/zh-cn/docs/home/>主页</a>
<a class=text-white href=/zh-cn/blog/>博客</a>
<a class=text-white href=/zh-cn/training/>培训</a>
<a class=text-white href=/zh-cn/partners/>合作伙伴</a>
<a class=text-white href=/zh-cn/community/>社区</a>
<a class=text-white href=/zh-cn/case-studies/>案例分析</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes 作者 | 文档发布基于 <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a> 授权许可</small><br><small class=text-white>Copyright &copy; 2023 Linux 基金会&reg;。保留所有权利。Linux 基金会已注册并使用商标。如需了解 Linux 基金会的商标列表，请访问<a href=https://www.linuxfoundation.org/trademark-usage class=light-text>商标使用页面</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>