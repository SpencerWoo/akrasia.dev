<!doctype html><html lang=pt-br class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/setup/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/docs/setup/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/setup/><link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/setup/><link rel=alternate hreflang=fr href=https://kubernetes.io/fr/docs/setup/><link rel=alternate hreflang=de href=https://kubernetes.io/de/docs/setup/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/setup/><link rel=alternate hreflang=id href=https://kubernetes.io/id/docs/setup/><link rel=alternate hreflang=hi href=https://kubernetes.io/hi/docs/setup/><link rel=alternate hreflang=ru href=https://kubernetes.io/ru/docs/setup/><link rel=alternate hreflang=pl href=https://kubernetes.io/pl/docs/setup/><link rel=alternate hreflang=uk href=https://kubernetes.io/uk/docs/setup/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/pt-br/docs/setup/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>Instalação | Kubernetes</title><meta property="og:title" content="Instalação"><meta property="og:description" content="Orquestração de contêineres em nível de produção"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/pt-br/docs/setup/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="Instalação"><meta itemprop=description content="Orquestração de contêineres em nível de produção"><meta name=twitter:card content="summary"><meta name=twitter:title content="Instalação"><meta name=twitter:description content="Orquestração de contêineres em nível de produção"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content="Essa seção lista as diferentes formas de instalar e executar o Kubernetes. Quando você realiza a instalação de um cluster Kubernetes, deve decidir o tipo de instalação baseado em critérios como facilidade de manutenção, segurança, controle, quantidade de recursos disponíveis e a experiência necessária para gerenciar e operar o cluster.
Você pode criar um cluster Kubernetes em uma máquina local, na nuvem, em um datacenter on-premises ou ainda escolher uma oferta de um cluster Kubernetes gerenciado pelo seu provedor de computação em nuvem."><meta property="og:description" content="Essa seção lista as diferentes formas de instalar e executar o Kubernetes. Quando você realiza a instalação de um cluster Kubernetes, deve decidir o tipo de instalação baseado em critérios como facilidade de manutenção, segurança, controle, quantidade de recursos disponíveis e a experiência necessária para gerenciar e operar o cluster.
Você pode criar um cluster Kubernetes em uma máquina local, na nuvem, em um datacenter on-premises ou ainda escolher uma oferta de um cluster Kubernetes gerenciado pelo seu provedor de computação em nuvem."><meta name=twitter:description content="Essa seção lista as diferentes formas de instalar e executar o Kubernetes. Quando você realiza a instalação de um cluster Kubernetes, deve decidir o tipo de instalação baseado em critérios como facilidade de manutenção, segurança, controle, quantidade de recursos disponíveis e a experiência necessária para gerenciar e operar o cluster.
Você pode criar um cluster Kubernetes em uma máquina local, na nuvem, em um datacenter on-premises ou ainda escolher uma oferta de um cluster Kubernetes gerenciado pelo seu provedor de computação em nuvem."><meta property="og:url" content="https://kubernetes.io/pt-br/docs/setup/"><meta property="og:title" content="Instalação"><meta name=twitter:title content="Instalação"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/pt-br/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/pt-br/docs/>Documentação</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/pt-br/blog/>Kubernetes Blog</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/pt-br/partners/>Parceiros</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/pt-br/community/>Comunidade</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/pt-br/case-studies/>Casos de estudo</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Versões</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/pt-br/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/pt-br/docs/setup/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/pt-br/docs/setup/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/pt-br/docs/setup/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/pt-br/docs/setup/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/pt-br/docs/setup/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Português (Portuguese)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/setup/>English</a>
<a class=dropdown-item href=/zh-cn/docs/setup/>中文 (Chinese)</a>
<a class=dropdown-item href=/ko/docs/setup/>한국어 (Korean)</a>
<a class=dropdown-item href=/ja/docs/setup/>日本語 (Japanese)</a>
<a class=dropdown-item href=/fr/docs/setup/>Français (French)</a>
<a class=dropdown-item href=/de/docs/setup/>Deutsch (German)</a>
<a class=dropdown-item href=/es/docs/setup/>Español (Spanish)</a>
<a class=dropdown-item href=/id/docs/setup/>Bahasa Indonesia</a>
<a class=dropdown-item href=/hi/docs/setup/>हिन्दी (Hindi)</a>
<a class=dropdown-item href=/ru/docs/setup/>Русский (Russian)</a>
<a class=dropdown-item href=/pl/docs/setup/>Polski (Polish)</a>
<a class=dropdown-item href=/uk/docs/setup/>Українська (Ukrainian)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>Essa é a versão completa de impressão dessa seção
<a href=# onclick="return print(),!1">Clique aqui para imprimir</a>.</p><p><a href=/pt-br/docs/setup/>Retornar à visualização normal</a>.</p></div><h1 class=title>Instalação</h1><ul><li>1: <a href=#pg-29e59491dd6118b23072dfe9ebb93323>Instalando a ferramenta kubeadm</a></li><li>2: <a href=#pg-478acca1934b6d89a0bc00fb25bfe5b6>Instalando Kubernetes com kOps</a></li><li>3: <a href=#pg-d2f55eefe7222b7c637875af9c3ec199>Soluções de Nuvem Prontas para uso</a></li></ul><div class=content><p>Essa seção lista as diferentes formas de instalar e executar o Kubernetes. Quando você realiza a instalação de um cluster Kubernetes, deve decidir o tipo de instalação baseado em critérios como facilidade de manutenção, segurança, controle, quantidade de recursos disponíveis e a experiência necessária para gerenciar e operar o cluster.</p><p>Você pode criar um cluster Kubernetes em uma máquina local, na nuvem, em um datacenter on-premises ou ainda escolher uma oferta de um cluster Kubernetes gerenciado pelo seu provedor de computação em nuvem.</p><p>Existem ainda diversos outros tipos de soluções customizadas, que você pode se deparar ao buscar formas de instalação e gerenciamento de seu cluster.</p><h2 id=ambientes-de-aprendizado>Ambientes de aprendizado</h2><p>Se você está aprendendo ou pretende aprender mais sobre o Kubernetes, use ferramentas suportadas pela comunidade, ou ferramentas no ecossistema que te permitam criar um cluster Kubernetes em sua máquina virtual.</p><p>Temos como exemplo aqui o <a href=/docs/tasks/tools/install-minikube/>Minikube</a> e o <a href=https://kind.sigs.k8s.io/docs/user/quick-start/>KinD</a></p><h2 id=ambientes-de-produção>Ambientes de produção</h2><p>Ao analisar uma solução para um ambiente de produção, devem ser considerados quais aspectos de operação de um cluster Kubernetes você deseja gerenciar, ou então delegar ao seu provedor.</p><p>Temos diversas opções para esse provisionamento, desde o uso de uma ferramenta de deployment de um cluster tal qual o <a href=/docs/setup/production-environment/tools/kubeadm/install-kubeadm/>Kubeadm</a> ou o <a href=/docs/setup/production-environment/tools/kubespray/>Kubespray</a> quando se trata de um cluster local, ou ainda o uso de um cluster gerenciado por seu provedor de nuvem.</p><p>Para a escolha do melhor ambiente e da melhor forma para fazer essa instalação, você deve considerar:</p><ul><li>Se você deseja se preocupar com a gestão de backup da sua estrutura do ambiente de gerenciamento</li><li>Se você deseja ter um cluster mais atualizado, com novas funcionalidades, ou se deseja seguir a versão suportada pelo fornecedor</li><li>Se você deseja ter um cluster com um alto nível de serviço, ou com auto provisionamento de alta disponibilidade</li><li>Quanto você deseja pagar por essa produção</li></ul></div></div><div class=td-content style=page-break-before:always><h1 id=pg-29e59491dd6118b23072dfe9ebb93323>1 - Instalando a ferramenta kubeadm</h1><p><img src=https://raw.githubusercontent.com/kubernetes/kubeadm/master/logos/stacked/color/kubeadm-stacked-color.png align=right width=150px>Essa página mostra o processo de instalação do conjunto de ferramentas <code>kubeadm</code>.
Para mais informações sobre como criar um cluster com o kubeadm após efetuar a instalação, veja a página <a href=/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/>Utilizando kubeadm para criar um cluster</a>.</p><h2 id=antes-de-você-começar>Antes de você começar</h2><ul><li>Uma máquina com sistema operacional Linux compatível. O projeto Kubernetes provê instruções para distribuições Linux baseadas em Debian e Red Hat, bem como para distribuições sem um gerenciador de pacotes.</li><li>2 GB ou mais de RAM por máquina (menos que isso deixará pouca memória para as suas aplicações).</li><li>2 CPUs ou mais.</li><li>Conexão de rede entre todas as máquinas no cluster. Seja essa pública ou privada.</li><li>Nome da máquina na rede, endereço MAC e producy_uuid únicos para cada nó. Mais detalhes podem ser lidos <a href=#veficiar-endereco-mac>aqui</a>.</li><li>Portas específicas abertas nas suas máquinas. Você poderá ler quais são <a href=#verificar-portas-necessarias>aqui</a>.</li><li>Swap desabilitado. Você <em>precisa</em> desabilitar a funcionalidade de swap para que o kubelet funcione de forma correta.</li></ul><h2 id=veficiar-endereco-mac>Verificando se o endereço MAC e o product_uiid são únicos para cada nó</h2><ul><li>Você pode verificar o endereço MAC da interface de rede utilizando o comando <code>ip link</code> ou o comando <code>ipconfig -a</code>.</li><li>O product_uuid pode ser verificado utilizando o comando <code>sudo cat /sys/class/dmi/id/product_uuid</code>.</li></ul><p>É provável que dispositivos físicos possuam endereços únicos. No entanto, é possível que algumas máquinas virtuais possuam endereços iguais. O Kubernetes utiliza esses valores para identificar unicamente os nós em um cluster. Se esses valores não forem únicos para cada nó, o processo de instalação pode <a href=https://github.com/kubernetes/kubeadm/issues/31>falhar</a>.</p><h2 id=verificando-os-adaptadores-de-rede>Verificando os adaptadores de rede</h2><p>Se você possuir mais de um adaptador de rede, e seus componentes Kubernetes não forem acessíveis através da rota padrão, recomendamos adicionar o IP das rotas para que os endereços do cluster Kubernetes passem pelo adaptador correto.</p><h2 id=fazendo-com-que-o-iptables-enxergue-o-tráfego-agregado>Fazendo com que o iptables enxergue o tráfego agregado</h2><p>Assegure-se de que o módulo <code>br_netfilter</code> está carregado. Isso pode ser feito executando o comando <code>lsmod | grep br_netfilter</code>. Para carrega-lo explicitamente execute <code>sudo modprobe br_netfilter</code>.</p><p>Como um requisito para que seus nós Linux enxerguem corretamente o tráfego agregado de rede, você deve garantir que a configuração <code>net.bridge.bridge-nf-call-iptables</code> do seu <code>sysctl</code> está configurada com valor 1. Como no exemplo abaixo:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | sudo tee /etc/modules-load.d/k8s.conf
</span></span></span><span style=display:flex><span><span style=color:#b44>br_netfilter
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | sudo tee /etc/sysctl.d/k8s.conf
</span></span></span><span style=display:flex><span><span style=color:#b44>net.bridge.bridge-nf-call-ip6tables = 1
</span></span></span><span style=display:flex><span><span style=color:#b44>net.bridge.bridge-nf-call-iptables = 1
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span><span style=display:flex><span>sudo sysctl --system
</span></span></code></pre></div><p>Para mais detalhes veja a página <a href=/pt-br/docs/concepts/extend-kubernetes/compute-storage-net/network-plugins/#network-plugin-requirements>Requisitos do plugin de rede</a>.</p><h2 id=verificando-as-portas-necessárias>Verificando as portas necessárias</h2><p>As portas listadas <a href=https://kubernetes.io/docs/reference/ports-and-protocols/>aqui</a> precisam estar abertas para que os componentes do Kubernetes se comuniquem uns com os outros.</p><p>O plugin de rede dos pods que você utiliza também pode requer que algumas portas estejam abertas. Dito que essas portas podem diferir dependendo do plugin, por favor leia a documentação dos plugins sobre quais portas serão necessárias abrir.</p><h2 id=instalando-agente-de-execucao>Instalando o agente de execução de contêineres</h2><p>Para executar os contêineres nos Pods, o Kubernetes utiliza um
<a class=glossary-tooltip title='O agente de execução de contêiner é o software responsável por executar os contêineres.' data-toggle=tooltip data-placement=top href=/docs/setup/production-environment/container-runtimes target=_blank aria-label='agente de execução'>agente de execução</a>.</p><ul class="nav nav-tabs" id=container-runtime role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#container-runtime-0 role=tab aria-controls=container-runtime-0 aria-selected=true>Nós Linux</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#container-runtime-1 role=tab aria-controls=container-runtime-1>Outros sistemas operacionais</a></li></ul><div class=tab-content id=container-runtime><div id=container-runtime-0 class="tab-pane show active" role=tabpanel aria-labelledby=container-runtime-0><p><p>Por padrão, o Kubernetes utiliza a <a class=glossary-tooltip title='Uma API para agentes de execução de contêineres se integrarem com o kubelet' data-toggle=tooltip data-placement=top href=/docs/concepts/overview/components/#container-runtime target=_blank aria-label='interface do agente de execução'>interface do agente de execução</a> (CRI) para interagir com o seu agente de execução de contêiner escolhido.</p><p>Se você não especificar nenhum agente de execução, o kubeadm irá tentar identifica-lo automaticamente através de uma lista dos sockets Unix mais utilizados. A tabela a seguir lista os agentes de execução e os caminhos dos sockets a eles associados.</p><table><caption style=display:none>Agentes de execução e seus caminhos de socket</caption><thead><tr><th>Agente de execução</th><th>Caminho do socket Unix</th></tr></thead><tbody><tr><td>Docker</td><td><code>/var/run/dockershim.sock</code></td></tr><tr><td>containerd</td><td><code>/run/containerd/containerd.sock</code></td></tr><tr><td>CRI-O</td><td><code>/var/run/crio/crio.sock</code></td></tr></tbody></table><br>Se tanto o Docker quanto o containerd forem detectados no sistema, o Docker terá precedência. Isso acontece porque o Docker, desde a versão 18.09, já incluí o containerd e ambos são detectaveis mesmo que você só tenha instalado o Docker. Se outros dois ou mais agentes de execução forem detectados, o kubeadm é encerrado com um erro.<p>O kubelet se integra com o Docker através da implementação CRI <code>dockershim</code> já inclusa.</p><p>Veja a página dos <a href=/docs/setup/production-environment/container-runtimes/>agentes de execução</a>
para mais detalhes.</p></div><div id=container-runtime-1 class=tab-pane role=tabpanel aria-labelledby=container-runtime-1><p><p>Por padrão, o kubeadm utiliza o <a class=glossary-tooltip title='Docker é uma tecnologia utilizada para prover virtualização a nível do sistema operacional também conhecidoa como containers.' data-toggle=tooltip data-placement=top href=https://docs.docker.com/engine/ target=_blank aria-label=Docker>Docker</a> como agente de execução.
O kubelet se integra com o Docker através da implementação CRI <code>dockershim</code> já inclusa.</p><p>Veja a página dos <a href=/docs/setup/production-environment/container-runtimes/>agentes de execução</a>
para mais detalhes.</p></div></div><h2 id=instalando-o-kubeadm-kubelet-e-o-kubectl>Instalando o kubeadm, kubelet e o kubectl</h2><p>Você instalará esses pacotes em todas as suas máquinas:</p><ul><li><p><code>kubeadm</code>: o comando para criar o cluster.</p></li><li><p><code>kubelet</code>: o componente que executa em todas as máquinas no seu cluster e cuida de tarefas como a inicialização de pods e contêineres.</p></li><li><p><code>kubectl</code>: a ferramenta de linha de comando para interação com o cluster.</p></li></ul><p>O kubeadm <strong>não irá</strong> instalar ou gerenciar o <code>kubelet</code> ou o <code>kubectl</code> para você, então você
precisará garantir que as versões deles são as mesmas da versão da camada de gerenciamento do Kubernetes
que você quer que o kubeadm instale. Caso isso não seja feito, surge o risco de que uma diferença nas versões
leve a bugs e comportamentos inesperados. Dito isso, <em>uma</em> diferença de menor grandeza nas versões entre o kubelet e a
camada de gerenciamento é suportada, mas a versão do kubelet nunca poderá ser superior à versão do servidor da API.
Por exemplo, um kubelet com a versão 1.7.0 será totalmente compatível com a versão 1.8.0 do servidor da API, mas o contrário não será verdadeiro.</p><p>Para mais informações acerca da instalação do <code>kubectl</code>, veja <a href=/docs/tasks/tools/>Instale e configure o kubectl</a>.</p><div class="alert alert-danger warning callout" role=alert><strong>Aviso:</strong> Essas instruções removem todos os pacotes Kubernetes de quaisquer atualizações de sistema.
Isso ocorre porque o kubeadm e o Kubernetes requerem alguns <a href=/docs/tasks/administer-cluster/kubeadm/kubeadm-upgrade/>cuidados especiais para serem atualizados</a>.</div><p>Para mais detalhes sobre compatibilidade entre as versões, veja:</p><ul><li><a href=/docs/setup/release/version-skew-policy/>Políticas de versão e compatibilidade entre versões</a> do Kubernetes.</li><li><a href=/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/#version-skew-policy>Compatibilidade entre versões</a> do Kubeadm.</li></ul><ul class="nav nav-tabs" id=k8s-install role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#k8s-install-0 role=tab aria-controls=k8s-install-0 aria-selected=true>Distribuições Debian</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#k8s-install-1 role=tab aria-controls=k8s-install-1>Distribuições Red Hat</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#k8s-install-2 role=tab aria-controls=k8s-install-2>Sem um gerenciador de pacotes</a></li></ul><div class=tab-content id=k8s-install><div id=k8s-install-0 class="tab-pane show active" role=tabpanel aria-labelledby=k8s-install-0><p><ol><li><p>Atualize o índice de pacotes <code>apt</code> e instale os pacotes necessários para utilizar o repositório <code>apt</code> do Kubernetes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span>sudo apt-get install -y apt-transport-https ca-certificates curl
</span></span></code></pre></div></li><li><p>Faça o download da chave de assinatura pública da Google Cloud:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://packages.cloud.google.com/apt/doc/apt-key.gpg
</span></span></code></pre></div></li><li><p>Adicione o repositório <code>apt</code> do Kubernetes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://apt.kubernetes.io/ kubernetes-xenial main&#34;</span> | sudo tee /etc/apt/sources.list.d/kubernetes.list
</span></span></code></pre></div></li><li><p>Atualize o índice de pacotes <code>apt</code>, instale o kubelet, o kubeadm e o kubectl, e fixe suas versões:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo apt-get update
</span></span><span style=display:flex><span>sudo apt-get install -y kubelet kubeadm kubectl
</span></span><span style=display:flex><span>sudo apt-mark hold kubelet kubeadm kubectl
</span></span></code></pre></div></li></ol></div><div id=k8s-install-1 class=tab-pane role=tabpanel aria-labelledby=k8s-install-1><p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | sudo tee /etc/yum.repos.d/kubernetes.repo
</span></span></span><span style=display:flex><span><span style=color:#b44>[kubernetes]
</span></span></span><span style=display:flex><span><span style=color:#b44>name=Kubernetes
</span></span></span><span style=display:flex><span><span style=color:#b44>baseurl=https://packages.cloud.google.com/yum/repos/kubernetes-el7-\$basearch
</span></span></span><span style=display:flex><span><span style=color:#b44>enabled=1
</span></span></span><span style=display:flex><span><span style=color:#b44>gpgcheck=1
</span></span></span><span style=display:flex><span><span style=color:#b44>repo_gpgcheck=1
</span></span></span><span style=display:flex><span><span style=color:#b44>gpgkey=https://packages.cloud.google.com/yum/doc/rpm-package-key.gpg
</span></span></span><span style=display:flex><span><span style=color:#b44>exclude=kubelet kubeadm kubectl
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Set SELinux in permissive mode (effectively disabling it)</span>
</span></span><span style=display:flex><span>sudo setenforce <span style=color:#666>0</span>
</span></span><span style=display:flex><span>sudo sed -i <span style=color:#b44>&#39;s/^SELINUX=enforcing$/SELINUX=permissive/&#39;</span> /etc/selinux/config
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo yum install -y kubelet kubeadm kubectl --disableexcludes<span style=color:#666>=</span>kubernetes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sudo systemctl <span style=color:#a2f>enable</span> --now kubelet
</span></span></code></pre></div><p><strong>Avisos:</strong></p><ul><li><p>Colocar o SELinux em modo permissivo ao executar <code>setenforce 0</code> e <code>sed ...</code> efetivamente o desabilita.
Isso é necessário para permitir que os contêineres acessem o sistema de arquivos do hospedeiro, que é utilizado pelas redes dos pods por exemplo.
Você precisará disso até que o suporte ao SELinux seja melhorado no kubelet.</p></li><li><p>Você pode deixar o SELinux habilitado se você souber como configura-lo, mas isso pode exegir configurações que não são suportadas pelo kubeadm.</p></li></ul></div><div id=k8s-install-2 class=tab-pane role=tabpanel aria-labelledby=k8s-install-2><p><p>Instale os plugins CNI (utilizados por grande parte das redes de pods):</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#b8860b>CNI_VERSION</span><span style=color:#666>=</span><span style=color:#b44>&#34;v0.8.2&#34;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>ARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
</span></span><span style=display:flex><span>sudo mkdir -p /opt/cni/bin
</span></span><span style=display:flex><span>curl -L <span style=color:#b44>&#34;https://github.com/containernetworking/plugins/releases/download/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CNI_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/cni-plugins-linux-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ARCH</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CNI_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>.tgz&#34;</span> | sudo tar -C /opt/cni/bin -xz
</span></span></code></pre></div><p>Escolha o diretório para baixar os arquivos de comandos.</p><div class="alert alert-info note callout" role=alert><strong>Nota:</strong> A variável <code>DOWNLOAD_DIR</code> precisa estar configurada para um diretório que permita escrita.
Se você estiver utilizando o Flatcar Container Linux, configure a váriavel de ambiente <code>DOWNLOAD_DIR=/opt/bin</code>.</div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#b8860b>DOWNLOAD_DIR</span><span style=color:#666>=</span>/usr/local/bin
</span></span><span style=display:flex><span>sudo mkdir -p <span style=color:#b8860b>$DOWNLOAD_DIR</span>
</span></span></code></pre></div><p>Instale o crictl (utilizado pelo kubeadm e pela Interface do Agente de execução do Kubelet (CRI))</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#b8860b>CRICTL_VERSION</span><span style=color:#666>=</span><span style=color:#b44>&#34;v1.22.0&#34;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>ARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
</span></span><span style=display:flex><span>curl -L <span style=color:#b44>&#34;https://github.com/kubernetes-sigs/cri-tools/releases/download/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CRICTL_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/crictl-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>CRICTL_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>-linux-</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ARCH</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>.tar.gz&#34;</span> | sudo tar -C <span style=color:#b8860b>$DOWNLOAD_DIR</span> -xz
</span></span></code></pre></div><p>Instale o <code>kubeadm</code>, o <code>kubelet</code>, e o <code>kubectl</code> e adicione o serviço systemd <code>kubelet</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#b8860b>RELEASE</span><span style=color:#666>=</span><span style=color:#b44>&#34;</span><span style=color:#a2f;font-weight:700>$(</span>curl -sSL https://dl.k8s.io/release/stable.txt<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>ARCH</span><span style=color:#666>=</span><span style=color:#b44>&#34;amd64&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a2f>cd</span> <span style=color:#b8860b>$DOWNLOAD_DIR</span>
</span></span><span style=display:flex><span>sudo curl -L --remote-name-all https://storage.googleapis.com/kubernetes-release/release/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>RELEASE</span><span style=color:#b68;font-weight:700>}</span>/bin/linux/<span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>ARCH</span><span style=color:#b68;font-weight:700>}</span>/<span style=color:#666>{</span>kubeadm,kubelet,kubectl<span style=color:#666>}</span>
</span></span><span style=display:flex><span>sudo chmod +x <span style=color:#666>{</span>kubeadm,kubelet,kubectl<span style=color:#666>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#b8860b>RELEASE_VERSION</span><span style=color:#666>=</span><span style=color:#b44>&#34;v0.4.0&#34;</span>
</span></span><span style=display:flex><span>curl -sSL <span style=color:#b44>&#34;https://raw.githubusercontent.com/kubernetes/release/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>RELEASE_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/cmd/kubepkg/templates/latest/deb/kubelet/lib/systemd/system/kubelet.service&#34;</span> | sed <span style=color:#b44>&#34;s:/usr/bin:</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>DOWNLOAD_DIR</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>:g&#34;</span> | sudo tee /etc/systemd/system/kubelet.service
</span></span><span style=display:flex><span>sudo mkdir -p /etc/systemd/system/kubelet.service.d
</span></span><span style=display:flex><span>curl -sSL <span style=color:#b44>&#34;https://raw.githubusercontent.com/kubernetes/release/</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>RELEASE_VERSION</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>/cmd/kubepkg/templates/latest/deb/kubeadm/10-kubeadm.conf&#34;</span> | sed <span style=color:#b44>&#34;s:/usr/bin:</span><span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>DOWNLOAD_DIR</span><span style=color:#b68;font-weight:700>}</span><span style=color:#b44>:g&#34;</span> | sudo tee /etc/systemd/system/kubelet.service.d/10-kubeadm.conf
</span></span></code></pre></div><p>Habilite e inicie o <code>kubelet</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>systemctl <span style=color:#a2f>enable</span> --now kubelet
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Nota:</strong> A distribuição Flatcar Container Linux instala o diretório <code>/usr</code> como um sistema de arquivos apenas para leitura.
Antes de inicializar o seu cluster, você precisa de alguns passos adicionais para configurar um diretório com escrita.
Veja o <a href=/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/#usr-mounted-read-only/>Guia de solução de problemas do Kubeadm</a> para aprender como configurar um diretório com escrita.</div></div></div><p>O kubelet agora ficará reiniciando de alguns em alguns segundos, enquanto espera por instruções vindas do kubeadm.</p><h2 id=configurando-um-driver-cgroup>Configurando um driver cgroup</h2><p>Tanto o agente de execução quanto o kubelet possuem uma propriedade chamada
<a href=/docs/setup/production-environment/container-runtimes/>"driver cgroup"</a>, que é importante
para o gerenciamento dos cgroups em máquinas Linux.</p><div class="alert alert-danger warning callout" role=alert><strong>Aviso:</strong><p>A compatibilidade entre os drivers cgroup e o agente de execução é necessária. Sem ela o processo do kubelet irá falhar.</p><p>Veja <a href=/docs/tasks/administer-cluster/kubeadm/configure-cgroup-driver/>configurando um driver cgroup</a> para mais detalhes.</p></div><h2 id=solucionando-problemas>Solucionando problemas</h2><p>Se você encontrar problemas com o kubeadm, por favor consulte a nossa <a href=/docs/setup/production-environment/tools/kubeadm/troubleshooting-kubeadm/>documentação de solução de problemas</a>.</p><h2 id=próximos-passos>Próximos passos</h2><ul><li><a href=/docs/setup/production-environment/tools/kubeadm/create-cluster-kubeadm/>Utilizando o kubeadm para criar um cluster</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-478acca1934b6d89a0bc00fb25bfe5b6>2 - Instalando Kubernetes com kOps</h1><p>Este início rápido mostra como instalar facilmente um cluster Kubernetes na AWS usando uma ferramenta chamada <a href=https://github.com/kubernetes/kops><code>kOps</code></a>.</p><p><code>kOps</code> é um sistema de provisionamento automatizado:</p><ul><li>Instalação totalmente automatizada</li><li>Usa DNS para identificar clusters</li><li>Auto-recuperação: tudo é executado em grupos de Auto-Scaling</li><li>Suporte de vários sistemas operacionais (Amazon Linux, Debian, Flatcar, RHEL, Rocky e Ubuntu) - veja em <a href=https://github.com/kubernetes/kops/blob/master/docs/operations/images.md>imagens</a></li><li>Suporte a alta disponibilidade - consulte a <a href=https://github.com/kubernetes/kops/blob/master/docs/operations/high_availability.md>documentação sobre alta disponibilidade</a></li><li>Pode provisionar diretamente ou gerar manifestos do terraform - veja a <a href=https://github.com/kubernetes/kops/blob/master/docs/terraform.md>documentação sobre como fazer isso com Terraform</a></li></ul><h2 id=antes-de-você-começar>Antes de você começar</h2><ul><li><p>Você deve ter o <a href=/docs/tasks/tools/>kubectl</a> instalado.</p></li><li><p>Você deve <a href=https://github.com/kubernetes/kops#installing>instalar</a> <code>kops</code> em uma arquitetura de dispositivo de 64 bits (AMD64 e Intel 64).</p></li><li><p>Você deve ter uma <a href=https://docs.aws.amazon.com/polly/latest/dg/setting-up.html>conta da AWS</a>, gerar as <a href=https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys>chaves do IAM</a> e <a href=https://docs.aws.amazon.com/cli/latest/userguide/cli-chap-configure.html#cli-quick-configuration>configurá-las</a>. O usuário do IAM precisará de <a href=https://github.com/kubernetes/kops/blob/master/docs/getting_started/aws.md#setup-iam-user>permissões adequadas</a>.</p></li></ul><h2 id=como-criar-um-cluster>Como criar um cluster</h2><h3 id=1-5-instalar-kops>(1/5) Instalar kops</h3><h4 id=instalação>Instalação</h4><p>Faça o download do kops na <a href=https://github.com/kubernetes/kops/releases>página de downloads</a> (também é conveniente gerar um binário a partir do código-fonte):</p><ul class="nav nav-tabs" id=kops-installation role=tablist><li class=nav-item><a data-toggle=tab class="nav-link active" href=#kops-installation-0 role=tab aria-controls=kops-installation-0 aria-selected=true>macOS</a></li><li class=nav-item><a data-toggle=tab class=nav-link href=#kops-installation-1 role=tab aria-controls=kops-installation-1>Linux</a></li></ul><div class=tab-content id=kops-installation><div id=kops-installation-0 class="tab-pane show active" role=tabpanel aria-labelledby=kops-installation-0><p><p>Baixe a versão mais recente com o comando:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -LO https://github.com/kubernetes/kops/releases/download/<span style=color:#a2f;font-weight:700>$(</span>curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d <span style=color:#b44>&#39;&#34;&#39;</span> -f 4<span style=color:#a2f;font-weight:700>)</span>/kops-darwin-amd64
</span></span></code></pre></div><p>Para baixar uma versão específica, substitua a seguinte parte do comando pela versão específica do kops.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f;font-weight:700>$(</span>curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d <span style=color:#b44>&#39;&#34;&#39;</span> -f 4<span style=color:#a2f;font-weight:700>)</span>
</span></span></code></pre></div><p>Por exemplo, para baixar kops versão v1.20.0 digite:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -LO https://github.com/kubernetes/kops/releases/download/v1.20.0/kops-darwin-amd64
</span></span></code></pre></div><p>Dê a permissão de execução ao binário do kops.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>chmod +x kops-darwin-amd64
</span></span></code></pre></div><p>Mova o binário do kops para o seu PATH.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo mv kops-darwin-amd64 /usr/local/bin/kops
</span></span></code></pre></div><p>Você também pode instalar kops usando <a href=https://brew.sh/>Homebrew</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>brew update <span style=color:#666>&amp;&amp;</span> brew install kops
</span></span></code></pre></div></div><div id=kops-installation-1 class=tab-pane role=tabpanel aria-labelledby=kops-installation-1><p><p>Baixe a versão mais recente com o comando:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -LO https://github.com/kubernetes/kops/releases/download/<span style=color:#a2f;font-weight:700>$(</span>curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d <span style=color:#b44>&#39;&#34;&#39;</span> -f 4<span style=color:#a2f;font-weight:700>)</span>/kops-linux-amd64
</span></span></code></pre></div><p>Para baixar uma versão específica do kops, substitua a seguinte parte do comando pela versão específica do kops.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f;font-weight:700>$(</span>curl -s https://api.github.com/repos/kubernetes/kops/releases/latest | grep tag_name | cut -d <span style=color:#b44>&#39;&#34;&#39;</span> -f 4<span style=color:#a2f;font-weight:700>)</span>
</span></span></code></pre></div><p>Por exemplo, para baixar kops versão v1.20.0 digite:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl -LO https://github.com/kubernetes/kops/releases/download/v1.20.0/kops-linux-amd64
</span></span></code></pre></div><p>Dê a permissão de execução ao binário do kops</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>chmod +x kops-linux-amd64
</span></span></code></pre></div><p>Mova o binário do kops para o seu PATH.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo mv kops-linux-amd64 /usr/local/bin/kops
</span></span></code></pre></div><p>Você também pode instalar kops usando <a href=https://docs.brew.sh/Homebrew-on-Linux>Homebrew</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>brew update <span style=color:#666>&amp;&amp;</span> brew install kops
</span></span></code></pre></div></div></div><h3 id=2-5-crie-um-domínio-route53-para-seu-cluster>(2/5) Crie um domínio route53 para seu cluster</h3><p>O kops usa DNS para descoberta, tanto dentro do cluster quanto fora, para que você possa acessar o servidor da API do kubernetes a partir dos clientes.</p><p>kops tem uma opinião forte sobre o nome do cluster: deve ser um nome DNS válido. Ao fazer isso, você não confundirá mais seus clusters, poderá compartilhar clusters com seus colegas de forma inequívoca e alcançá-los sem ter de lembrar de um endereço IP.</p><p>Você pode e provavelmente deve usar subdomínios para dividir seus clusters. Como nosso exemplo usaremos
<code>useast1.dev.example.com</code>. O endpoint do servidor de API será então <code>api.useast1.dev.example.com</code>.</p><p>Uma zona hospedada do Route53 pode servir subdomínios. Sua zona hospedada pode ser <code>useast1.dev.example.com</code>,
mas também <code>dev.example.com</code> ou até <code>example.com</code>. kops funciona com qualquer um deles, então normalmente você escolhe por motivos de organização (por exemplo, você tem permissão para criar registros em <code>dev.example.com</code>,
mas não em <code>example.com</code>).</p><p>Vamos supor que você esteja usando <code>dev.example.com</code> como sua zona hospedada. Você cria essa zona hospedada usando o <a href=https://docs.aws.amazon.com/Route53/latest/DeveloperGuide/CreatingNewSubdomain.html>processo normal</a>, ou
com um comando como <code>aws route53 create-hosted-zone --name dev.example.com --caller-reference 1</code>.</p><p>Você deve então configurar seus registros NS no domínio principal, para que os registros no domínio sejam resolvidos. Aqui, você criaria registros NS no <code>example.com</code> para <code>dev</code>. Se for um nome de domínio raiz, você configuraria os registros NS em seu registrador de domínio (por exemplo <code>example.com</code>, precisaria ser configurado onde você comprou <code>example.com</code>).</p><p>Verifique a configuração do seu domínio route53 (é a causa número 1 de problemas!). Você pode verificar novamente se seu cluster está configurado corretamente se tiver a ferramenta dig executando:</p><p><code>dig NS dev.example.com</code></p><p>Você deve ver os 4 registros NS que o Route53 atribuiu à sua zona hospedada.</p><h3 id=3-5-crie-um-bucket-do-s3-para-armazenar-o-estado-dos-clusters>(3/5) Crie um bucket do S3 para armazenar o estado dos clusters</h3><p>O kops permite que você gerencie seus clusters mesmo após a instalação. Para fazer isso, ele deve acompanhar os clusters que você criou, juntamente com suas configurações, as chaves que estão usando etc. Essas informações são armazenadas em um bucket do S3. As permissões do S3 são usadas para controlar o acesso ao bucket.</p><p>Vários clusters podem usar o mesmo bucket do S3 e você pode compartilhar um bucket do S3 entre seus colegas que administram os mesmos clusters - isso é muito mais fácil do que transmitir arquivos kubecfg. Mas qualquer pessoa com acesso ao bucket do S3 terá acesso administrativo a todos os seus clusters, portanto, você não deseja compartilhá-lo além da equipe de operações.</p><p>Portanto, normalmente você tem um bucket do S3 para cada equipe de operações (e geralmente o nome corresponderá ao nome da zona hospedada acima!)</p><p>Em nosso exemplo, escolhemos <code>dev.example.com</code> como nossa zona hospedada, então vamos escolher <code>clusters.dev.example.com</code> como o nome do bucket do S3.</p><ul><li><p>Exporte <code>AWS_PROFILE</code> (se precisar selecione um perfil para que a AWS CLI funcione)</p></li><li><p>Crie o bucket do S3 usando <code>aws s3 mb s3://clusters.dev.example.com</code></p></li><li><p>Você pode rodar <code>export KOPS_STATE_STORE=s3://clusters.dev.example.com</code> e, em seguida, o kops usará esse local por padrão. Sugerimos colocar isso em seu perfil bash ou similar.</p></li></ul><h3 id=4-5-crie-sua-configuração-de-cluster>(4/5) Crie sua configuração de cluster</h3><p>Execute <code>kops create cluster</code> para criar sua configuração de cluster:</p><p><code>kops create cluster --zones=us-east-1c useast1.dev.example.com</code></p><p>kops criará a configuração para seu cluster. Observe que ele <em>apenas</em> cria a configuração, na verdade não cria os recursos de nuvem - você fará isso na próxima etapa com um arquivo <code>kops update cluster</code>. Isso lhe dá a oportunidade de revisar a configuração ou alterá-la.</p><p>Ele exibe comandos que você pode usar para explorar mais:</p><ul><li>Liste seus clusters com: <code>kops get cluster</code></li><li>Edite este cluster com: <code>kops edit cluster useast1.dev.example.com</code></li><li>Edite seu grupo de instâncias de nós: <code>kops edit ig --name=useast1.dev.example.com nodes</code></li><li>Edite seu grupo de instâncias principal: <code>kops edit ig --name=useast1.dev.example.com master-us-east-1c</code></li></ul><p>Se esta é sua primeira vez usando kops, gaste alguns minutos para experimentá-los! Um grupo de instâncias é um conjunto de instâncias que serão registradas como nós do kubernetes. Na AWS, isso é implementado por meio de grupos de auto-scaling.
Você pode ter vários grupos de instâncias, por exemplo, se quiser nós que sejam uma combinação de instâncias spot e sob demanda ou instâncias de GPU e não GPU.</p><h3 id=5-5-crie-o-cluster-na-aws>(5/5) Crie o cluster na AWS</h3><p>Execute <code>kops update cluster</code> para criar seu cluster na AWS:</p><p><code>kops update cluster useast1.dev.example.com --yes</code></p><p>Isso leva alguns segundos para ser executado, mas seu cluster provavelmente levará alguns minutos para estar realmente pronto.
<code>kops update cluster</code> será a ferramenta que você usará sempre que alterar a configuração do seu cluster; ele aplica as alterações que você fez na configuração ao seu cluster - reconfigurando AWS ou kubernetes conforme necessário.</p><p>Por exemplo, depois de você executar <code>kops edit ig nodes</code>, em seguida execute <code>kops update cluster --yes</code> para aplicar sua configuração e, às vezes, você também precisará <code>kops rolling-update cluster</code> para implementar a configuração imediatamente.</p><p>Sem <code>--yes</code>, <code>kops update cluster</code> mostrará uma prévia do que ele fará. Isso é útil para clusters de produção!</p><h3 id=explore-outros-complementos>Explore outros complementos</h3><p>Consulte a <a href=/pt-br/docs/concepts/cluster-administration/addons/>lista de complementos</a> para explorar outros complementos, incluindo ferramentas para registro, monitoramento, política de rede, visualização e controle de seu cluster Kubernetes.</p><h2 id=limpeza>Limpeza</h2><ul><li>Para excluir seu cluster: <code>kops delete cluster useast1.dev.example.com --yes</code></li></ul><h2 id=próximos-passos>Próximos passos</h2><ul><li>Saiba mais sobre os <a href=/pt-br/docs/concepts/>conceitos do Kubernetes</a> e o <a href=/docs/reference/kubectl/><code>kubectl</code></a>.</li><li>Saiba mais sobre o <a href=https://kops.sigs.k8s.io/>uso avançado</a> do <code>kOps</code> para tutoriais, práticas recomendadas e opções de configuração avançada.</li><li>Siga as discussões da comunidade do <code>kOps</code> no Slack: <a href=https://github.com/kubernetes/kops#other-ways-to-communicate-with-the-contributors>discussões da comunidade</a>.</li><li>Contribua para o <code>kOps</code> endereçando ou levantando um problema <a href=https://github.com/kubernetes/kops/issues>GitHub Issues</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d2f55eefe7222b7c637875af9c3ec199>3 - Soluções de Nuvem Prontas para uso</h1><p>Essa página fornece uma lista de provedores de soluções certificadas do Kubernetes. Na página de cada provedor, você pode aprender como instalar e configurar clusters prontos para produção.</p><script>function updateLandscapeSource(e,t){console.log({button:e,shouldUpdateFragment:t});try{if(t)window.location.hash="#"+e.id;else{var n=document.querySelectorAll("#landscape");let t=e.dataset.landscapeTypes,s="https://landscape.cncf.io/card-mode?category="+encodeURIComponent(t)+"&grouping=category&embed=yes";n[0].src=s}}catch(e){console.log({message:"error handling Landscape switch",error:e})}}document.addEventListener("DOMContentLoaded",function(){let t=()=>{if(window.location.hash){let e=document.querySelectorAll(".landscape-trigger"+window.location.hash);e.length==1&&(landscapeSource=e[0],console.log("Updating Landscape source based on fragment:",window.location.hash.substring(1)),updateLandscapeSource(landscapeSource,!1))}};var e,n=document.querySelectorAll(".landscape-trigger");if(n.forEach(e=>{e.onclick=function(){updateLandscapeSource(e,!0)}}),e=document.querySelectorAll(".landscape-trigger.landscape-default"),e.length==1){let t=e[0];updateLandscapeSource(t,!1)}window.addEventListener("hashchange",t,!1),t()})</script><div id=frameHolder><iframe frameborder=0 id=landscape scrolling=no src="https://landscape.cncf.io/card-mode?category=certified-kubernetes-hosted&grouping=category&embed=yes" style=width:1px;min-width:100%></iframe>
<script src=https://landscape.cncf.io/iframeResizer.js></script></div></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/pt-br/docs/home/>Home</a>
<a class=text-white href=/pt-br/blog/>Blog</a>
<a class=text-white href=/pt-br/partners/>Parceiros</a>
<a class=text-white href=/pt-br/community/>Comunidade</a>
<a class=text-white href=/pt-br/case-studies/>Casos de estudo</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 Os autores do Kubernetes | Documentação Distribuída sob <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 A Fundação Linux &reg;. Todos os direitos reservados. A Linux Foundation tem marcas registradas e usa marcas registradas. Para uma lista de marcas registradas da The Linux Foundation, por favor, veja nossa <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Página de uso de marca registrada</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>