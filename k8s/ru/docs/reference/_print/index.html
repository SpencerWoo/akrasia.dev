<!doctype html><html lang=ru class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/reference/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/docs/reference/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/reference/><link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/reference/><link rel=alternate hreflang=fr href=https://kubernetes.io/fr/docs/reference/><link rel=alternate hreflang=de href=https://kubernetes.io/de/docs/reference/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/reference/><link rel=alternate hreflang=pt-br href=https://kubernetes.io/pt-br/docs/reference/><link rel=alternate hreflang=id href=https://kubernetes.io/id/docs/reference/><link rel=alternate hreflang=hi href=https://kubernetes.io/hi/docs/reference/><link rel=alternate hreflang=pl href=https://kubernetes.io/pl/docs/reference/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/ru/docs/reference/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>Ссылки | Kubernetes</title><meta property="og:title" content="Ссылки"><meta property="og:description" content="Первоклассная оркестрация контейнеров"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/ru/docs/reference/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="Ссылки"><meta itemprop=description content="Первоклассная оркестрация контейнеров"><meta name=twitter:card content="summary"><meta name=twitter:title content="Ссылки"><meta name=twitter:description content="Первоклассная оркестрация контейнеров"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content="Этот раздел документации Kubernetes содержит ссылки.
Ссылки API Обзор Kubernetes API - Обзор API для Kubernetes. Версии Kubernetes API 1.17 1.16 1.15 1.14 1.13 1.12 Клиентские библиотеки API Для вызова API Kubernetes из языка программирования вы можете использовать клиентские библиотеки. Официально поддерживаемые клиентские библиотеки:
Клиентская библиотека Go Клиентская библиотека Python Клиентская библиотека Java Клиентская библиотека JavaScript Ссылки CLI kubectl - Основной инструмент CLI для запуска команд и управления кластерами Kubernetes."><meta property="og:description" content="Этот раздел документации Kubernetes содержит ссылки.
Ссылки API Обзор Kubernetes API - Обзор API для Kubernetes. Версии Kubernetes API 1.17 1.16 1.15 1.14 1.13 1.12 Клиентские библиотеки API Для вызова API Kubernetes из языка программирования вы можете использовать клиентские библиотеки. Официально поддерживаемые клиентские библиотеки:
Клиентская библиотека Go Клиентская библиотека Python Клиентская библиотека Java Клиентская библиотека JavaScript Ссылки CLI kubectl - Основной инструмент CLI для запуска команд и управления кластерами Kubernetes."><meta name=twitter:description content="Этот раздел документации Kubernetes содержит ссылки.
Ссылки API Обзор Kubernetes API - Обзор API для Kubernetes. Версии Kubernetes API 1.17 1.16 1.15 1.14 1.13 1.12 Клиентские библиотеки API Для вызова API Kubernetes из языка программирования вы можете использовать клиентские библиотеки. Официально поддерживаемые клиентские библиотеки:
Клиентская библиотека Go Клиентская библиотека Python Клиентская библиотека Java Клиентская библиотека JavaScript Ссылки CLI kubectl - Основной инструмент CLI для запуска команд и управления кластерами Kubernetes."><meta property="og:url" content="https://kubernetes.io/ru/docs/reference/"><meta property="og:title" content="Ссылки"><meta name=twitter:title content="Ссылки"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/ru/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/ru/docs/>Документация</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ru/community/>Сообщество</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ru/case-studies/>Примеры использования</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/ru/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/ru/docs/reference/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/ru/docs/reference/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/ru/docs/reference/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/ru/docs/reference/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/ru/docs/reference/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Русский (Russian)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/reference/>English</a>
<a class=dropdown-item href=/zh-cn/docs/reference/>中文 (Chinese)</a>
<a class=dropdown-item href=/ko/docs/reference/>한국어 (Korean)</a>
<a class=dropdown-item href=/ja/docs/reference/>日本語 (Japanese)</a>
<a class=dropdown-item href=/fr/docs/reference/>Français (French)</a>
<a class=dropdown-item href=/de/docs/reference/>Deutsch (German)</a>
<a class=dropdown-item href=/es/docs/reference/>Español (Spanish)</a>
<a class=dropdown-item href=/pt-br/docs/reference/>Português (Portuguese)</a>
<a class=dropdown-item href=/id/docs/reference/>Bahasa Indonesia</a>
<a class=dropdown-item href=/hi/docs/reference/>हिन्दी (Hindi)</a>
<a class=dropdown-item href=/pl/docs/reference/>Polski (Polish)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>Это многостраничный печатный вид этого раздела.
<a href=# onclick="return print(),!1">Нажмите что бы печатать</a>.</p><p><a href=/ru/docs/reference/>Вернуться к обычному просмотру страницы</a>.</p></div><h1 class=title>Ссылки</h1><ul><li>1: <a href=#pg-2b03679960950df772fb4fe7d78427b9>Стандартизированный глоссарий</a></li><li>2: <a href=#pg-03460a7254c6c73eb2a1bb3dd7d25910>kubectl CLI</a></li><ul><li>2.1: <a href=#pg-f14fe15ecc2d41b5e901ef5e872ca657>Обзор kubectl</a></li><li>2.2: <a href=#pg-a938176c695852fe70362c29cf615f1c>Поддержка JSONPath</a></li><li>2.3: <a href=#pg-4d3e62632c189fcc3c1357cd8fb8799c>kubectl</a></li><li>2.4: <a href=#pg-a7abc09192597e614b58f8b552b682f5>kubectl для пользователей Docker</a></li><li>2.5: <a href=#pg-d7ffbf04ffbefb241fd0722423b80f5a>Команды kubectl</a></li><li>2.6: <a href=#pg-8aba901ac13f124e5782b90ddb166ee2>Шпаргалка по kubectl</a></li></ul></ul><div class=content><p>Этот раздел документации Kubernetes содержит ссылки.</p><h2 id=ссылки-api>Ссылки API</h2><ul><li><a href=/docs/reference/using-api/api-overview/>Обзор Kubernetes API</a> - Обзор API для Kubernetes.</li><li>Версии Kubernetes API<ul><li><a href=/docs/reference/generated/kubernetes-api/v1.17/>1.17</a></li><li><a href=/docs/reference/generated/kubernetes-api/v1.16/>1.16</a></li><li><a href=/docs/reference/generated/kubernetes-api/v1.15/>1.15</a></li><li><a href=/docs/reference/generated/kubernetes-api/v1.14/>1.14</a></li><li><a href=/docs/reference/generated/kubernetes-api/v1.13/>1.13</a></li><li><a href=/docs/reference/generated/kubernetes-api/v1.12/>1.12</a></li></ul></li></ul><h2 id=клиентские-библиотеки-api>Клиентские библиотеки API</h2><p>Для вызова API Kubernetes из языка программирования вы можете использовать
<a href=/docs/reference/using-api/client-libraries/>клиентские библиотеки</a>. Официально поддерживаемые клиентские библиотеки:</p><ul><li><a href=https://github.com/kubernetes/client-go/>Клиентская библиотека Go</a></li><li><a href=https://github.com/kubernetes-client/python>Клиентская библиотека Python</a></li><li><a href=https://github.com/kubernetes-client/java>Клиентская библиотека Java</a></li><li><a href=https://github.com/kubernetes-client/javascript>Клиентская библиотека JavaScript</a></li></ul><h2 id=ссылки-cli>Ссылки CLI</h2><ul><li><a href=/docs/user-guide/kubectl-overview>kubectl</a> - Основной инструмент CLI для запуска команд и управления кластерами Kubernetes.</li><li><a href=/docs/user-guide/jsonpath/>JSONPath</a> - Документация по синтаксису использования <a href=http://goessner.net/articles/JsonPath/>выражений JSONPath</a> с kubectl.</li><li><a href=/docs/admin/kubeadm/>kubeadm</a> - Инструмент CLI для легкого разворачивания защищенного кластера Kubernetes.</li><li><a href=/docs/admin/kubefed/>kubefed</a> - Инструмент CLI для помощи в администрировании федеративных кластеров.</li></ul><h2 id=ссылки-на-конфигурации>Ссылки на конфигурации</h2><ul><li><a href=/docs/admin/kubelet/>kubelet</a> - Основной <em>агент ноды</em>, который работает на каждой ноде. Kubelet принимает набор PodSpecs и гарантирует, что описанные контейнеры работают исправно.</li><li><a href=/docs/admin/kube-apiserver/>kube-apiserver</a> - REST API, который проверяет и настраивает данные для объектов API, таких, как модули, службы, контроллеры и репликации.</li><li><a href=/docs/admin/kube-controller-manager/>kube-controller-manager</a> - Демон, который встраивает основные контрольные циклы, поставляемые с Kubernetes.</li><li><a href=/docs/admin/kube-proxy/>kube-proxy</a> - Может выполнять простую пересылку запросов TCP/UDP или циклическую переадресацию TCP/UDP через набор бекендов.</li><li><a href=/docs/admin/kube-scheduler/>kube-scheduler</a> - Планировщик, который управляет доступностью, производительностью и хранилищем.</li><li><a href=/docs/admin/federation-apiserver/>federation-apiserver</a> - Сервер API для федеративных кластеров.</li><li><a href=/docs/admin/federation-controller-manager/>federation-controller-manager</a> - Демон, который встраивает основные контрольные циклы, поставляемые с Kubernetes.</li></ul><h2 id=дизайн-документация>Дизайн документация</h2><p>Архив документации по дизайну для функциональности Kubernetes. Начните с <a href=https://git.k8s.io/community/contributors/design-proposals/architecture/architecture.md>Архитектуры Kubernetes</a> и <a href=https://git.k8s.io/community/contributors/design-proposals>Обзора дизайна Kubernetes</a>.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-2b03679960950df772fb4fe7d78427b9>1 - Стандартизированный глоссарий</h1></div><div class=td-content style=page-break-before:always><h1 id=pg-03460a7254c6c73eb2a1bb3dd7d25910>2 - kubectl CLI</h1></div><div class=td-content><h1 id=pg-f14fe15ecc2d41b5e901ef5e872ca657>2.1 - Обзор kubectl</h1><p>Kubectl — это инструмент командной строки для управления кластерами Kubernetes. <code>kubectl</code> ищет файл config в директории $HOME/.kube. Вы можете указать другие файлы <a href=/docs/concepts/configuration/organize-cluster-access-kubeconfig/>kubeconfig</a>, установив переменную окружения KUBECONFIG или флаг <a href=/docs/concepts/configuration/organize-cluster-access-kubeconfig/><code>--kubeconfig</code></a>.</p><p>На этой странице рассматривается синтаксис kubectl, описаны командные операции и приведены распространённые примеры. Подробную информацию о каждой команде, включая все поддерживаемые в ней флаги и подкоманды, смотрите в справочной документации <a href=/docs/reference/generated/kubectl/kubectl-commands/>kubectl</a>. Инструкции по установке находятся на странице <a href=/ru/docs/tasks/kubectl/install/>Установка и настройка kubectl</a>.</p><h2 id=синтаксис>Синтаксис</h2><p>Используйте следующий синтаксис для выполнения команд <code>kubectl</code> в терминале:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>command<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NAME<span style=color:#666>]</span> <span style=color:#666>[</span>flags<span style=color:#666>]</span>
</span></span></code></pre></div><p>где <code>command</code>, <code>TYPE</code>, <code>NAME</code> и <code>flags</code>:</p><ul><li><p><code>command</code>: определяет выполняемую операцию с одним или несколькими ресурсами, например, <code>create</code>, <code>get</code>, <code>describe</code>, <code>delete</code>.</p></li><li><p><code>TYPE</code>: определяет <a href=#%D1%82%D0%B8%D0%BF%D1%8B-%D1%80%D0%B5%D1%81%D1%83%D1%80%D1%81%D0%BE%D0%B2>тип ресурса</a>. Типы ресурсов не чувствительны к регистру, кроме этого вы можете использовать единственную, множественную или сокращенную форму. Например, следующие команды выведут одно и то же.</p><pre><code>```shell
kubectl get pod pod1
kubectl get pods pod1
kubectl get po pod1
```
</code></pre></li><li><p><code>NAME</code>: определяет имя ресурса. Имена чувствительны к регистру. Если имя не указано, то отображаются подробности по всем ресурсам, например, <code>kubectl get pods</code>.</p><p>При выполнении операции с несколькими ресурсами можно выбрать каждый ресурс по типу и имени, либо сделать это в одном или нескольких файлов:</p><ul><li><p>Выбор ресурсов по типу и имени:</p><ul><li><p>Сгруппировать ресурсы, если все они одного типа: <code>TYPE1 name1 name2 name&lt;#></code>.<br>Пример: <code>kubectl get pod example-pod1 example-pod2</code></p></li><li><p>Выбор нескольких типов ресурсов по отдельности: <code>TYPE1/name1 TYPE1/name2 TYPE2/name3 TYPE&lt;#>/name&lt;#></code>.<br>Пример: <code>kubectl get pod/example-pod1 replicationcontroller/example-rc1</code></p></li></ul></li><li><p>Выбор ресурсов по одному или нескольким файлов: <code>-f file1 -f file2 -f file&lt;#></code></p><ul><li><a href=/docs/concepts/configuration/overview/#general-configuration-tips>Используйте YAML вместо JSON</a>, так как YAML удобнее для пользователей, особенно в конфигурационных файлах.<br>Пример: <code>kubectl get pod -f ./pod.yaml</code></li></ul></li></ul></li><li><p><code>flags</code>: определяет дополнительные флаги. Например, вы можете использовать флаги <code>-s</code> или <code>--server</code>, чтобы указать адрес и порт API-сервера Kubernetes.<br></p></li></ul><div class="alert alert-warning caution callout" role=alert><strong>Внимание:</strong> Указанные вами флаги из командной строки переопределят значения по умолчанию и связанные переменные окружения.</div><p>Если вам нужна помощь, выполните команду <code>kubectl help</code>.</p><h2 id=операции>Операции</h2><p>В следующей таблице приведены краткие описания и общий синтаксис всех операций <code>kubectl</code>:</p><table><thead><tr><th>Операция</th><th>Синтаксис</th><th>Описание</th></tr></thead><tbody><tr><td><code>annotate</code></td><td><code>kubectl annotate (-f FILENAME | TYPE NAME | TYPE/NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]</code></td><td>Добавить или обновить аннотации одного или нескольких ресурсов.</td></tr><tr><td><code>api-versions</code></td><td><code>kubectl api-versions [flags]</code></td><td>Вывести доступные версии API.</td></tr><tr><td><code>apply</code></td><td><code>kubectl apply -f FILENAME [flags]</code></td><td>Внести изменения в конфигурацию ресурса из файла или потока stdin.</td></tr><tr><td><code>attach</code></td><td><code>kubectl attach POD -c CONTAINER [-i] [-t] [flags]</code></td><td>Подключиться к запущенному контейнеру либо для просмотра потока вывода, либо для работы с контейнером (stdin).</td></tr><tr><td><code>autoscale</code></td><td><code>kubectl autoscale (-f FILENAME | TYPE NAME | TYPE/NAME) [--min=MINPODS] --max=MAXPODS [--cpu-percent=CPU] [flags]</code></td><td>Автоматически промасштабировать набор подов, управляемых контроллером репликации.</td></tr><tr><td><code>cluster-info</code></td><td><code>kubectl cluster-info [flags]</code></td><td>Показать информацию о главном узле и сервисах в кластере.</td></tr><tr><td><code>config</code></td><td><code>kubectl config SUBCOMMAND [flags]</code></td><td>Изменить файлы kubeconfig. Подробные сведения смотрите в отдельных подкомандах.</td></tr><tr><td><code>create</code></td><td><code>kubectl create -f FILENAME [flags]</code></td><td>Создать один или несколько ресурсов из файла или stdin.</td></tr><tr><td><code>delete</code></td><td><code>kubectl delete (-f FILENAME | TYPE [NAME | /NAME | -l label | --all]) [flags]</code></td><td>Удалить ресурсы из файла, потока stdin, либо с помощью селекторов меток, имен, селекторов ресурсов или ресурсов.</td></tr><tr><td><code>describe</code></td><td><code>kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | /NAME | -l label]) [flags]</code></td><td>Показать подробное состояние одного или нескольких ресурсов.</td></tr><tr><td><code>diff</code></td><td><code>kubectl diff -f FILENAME [flags]</code></td><td>Diff file or stdin against live configuration (<strong>BETA</strong>)</td></tr><tr><td><code>edit</code></td><td><code>kubectl edit (-f FILENAME | TYPE NAME | TYPE/NAME) [flags]</code></td><td>Отредактировать и обновить определение одного или нескольких ресурсов на сервере, используя редактор по умолчанию.</td></tr><tr><td><code>exec</code></td><td><code>kubectl exec POD [-c CONTAINER] [-i] [-t] [flags] [-- COMMAND [args...]]</code></td><td>Выполнить команду в контейнере пода.</td></tr><tr><td><code>explain</code></td><td><code>kubectl explain [--recursive=false] [flags]</code></td><td>Посмотреть документацию по ресурсам. Например, поды, узлы, сервисы и т.д.</td></tr><tr><td><code>expose</code></td><td><code>kubectl expose (-f FILENAME | TYPE NAME | TYPE/NAME) [--port=port] [--protocol=TCP|UDP] [--target-port=number-or-name] [--name=name] [--external-ip=external-ip-of-service] [--type=type] [flags]</code></td><td>Создать Kubernetes-сервис из контроллера репликации, сервиса или пода.</td></tr><tr><td><code>get</code></td><td><code>kubectl get (-f FILENAME | TYPE [NAME | /NAME | -l label]) [--watch] [--sort-by=FIELD] [[-o | --output]=OUTPUT_FORMAT] [flags]</code></td><td>Вывести один или несколько ресурсов.</td></tr><tr><td><code>label</code></td><td><code>kubectl label (-f FILENAME | TYPE NAME | TYPE/NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]</code></td><td>Добавить или обновить метки для одного или нескольких ресурсов.</td></tr><tr><td><code>logs</code></td><td><code>kubectl logs POD [-c CONTAINER] [--follow] [flags]</code></td><td>Вывести логи контейнера в поде.</td></tr><tr><td><code>patch</code></td><td><code>kubectl patch (-f FILENAME | TYPE NAME | TYPE/NAME) --patch PATCH [flags]</code></td><td>Обновить один или несколько полей ресурса, используя стратегию слияния патча.</td></tr><tr><td><code>port-forward</code></td><td><code>kubectl port-forward POD [LOCAL_PORT:]REMOTE_PORT [...[LOCAL_PORT_N:]REMOTE_PORT_N] [flags]</code></td><td>Переадресовать один или несколько локальных портов в под.</td></tr><tr><td><code>proxy</code></td><td><code>kubectl proxy [--port=PORT] [--www=static-dir] [--www-prefix=prefix] [--api-prefix=prefix] [flags]</code></td><td>Запустить прокси для API Kubernetes.</td></tr><tr><td><code>replace</code></td><td><code>kubectl replace -f FILENAME</code></td><td>Заменить ресурс из файла или потока stdin.</td></tr><tr><td><code>rolling-update</code></td><td><code>kubectl rolling-update OLD_CONTROLLER_NAME ([NEW_CONTROLLER_NAME] --image=NEW_CONTAINER_IMAGE | -f NEW_CONTROLLER_SPEC) [flags]</code></td><td>Выполните плавающее обновление, постепенно заменяя указанный контроллер репликации и его поды.</td></tr><tr><td><code>run</code></td><td><code>kubectl run NAME --image=image [--env="key=value"] [--port=port] [--replicas=replicas] [--dry-run=bool] [--overrides=inline-json] [flags]</code></td><td>Запустить указанный образ в кластере.</td></tr><tr><td><code>scale</code></td><td><code>kubectl scale (-f FILENAME | TYPE NAME | TYPE/NAME) --replicas=COUNT [--resource-version=version] [--current-replicas=count] [flags]</code></td><td>Обновить размер указанного контроллера репликации.</td></tr><tr><td><code>version</code></td><td><code>kubectl version [--client] [flags]</code></td><td>Отобразить версию Kubernetes, запущенного на клиенте и сервере.</td></tr></tbody></table><p>Примечание: подробную информацию о командных операциях смотрите в справочную документацию <a href=/ru/docs/user-guide/kubectl/>kubectl</a>.</p><h2 id=типы-ресурсов>Типы ресурсов</h2><p>В следующей таблице перечислены все доступные типы ресурсов вместе с сокращенными аббревиатурами.</p><p>(Это актуальный вывод команды <code>kubectl api-resources</code> с версии Kubernetes 1.13.3.)</p><table><thead><tr><th>Resource Name</th><th>Short Names</th><th>API Group</th><th>Namespaced</th><th>Resource Kind</th></tr></thead><tbody><tr><td><code>bindings</code></td><td></td><td></td><td>true</td><td>Binding</td></tr><tr><td><code>componentstatuses</code></td><td><code>cs</code></td><td></td><td>false</td><td>ComponentStatus</td></tr><tr><td><code>configmaps</code></td><td><code>cm</code></td><td></td><td>true</td><td>ConfigMap</td></tr><tr><td><code>endpoints</code></td><td><code>ep</code></td><td></td><td>true</td><td>Endpoints</td></tr><tr><td><code>limitranges</code></td><td><code>limits</code></td><td></td><td>true</td><td>LimitRange</td></tr><tr><td><code>namespaces</code></td><td><code>ns</code></td><td></td><td>false</td><td>Namespace</td></tr><tr><td><code>nodes</code></td><td><code>no</code></td><td></td><td>false</td><td>Node</td></tr><tr><td><code>persistentvolumeclaims</code></td><td><code>pvc</code></td><td></td><td>true</td><td>PersistentVolumeClaim</td></tr><tr><td><code>persistentvolumes</code></td><td><code>pv</code></td><td></td><td>false</td><td>PersistentVolume</td></tr><tr><td><code>pods</code></td><td><code>po</code></td><td></td><td>true</td><td>Pod</td></tr><tr><td><code>podtemplates</code></td><td></td><td></td><td>true</td><td>PodTemplate</td></tr><tr><td><code>replicationcontrollers</code></td><td><code>rc</code></td><td></td><td>true</td><td>ReplicationController</td></tr><tr><td><code>resourcequotas</code></td><td><code>quota</code></td><td></td><td>true</td><td>ResourceQuota</td></tr><tr><td><code>secrets</code></td><td></td><td></td><td>true</td><td>Secret</td></tr><tr><td><code>serviceaccounts</code></td><td><code>sa</code></td><td></td><td>true</td><td>ServiceAccount</td></tr><tr><td><code>services</code></td><td><code>svc</code></td><td></td><td>true</td><td>Service</td></tr><tr><td><code>mutatingwebhookconfigurations</code></td><td></td><td>admissionregistration.k8s.io</td><td>false</td><td>MutatingWebhookConfiguration</td></tr><tr><td><code>validatingwebhookconfigurations</code></td><td></td><td>admissionregistration.k8s.io</td><td>false</td><td>ValidatingWebhookConfiguration</td></tr><tr><td><code>customresourcedefinitions</code></td><td><code>crd</code>, <code>crds</code></td><td>apiextensions.k8s.io</td><td>false</td><td>CustomResourceDefinition</td></tr><tr><td><code>apiservices</code></td><td></td><td>apiregistration.k8s.io</td><td>false</td><td>APIService</td></tr><tr><td><code>controllerrevisions</code></td><td></td><td>apps</td><td>true</td><td>ControllerRevision</td></tr><tr><td><code>daemonsets</code></td><td><code>ds</code></td><td>apps</td><td>true</td><td>DaemonSet</td></tr><tr><td><code>deployments</code></td><td><code>deploy</code></td><td>apps</td><td>true</td><td>Deployment</td></tr><tr><td><code>replicasets</code></td><td><code>rs</code></td><td>apps</td><td>true</td><td>ReplicaSet</td></tr><tr><td><code>statefulsets</code></td><td><code>sts</code></td><td>apps</td><td>true</td><td>StatefulSet</td></tr><tr><td><code>tokenreviews</code></td><td></td><td>authentication.k8s.io</td><td>false</td><td>TokenReview</td></tr><tr><td><code>localsubjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>true</td><td>LocalSubjectAccessReview</td></tr><tr><td><code>selfsubjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SelfSubjectAccessReview</td></tr><tr><td><code>selfsubjectrulesreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SelfSubjectRulesReview</td></tr><tr><td><code>subjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SubjectAccessReview</td></tr><tr><td><code>horizontalpodautoscalers</code></td><td><code>hpa</code></td><td>autoscaling</td><td>true</td><td>HorizontalPodAutoscaler</td></tr><tr><td><code>cronjobs</code></td><td><code>cj</code></td><td>batch</td><td>true</td><td>CronJob</td></tr><tr><td><code>jobs</code></td><td></td><td>batch</td><td>true</td><td>Job</td></tr><tr><td><code>certificatesigningrequests</code></td><td><code>csr</code></td><td>certificates.k8s.io</td><td>false</td><td>CertificateSigningRequest</td></tr><tr><td><code>leases</code></td><td></td><td>coordination.k8s.io</td><td>true</td><td>Lease</td></tr><tr><td><code>events</code></td><td><code>ev</code></td><td>events.k8s.io</td><td>true</td><td>Event</td></tr><tr><td><code>ingresses</code></td><td><code>ing</code></td><td>extensions</td><td>true</td><td>Ingress</td></tr><tr><td><code>networkpolicies</code></td><td><code>netpol</code></td><td>networking.k8s.io</td><td>true</td><td>NetworkPolicy</td></tr><tr><td><code>poddisruptionbudgets</code></td><td><code>pdb</code></td><td>policy</td><td>true</td><td>PodDisruptionBudget</td></tr><tr><td><code>podsecuritypolicies</code></td><td><code>psp</code></td><td>policy</td><td>false</td><td>PodSecurityPolicy</td></tr><tr><td><code>clusterrolebindings</code></td><td></td><td>rbac.authorization.k8s.io</td><td>false</td><td>ClusterRoleBinding</td></tr><tr><td><code>clusterroles</code></td><td></td><td>rbac.authorization.k8s.io</td><td>false</td><td>ClusterRole</td></tr><tr><td><code>rolebindings</code></td><td></td><td>rbac.authorization.k8s.io</td><td>true</td><td>RoleBinding</td></tr><tr><td><code>roles</code></td><td></td><td>rbac.authorization.k8s.io</td><td>true</td><td>Role</td></tr><tr><td><code>priorityclasses</code></td><td><code>pc</code></td><td>scheduling.k8s.io</td><td>false</td><td>PriorityClass</td></tr><tr><td><code>csidrivers</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>CSIDriver</td></tr><tr><td><code>csinodes</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>CSINode</td></tr><tr><td><code>storageclasses</code></td><td><code>sc</code></td><td>storage.k8s.io</td><td>false</td><td>StorageClass</td></tr><tr><td><code>volumeattachments</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>VolumeAttachment</td></tr></tbody></table><h2 id=опции-вывода>Опции вывода</h2><p>В следующих разделах рассматривается форматирование и сортировка вывода определенных команд. Дополнительные сведения о том, какие команды поддерживают разные варианты вывода, смотрите в справочной документации <a href=/ru/docs/user-guide/kubectl/>kubectl</a>.</p><h3 id=форматирование-вывода>Форматирование вывода</h3><p>Стандартный формат вывода всех команд <code>kubectl</code> представлен в понятном для человека текстовом формате. Чтобы вывести подробности в определенном формате можно добавить флаги <code>-o</code> или <code>--output</code> к команде <code>kubectl</code>.</p><h4 id=синтаксис-1>Синтаксис</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>command<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NAME<span style=color:#666>]</span> -o &lt;output_format&gt;
</span></span></code></pre></div><p>В зависимости от операции <code>kubectl</code> поддерживаются следующие форматы вывода:</p><table><thead><tr><th>Выходной формат</th><th>Описание</th></tr></thead><tbody><tr><td><code>-o custom-columns=&lt;spec></code></td><td>Вывести таблицу с использованием списка <a href=#%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D0%B5-%D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D1%8B>пользовательских столбцов</a>, разделённого запятыми.</td></tr><tr><td><code>-o custom-columns-file=&lt;filename></code></td><td>Вывести таблицу с использованием шаблона с <a href=#%D0%BF%D0%BE%D0%BB%D1%8C%D0%B7%D0%BE%D0%B2%D0%B0%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D0%BA%D0%B8%D0%B5-%D1%81%D1%82%D0%BE%D0%BB%D0%B1%D1%86%D1%8B>пользовательскими столбцами</a> в файле <code>&lt;filename></code>.</td></tr><tr><td><code>-o json</code></td><td>Вывести API-объект в формате JSON.</td></tr><tr><td><code>-o jsonpath=&lt;template></code></td><td>Вывести поля, определенные в выражении <a href=/ru/docs/reference/kubectl/jsonpath/>jsonpath</a>.</td></tr><tr><td><code>-o jsonpath-file=&lt;filename></code></td><td>Вывести поля, определённые в выражении <a href=/ru/docs/reference/kubectl/jsonpath/>jsonpath</a> из файла <code>&lt;filename></code>.</td></tr><tr><td><code>-o name</code></td><td>Вывести только имя ресурса.</td></tr><tr><td><code>-o wide</code></td><td>Вывести в текстовом формате с дополнительной информацией. Для подов отображается имя узла.</td></tr><tr><td><code>-o yaml</code></td><td>Вывести API-объект в формате YAML</td></tr></tbody></table><h5 id=пример>Пример</h5><p>В данном примере следующая команда выводит подробную информацию по указанному поду в виде объекта в YAML-формате:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pod web-pod-13je7 -o yaml
</span></span></code></pre></div><p>Примечание: подробную информацию о доступных форматах вывода в определенной команде смотрите в справочной документации <a href=/ru/docs/user-guide/kubectl/>kubectl</a>.</p><h4 id=пользовательские-столбцы>Пользовательские столбцы</h4><p>Для определения пользовательских столбцов и вывода в таблицу только нужных данных, можно использовать опцию <code>custom-columns</code>. Вы можете определить пользовательские столбцы в самой опции, либо сделать это в файле шаблона: <code>-o custom-columns=&lt;spec></code> или <code>-o custom-columns-file=&lt;filename></code>.</p><h5 id=примеры>Примеры</h5><p>Столбцы указаны в самой команде:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;pod-name&gt; -o custom-columns<span style=color:#666>=</span>NAME:.metadata.name,RSRC:.metadata.resourceVersion
</span></span></code></pre></div><p>Столбцы указаны в файле шаблона:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;pod-name&gt; -o custom-columns-file<span style=color:#666>=</span>template.txt
</span></span></code></pre></div><p>где файл <code>template.txt</code> содержит следующее:</p><pre tabindex=0><code>NAME          RSRC
metadata.name metadata.resourceVersion
</code></pre><p>Результат выполнения любой из показанной выше команды:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>NAME           RSRC
</span></span><span style=display:flex><span>submit-queue   <span style=color:#666>610995</span>
</span></span></code></pre></div><h4 id=получение-вывода-с-сервера>Получение вывода с сервера</h4><p><code>kubectl</code> может получать информацию об объектах с сервера.
Это означает, что для любого указанного ресурса сервер вернет столбцы и строки по этому ресурсу, которые отобразит клиент.
Благодаря тому, что сервер инкапсулирует реализацию вывода, гарантируется единообразный и понятный для человека вывод на всех клиентах, использующих один и тот же кластер.</p><p>Эта функциональность включена по умолчанию, начиная с <code>kubectl</code> 1.11 и выше. Чтобы отключить ее, добавьте флаг <code>--server-print=false</code> в команду <code>kubectl get</code>.</p><h5 id=примеры-1>Примеры</h5><p>Для вывода информации о состоянии пода, используйте следующую команду:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;pod-name&gt; --server-print<span style=color:#666>=</span><span style=color:#a2f>false</span>
</span></span></code></pre></div><p>Вывод будет выглядеть следующим образом:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>NAME       READY     STATUS              RESTARTS   AGE
</span></span><span style=display:flex><span>pod-name   1/1       Running             <span style=color:#666>0</span>          1m
</span></span></code></pre></div><h3 id=сортировка-списка-объектов>Сортировка списка объектов</h3><p>Для вывода объектов в виде отсортированного списка в терминал используется флаг <code>--sort-by</code> к команде <code>kubectl</code>. Для сортировки объектов нужно указать любое числовое или строковое поле в флаге <code>--sort-by</code>. Для определения поля используйте выражение <a href=/ru/docs/reference/kubectl/jsonpath/>jsonpath</a>.</p><h4 id=синтаксис-2>Синтаксис</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>command<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NAME<span style=color:#666>]</span> --sort-by<span style=color:#666>=</span>&lt;jsonpath_exp&gt;
</span></span></code></pre></div><h5 id=пример-1>Пример</h5><p>Чтобы вывести список подов, отсортированных по имени, выполните команду ниже:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --sort-by<span style=color:#666>=</span>.metadata.name
</span></span></code></pre></div><h2 id=примеры-распространенные-операции>Примеры: распространенные операции</h2><p>Посмотрите следующие примеры, чтобы ознакомиться с часто используемыми операциями <code>kubectl</code>:</p><p><code>kubectl apply</code> - Внести изменения или обновить ресурс из файла или потока stdin.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Создать сервис из определения в example-service.yaml.</span>
</span></span><span style=display:flex><span>kubectl apply -f example-service.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Создать контроллер репликации из определения в example-controller.yaml.</span>
</span></span><span style=display:flex><span>kubectl apply -f example-controller.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Создать объекты, которые определены в файлах с расширением .yaml, .yml или .json в директории &lt;directory&gt;.</span>
</span></span><span style=display:flex><span>kubectl apply -f &lt;directory&gt;
</span></span></code></pre></div><p><code>kubectl get</code> - Вывести один или несколько ресурсов.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все поды в текстовом формате вывода.</span>
</span></span><span style=display:flex><span>kubectl get pods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все поды в текстовом формате вывода и включить дополнительную информацию (например, имя узла).</span>
</span></span><span style=display:flex><span>kubectl get pods -o wide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести контроллер репликации с указанным именем в текстовом формате вывода. Совет: вы можете использовать сокращенный псевдоним &#39;rc&#39; вместо &#39;replicationcontroller&#39;.</span>
</span></span><span style=display:flex><span>kubectl get replicationcontroller &lt;rc-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все контроллеры репликации и сервисы вместе в текстовом формате вывода.</span>
</span></span><span style=display:flex><span>kubectl get rc,services
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все наборы демонов в текстовом формате вывода.</span>
</span></span><span style=display:flex><span>kubectl get ds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все поды, запущенные на узле server01</span>
</span></span><span style=display:flex><span>kubectl get pods --field-selector<span style=color:#666>=</span>spec.nodeName<span style=color:#666>=</span>server01
</span></span></code></pre></div><p><code>kubectl describe</code> - Показать подробное состояние одного или нескольких ресурсов, по умолчанию также включаются неинициализированные ресурсы.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Показать информацию об узле с именем &lt;node-name&gt;.</span>
</span></span><span style=display:flex><span>kubectl describe nodes &lt;node-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Показать подробности пода &lt;pod-name&gt;.</span>
</span></span><span style=display:flex><span>kubectl describe pods/&lt;pod-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Показать подробности всех подов, управляемые контроллером репликации &lt;rc-name&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Обратите внимание: любые поды, созданные контроллером репликации, имеют префикс с именем контроллера репликации.</span>
</span></span><span style=display:flex><span>kubectl describe pods &lt;rc-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Показать подробности по всем подам</span>
</span></span><span style=display:flex><span>kubectl describe pods
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Заметка:</strong> Как правило, команда <code>kubectl get</code> используется для получения одного или нескольких ресурсов одного и того же типа. Она поддерживает большой набор флагов, с помощью которых можно настроить формат вывода, например, с помощью флага <code>-o</code> или <code>--output</code>.
Вы можете указать флаг <code>-w</code> или <code>--watch</code>, чтобы отслеживать изменения в конкретном объекте. Команда <code>kubectl describe</code> в основном сфокусирована на описание многих взаимосвязанных аспектов указанного ресурса. При генерации вывода для пользователя она может обращаться к API-серверу. К примеру, команда <code>kubectl describe node</code> выдает не только информацию об узле, но и краткий обзор запущенных на нем подов, генерируемых событий и т.д.</div><p><code>kubectl delete</code> - Удалить ресурсы из файла, потока stdin или с помощью селекторов меток, имена, селекторов ресурсов или имен ресурсов.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Удалить под по типу и имени, указанных в файле pod.yaml.</span>
</span></span><span style=display:flex><span>kubectl delete -f pod.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Удалить все поды и сервисы с именем метки &lt;label-name&gt;.</span>
</span></span><span style=display:flex><span>kubectl delete pods,services -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>&lt;label-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Удалить все поды, включая неинициализированные.</span>
</span></span><span style=display:flex><span>kubectl delete pods --all
</span></span></code></pre></div><p><code>kubectl exec</code> - Выполнить команду в контейнере пода.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Получить вывод от запущенной команды &#39;date&#39; в поде &lt;pod-name&gt;. По умолчанию отображается вывод из первого контейнера.</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> &lt;pod-name&gt; date
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить вывод из запущенной команды &#39;date&#39; в контейнере &lt;container-name&gt; пода &lt;pod-name&gt;.</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> &lt;pod-name&gt; -c &lt;container-name&gt; date
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить интерактивный терминал (TTY) и запустить /bin/bash в поде &lt;pod-name&gt;. По умолчанию отображается вывод из первого контейнера.</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> -ti &lt;pod-name&gt; /bin/bash
</span></span></code></pre></div><p><code>kubectl logs</code> - Вывести логи контейнера в поде.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Возвращает текущие логи в поде &lt;pod-name&gt;.</span>
</span></span><span style=display:flex><span>kubectl logs &lt;pod-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывод логов в поде &lt;pod-name&gt; в режиме реального времени. Это похоже на команду &#39;tail -f&#39; Linux.</span>
</span></span><span style=display:flex><span>kubectl logs -f &lt;pod-name&gt;
</span></span></code></pre></div><h2 id=примеры-создание-и-использование-плагинов>Примеры: создание и использование плагинов</h2><p>Посмотрите следующие примеры, чтобы ознакомиться с тем, как писать и использовать плагины <code>kubectl</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Плагин может быть на на любом языке, а сам исполняемый файл должен начинается с префикса &#34;kubectl-&#34;.</span>
</span></span><span style=display:flex><span>cat ./kubectl-hello
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Этот плагин выводит строку &#34;hello world&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;hello world&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Сделать плагин исполняемым</span>
</span></span><span style=display:flex><span>sudo chmod +x ./kubectl-hello
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Переместить его в директорию из PATH</span>
</span></span><span style=display:flex><span>sudo mv ./kubectl-hello /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Плагин дял kubectl создан и &#34;установлен&#34;.</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Воспользоваться плагином можно через kubectl, вызвав его подобно обычной команды.</span>
</span></span><span style=display:flex><span>kubectl hello
</span></span></code></pre></div><pre tabindex=0><code>hello world
</code></pre><pre tabindex=0><code># &#34;Отмена установки&#34; плагина происходит через удаление его файла из директории в PATH.
sudo rm /usr/local/bin/kubectl-hello
</code></pre><p>Посмотреть все доступные плагины <code>kubectl</code> можно с помощью подкоманды <code>kubectl plugin list</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl plugin list
</span></span></code></pre></div><pre tabindex=0><code>The following kubectl-compatible plugins are available:

/usr/local/bin/kubectl-hello
/usr/local/bin/kubectl-foo
/usr/local/bin/kubectl-bar
</code></pre><pre tabindex=0><code># Эта команда также может сообщить, что плагин является неисполняемым,
# либо что плагин переопределен другими плагинами

sudo chmod -x /usr/local/bin/kubectl-foo
kubectl plugin list
</code></pre><pre tabindex=0><code>The following kubectl-compatible plugins are available:

/usr/local/bin/kubectl-hello
/usr/local/bin/kubectl-foo
  - warning: /usr/local/bin/kubectl-foo identified as a plugin, but it is not executable
/usr/local/bin/kubectl-bar

error: one plugin warning was found
</code></pre><p>Плагины можно рассматривать как способ создания более сложной функциональности поверх существующих команд kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat ./kubectl-whoami
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Этот плагин использует команду `kubectl config` для вывода</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># информации о текущем пользователе из текущего выбранного контекста</span>
</span></span><span style=display:flex><span>kubectl config view --template<span style=color:#666>=</span><span style=color:#b44>&#39;{{ range .contexts }}{{ if eq .name &#34;&#39;</span><span style=color:#a2f;font-weight:700>$(</span>kubectl config current-context<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#39;&#34; }}Current user: {{ .context.user }}{{ end }}{{ end }}&#39;</span>
</span></span></code></pre></div><p>Выполнение этого плагина генерирует вывод, содержащий пользователя для текущего выбранного контекста в файле KUBECONFIG:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Сделать файл исполняемым</span>
</span></span><span style=display:flex><span>sudo chmod +x ./kubectl-whoami
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Перенести файл в директорию из PATH</span>
</span></span><span style=display:flex><span>sudo mv ./kubectl-whoami /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl whoami
</span></span><span style=display:flex><span>Current user: plugins-user
</span></span></code></pre></div><p>Чтобы узнать больше о плагинах, изучите <a href=https://github.com/kubernetes/sample-cli-plugin>пример CLI-плагина</a>.</p><h2 id=что-дальше>Что дальше</h2><p>Начните использовать команды <a href=/ru/docs/reference/generated/kubectl/kubectl-commands/>kubectl</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a938176c695852fe70362c29cf615f1c>2.2 - Поддержка JSONPath</h1><p>Kubectl поддерживает шаблон JSONPath.</p><p>Шаблон JSONPath состоит из выражений JSONPath, заключенных в фигурные скобки {}.
Kubectl использует JSONPath-выражения для фильтрации по определенным полям в JSON-объекте и форматирования вывода.
В дополнение к оригинальному синтаксису шаблона JSONPath, допустимы следующие функции и синтаксис:</p><ol><li>Внутри выражений JSONPath текстовые значения заключайте в двойные кавычки.</li><li>Используйте операторы <code>range</code>, <code>end</code>, конечные операторы для перебора списков.</li><li>Используйте отрицательные индексы срезов для перехода на предыдущий элемент в списке. Отрицательные индексы не "зацикливаются" в списке и работают пока истинно выражение <code>-index + listLength >= 0</code>.</li></ol><div class="alert alert-info note callout" role=alert><strong>Заметка:</strong><ul><li><p>Оператор <code>$</code> необязателен, поскольку по умолчанию выражение всегда начинается с корневого объекта.</p></li><li><p>Объект результата выводиться через функцию String().</p></li></ul></div><p>Все примеры ниже будут ориентироваться на следующий JSON-объект:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;kind&#34;</span>: <span style=color:#b44>&#34;List&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;items&#34;</span>:[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;kind&#34;</span>:<span style=color:#b44>&#34;None&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;metadata&#34;</span>:{<span style=color:green;font-weight:700>&#34;name&#34;</span>:<span style=color:#b44>&#34;127.0.0.1&#34;</span>},
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;status&#34;</span>:{
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;capacity&#34;</span>:{<span style=color:green;font-weight:700>&#34;cpu&#34;</span>:<span style=color:#b44>&#34;4&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;addresses&#34;</span>:[{<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;LegacyHostIP&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.1&#34;</span>}]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;kind&#34;</span>:<span style=color:#b44>&#34;None&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;metadata&#34;</span>:{<span style=color:green;font-weight:700>&#34;name&#34;</span>:<span style=color:#b44>&#34;127.0.0.2&#34;</span>},
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;status&#34;</span>:{
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;capacity&#34;</span>:{<span style=color:green;font-weight:700>&#34;cpu&#34;</span>:<span style=color:#b44>&#34;8&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;addresses&#34;</span>:[
</span></span><span style=display:flex><span>          {<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;LegacyHostIP&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.2&#34;</span>},
</span></span><span style=display:flex><span>          {<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;another&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.3&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;users&#34;</span>:[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;myself&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;user&#34;</span>: {}
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;e2e&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;user&#34;</span>: {<span style=color:green;font-weight:700>&#34;username&#34;</span>: <span style=color:#b44>&#34;admin&#34;</span>, <span style=color:green;font-weight:700>&#34;password&#34;</span>: <span style=color:#b44>&#34;secret&#34;</span>}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><table><thead><tr><th>Функция</th><th>Описание</th><th>Пример</th><th>Результат</th></tr></thead><tbody><tr><td><code>text</code></td><td>обычный текст</td><td><code>kind is {.kind}</code></td><td><code>kind is List</code></td></tr><tr><td><code>@</code></td><td>текущий объект</td><td><code>{@}</code></td><td>то же, что и ввод</td></tr><tr><td><code>.</code> или <code>[]</code></td><td>оператор выбора по ключу</td><td><code>{.kind}</code>, <code>{['kind']}</code> или <code>{['name\.type']}</code></td><td><code>List</code></td></tr><tr><td><code>..</code></td><td>рекурсивный спуск</td><td><code>{..name}</code></td><td><code>127.0.0.1 127.0.0.2 myself e2e</code></td></tr><tr><td><code>*</code></td><td>шаблон подстановки. Получение всех объектов</td><td><code>{.items[*].metadata.name}</code></td><td><code>[127.0.0.1 127.0.0.2]</code></td></tr><tr><td><code>[start:end:step]</code></td><td>оператор индексирования</td><td><code>{.users[0].name}</code></td><td><code>myself</code></td></tr><tr><td><code>[,]</code></td><td>оператор объединения</td><td><code>{.items[*]['metadata.name', 'status.capacity']}</code></td><td><code>127.0.0.1 127.0.0.2 map[cpu:4] map[cpu:8]</code></td></tr><tr><td><code>?()</code></td><td>фильтрация</td><td><code>{.users[?(@.name=="e2e")].user.password}</code></td><td><code>secret</code></td></tr><tr><td><code>range</code>, <code>end</code></td><td>перебор списка</td><td><code>{range .items[*]}[{.metadata.name}, {.status.capacity}] {end}</code></td><td><code>[127.0.0.1, map[cpu:4]] [127.0.0.2, map[cpu:8]]</code></td></tr><tr><td><code>''</code></td><td>интерпретируемая в кавычках строка</td><td><code>{range .items[*]}{.metadata.name}{'\t'}{end}</code></td><td><code>127.0.0.1 127.0.0.2</code></td></tr></tbody></table><p>Примеры использования <code>kubectl</code> и JSONPath-выражений:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods -o json
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{@}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[0]}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[0].metadata.name}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*][&#39;metadata.name&#39;, &#39;status.capacity&#39;]}&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{.metadata.name}{&#34;\t&#34;}{.status.startTime}{&#34;\n&#34;}{end}&#39;</span>
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Заметка:</strong><p>В Windows нужно заключить в <em>двойные</em> кавычки JSONPath-шаблон, который содержит пробелы (не в одинарные, как в примерах выше для bash). Таким образом, любые литералы в таких шаблонах нужно оборачивать в одинарные кавычки или экранированные двойные кавычки. Например:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>kubectl get pods -o=jsonpath=<span style=color:#b44>&#34;{range .items[*]}{.metadata.name}{&#39;\t&#39;}{.status.startTime}{&#39;\n&#39;}{end}&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -o=jsonpath=<span style=color:#b44>&#34;{range .items[*]}{.metadata.name}{\&#34;</span>\t\<span style=color:#b44>&#34;}{.status.startTime}{\&#34;</span>\n\<span style=color:#b44>&#34;}{end}&#34;</span>
</span></span></code></pre></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-4d3e62632c189fcc3c1357cd8fb8799c>2.3 - kubectl</h1><h2 id=synopsis>Synopsis</h2><p>kubectl управляет кластерами Kubernetes.</p><p>Более подробная информация по ссылке: <a href=https://kubernetes.io/ru/docs/reference/kubectl/overview/>https://kubernetes.io/ru/docs/reference/kubectl/overview/</a></p><pre tabindex=0><code>kubectl [flags]
</code></pre><h2 id=options>Options</h2><table style=width:100%;table-layout:fixed><col span=1 style=width:10px><col span=1><tbody><tr><td colspan=2>--add-dir-header</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Если true, добавляет директорию файла в заголовок</td></tr><tr><td colspan=2>--alsologtostderr</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Логировать в стандартный поток ошибок, а также в файлы</td></tr><tr><td colspan=2>--application-metrics-count-limit int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 100</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Максимальное количество сохраняемых метрик приложения (на каждый контейнер)</td></tr><tr><td colspan=2>--as string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя пользователя, от которого будет выполняться операция</td></tr><tr><td colspan=2>--as-group stringArray</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Группа, от которой будет выполняться операция, этот флаг можно использовать неоднократно, чтобы указать несколько групп.</td></tr><tr><td colspan=2>--azure-container-registry-config string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к файлу, который содержит информацию с конфигурацией реестра контейнера Azure.</td></tr><tr><td colspan=2>--boot-id-file string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "/proc/sys/kernel/random/boot_id"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Разделенный запятыми список файлов для проверки boot-id. Используйте первый существующий.</td></tr><tr><td colspan=2>--cache-dir string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "$HOME/.kube/http-cache"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Директория HTTP-кеша по умолчанию</td></tr><tr><td colspan=2>--certificate-authority string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к файлу сертификата для центра сертификации</td></tr><tr><td colspan=2>--client-certificate string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к файлу клиентского сертификата для TLS</td></tr><tr><td colspan=2>--client-key string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к файлу клиентского ключа для TLS</td></tr><tr><td colspan=2>--cloud-provider-gce-l7lb-src-cidrs cidrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 130.211.0.0/22,35.191.0.0/16</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Открыть CIDR в брандмауэре GCE для прокси трафика L7 LB и проверки работоспособности</td></tr><tr><td colspan=2>--cloud-provider-gce-lb-src-cidrs cidrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 130.211.0.0/22,209.85.152.0/22,209.85.204.0/22,35.191.0.0/16</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Открыть CIDR в брандмауэре GCE для прокси трафика L4 LB и проверки работоспособности</td></tr><tr><td colspan=2>--cluster string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя используемого кластера kubeconfig</td></tr><tr><td colspan=2>--container-hints string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "/etc/cadvisor/container_hints.json"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к файлу подсказок контейнера</td></tr><tr><td colspan=2>--containerd string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "/run/containerd/containerd.sock"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Конечная точка containerd</td></tr><tr><td colspan=2>--containerd-namespace string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "k8s.io"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Пространство имени containerd</td></tr><tr><td colspan=2>--context string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя контекста kubeconfig</td></tr><tr><td colspan=2>--default-not-ready-toleration-seconds int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 300</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Указывает tolerationSeconds для допущения notReady:NoExecute, которое по умолчанию добавляется к каждому поду, у которого не установлено такое допущение.</td></tr><tr><td colspan=2>--default-unreachable-toleration-seconds int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 300</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Указывает tolerationSeconds для допущения unreachable:NoExecute, которое по умолчанию добавляется к каждому поду, у которого не установлено такое допущение.</td></tr><tr><td colspan=2>--disable-root-cgroup-stats</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Отключить сбор статистики корневой группы (Cgroup)</td></tr><tr><td colspan=2>--docker string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "unix:///var/run/docker.sock"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>docker endpoint</td></tr><tr><td colspan=2>--docker-env-metadata-whitelist string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Список ключей переменных окружения, разделенный запятыми, которые необходимо собрать для Docker-контейнеров</td></tr><tr><td colspan=2>--docker-only</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>В дополнение к корневой статистике уведомлять только о Docker-контейнерах</td></tr><tr><td colspan=2>--docker-root string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "/var/lib/docker"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>УСТАРЕЛО: корень docker считывается из информации docker (запасной вариант, по умолчанию: /var/lib/docker)</td></tr><tr><td colspan=2>--docker-tls</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Использовать TLS для подключения к Docker</td></tr><tr><td colspan=2>--docker-tls-ca string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "ca.pem"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к доверенному CA</td></tr><tr><td colspan=2>--docker-tls-cert string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "cert.pem"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к клиентскому сертификату</td></tr><tr><td colspan=2>--docker-tls-key string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "key.pem"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к приватному ключу</td></tr><tr><td colspan=2>--enable-load-reader</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Включить считыватель нагрузки процессора</td></tr><tr><td colspan=2>--event-storage-age-limit string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "default=0"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Максимальный период времени для хранения события (по каждому типу). Значение флага — список из ключей и значений, разделенные запятыми, где ключи — это типы событий (например: создание, oom) либо "default", а значение — длительность. По умолчанию флаг применяется ко всем неуказанным типам событий</td></tr><tr><td colspan=2>--event-storage-event-limit string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "default=0"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Максимальное количество событий для хранения (по каждому типу). Значение флага — список из ключей и значений, разделенные запятыми, где ключи — это типы событий (например: создание, oom) либо "default", а значение — целое число. По умолчанию флаг применяется ко всем неуказанным типам событий</td></tr><tr><td colspan=2>--global-housekeeping-interval duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 1m0s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Интервал между глобальными служебными операциями (housekeepings)</td></tr><tr><td colspan=2>-h, --help</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Получить справочную информацию по команде kubectl</td></tr><tr><td colspan=2>--housekeeping-interval duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 10s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Интервал между служебными операциями (housekeepings) контейнера</td></tr><tr><td colspan=2>--insecure-skip-tls-verify</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Если true, значит сертификат сервера не будет проверяться на достоверность. Это сделает подключения через HTTPS небезопасными.</td></tr><tr><td colspan=2>--kubeconfig string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Путь к файлу kubeconfig для использования в CLI-запросах.</td></tr><tr><td colspan=2>--log-backtrace-at traceLocation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: :0</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>При логировании указанной строки (file:N), сгенерировать трассировку стека</td></tr><tr><td colspan=2>--log-cadvisor-usage</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Записывать ли в журнал использование контейнера cAdvisor</td></tr><tr><td colspan=2>--log-dir string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Если указан, хранить лог-файлы в этой директории.</td></tr><tr><td colspan=2>--log-file string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Если указан, использовать этот лог-файл</td></tr><tr><td colspan=2>--log-file-max-size uint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 1800</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Установить максимальный размер файла лог-файла (в Мб). Если значение равно 0, максимальный размер файла не ограничен.</td></tr><tr><td colspan=2>--log-flush-frequency duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 5s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Максимальное количество секунд между очисткой лог-файлов</td></tr><tr><td colspan=2>--logtostderr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: true</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Вывод логов в стандартный поток ошибок вместо сохранения их в файлы</td></tr><tr><td colspan=2>--machine-id-file string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "/etc/machine-id,/var/lib/dbus/machine-id"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Список файлов, разделенных запятыми, для проверки machine-id. Используйте первый существующий.</td></tr><tr><td colspan=2>--match-server-version</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Убедиться, что версия сервера соответствует версии клиента</td></tr><tr><td colspan=2>-n, --namespace string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Указать область пространства имен для данного запроса CLI</td></tr><tr><td colspan=2>--password string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Пароль для базовой аутентификации на API-сервере</td></tr><tr><td colspan=2>--profile string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "none"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя профиля. Может быть одним из перечисленных значений: none|cpu|heap|goroutine|threadcreate|block|mutex</td></tr><tr><td colspan=2>--profile-output string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "profile.pprof"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя файла для записи профиля.</td></tr><tr><td colspan=2>--request-timeout string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "0"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Время ожидания перед тем, как перестать ожидать ответ от сервера. Значения должны содержать соответствующую единицу времени (например, 1s, 2m, 3h). Нулевое значение означает, что у запросов нет тайм-аута.</td></tr><tr><td colspan=2>-s, --server string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Адрес и порт API-сервера Kubernetes</td></tr><tr><td colspan=2>--skip-headers</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Если true, не отображать заголовки в сообщениях лога.</td></tr><tr><td colspan=2>--skip-log-headers</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Если true, не отображать заголовки при открытии лог-файлов.</td></tr><tr><td colspan=2>--stderrthreshold severity&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 2</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Логи указанного уровня серьёзности или выше выводить в поток stderr</td></tr><tr><td colspan=2>--storage-driver-buffer-duration duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 1m0s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Буферизировать запись в драйвере хранилища в течение указанного времени, и сохранять в файловом хранилище в виде одной транзакции</td></tr><tr><td colspan=2>--storage-driver-db string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "cadvisor"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя базы данных</td></tr><tr><td colspan=2>--storage-driver-host string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "localhost:8086"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Хост и порт базы данных, записанный в формате host:port</td></tr><tr><td colspan=2>--storage-driver-password string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "root"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Пароль к базе данных</td></tr><tr><td colspan=2>--storage-driver-secure</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Использовать безопасное соединение с базой данных</td></tr><tr><td colspan=2>--storage-driver-table string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "stats"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя таблицы</td></tr><tr><td colspan=2>--storage-driver-user string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: "root"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя пользователя базы данных</td></tr><tr><td colspan=2>--token string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Аутентификационный (bearer) токен для аутентификации на API-сервере</td></tr><tr><td colspan=2>--update-machine-info-interval duration&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;По умолчанию: 5m0s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Интервал между обновлениями информации о машине.</td></tr><tr><td colspan=2>--user string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя пользователя для kubeconfig</td></tr><tr><td colspan=2>--username string</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Имя пользователя для базовой аутентификации на API-сервере</td></tr><tr><td colspan=2>-v, --v Level</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Номер уровня серьёзности логирования</td></tr><tr><td colspan=2>--version version[=true]</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Вывод версии команды</td></tr><tr><td colspan=2>--vmodule moduleSpec</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Список, разделённый запятыми, в виде настроек pattern=N для фильтрации лог-файлов</td></tr></tbody></table><h2 id=see-also>See Also</h2><ul><li><a href=/docs/reference/generated/kubectl/kubectl-commands#annotate>kubectl annotate</a> - Обновить аннотации ресурса.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#api-resources>kubectl api-resources</a> - Вывести доступные API-ресурсы на сервере.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#api-versions>kubectl api-versions</a> - Вывести доступные API-версии на сервере в виде "group/version".</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#apply>kubectl apply</a> - Внести изменения в конфигурацию ресурса из файла или потока stdin.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#attach>kubectl attach</a> - Присоединиться к запущенному контейнеру.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#auth>kubectl auth</a> - Проверить разрешение на выполнение определённых действий.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#autoscale>kubectl autoscale</a> - Автоматически масштабировать Deployment, ReplicaSet или ReplicationController.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#certificate>kubectl certificate</a> - Изменить сертификаты ресурсов.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#cluster-info>kubectl cluster-info</a> - Показать информацию по кластеру.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#completion>kubectl completion</a> - Вывод кода автодополнения указанной командной оболочки (bash или zsh).</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#config>kubectl config</a> - Изменить файлы kubeconfig.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#convert>kubectl convert</a> - Конвертировать конфигурационные файлы в различные API-версии.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#cordon>kubectl cordon</a> - Отметить узел как неназначаемый.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#cp>kubectl cp</a> - Копировать файлы и директории в/из контейнеров.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#create>kubectl create</a> - Создать ресурс из файла или потока stdin.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#delete>kubectl delete</a> - Удалить ресурсы из файла, потока stdin, либо с помощью селекторов меток, имен, селекторов ресурсов или ресурсов.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#describe>kubectl describe</a> - Показать подробную информацию о конкретном ресурсе или группе ресурсов.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#diff>kubectl diff</a> - Сравнить действующую версию с новой (применяемой).</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#drain>kubectl drain</a> - Вытеснить узел для подготовки к эксплуатации.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#edit>kubectl edit</a> - Отредактировать ресурс на сервере.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#exec>kubectl exec</a> - Выполнить команду в контейнере.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#explain>kubectl explain</a> - Получить документацию ресурсов.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#expose>kubectl expose</a> - Создать новый сервис Kubernetes из контроллера репликации, сервиса, развёртывания или пода.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#get>kubectl get</a> - Вывести один или несколько ресурсов.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#kustomize>kubectl kustomize</a> - Собрать ресурсы kustomization из директории или URL-адреса.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#label>kubectl label</a> - Обновить метки ресурса.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#logs>kubectl logs</a> - Вывести логи контейнера в поде.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#options>kubectl options</a> - Вывести список флагов, применяемых ко всем командам.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#patch>kubectl patch</a> - Обновить один или несколько полей ресурса, используя стратегию слияния патча.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#plugin>kubectl plugin</a> - Команда для работы с плагинами.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#port-forward>kubectl port-forward</a> - Переадресовать один или несколько локальных портов в под.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#proxy>kubectl proxy</a> - Запустить прокси на API-сервер Kubernetes.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#replace>kubectl replace</a> - Заменить ресурс из определения в файле или потоке stdin.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#rollout>kubectl rollout</a> - Управление плавающим обновлением ресурса.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#run>kubectl run</a> - Запустить указанный образ в кластере.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#scale>kubectl scale</a> - Задать новый размер для Deployment, ReplicaSet или Replication Controller.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#set>kubectl set</a> - Конфигурировать ресурсы в объектах.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#taint>kubectl taint</a> - Обновить ограничения для одного или нескольких узлов.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#top>kubectl top</a> - Показать информацию по использованию системных ресурсов (процессор, память, диск).</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#uncordon>kubectl uncordon</a> - Отметить узел как назначаемый.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#version>kubectl version</a> - Вывести информацию о версии клиента и сервера.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#wait>kubectl wait</a> - Экспериментально: ожидать выполнения определенного условия в одном или нескольких ресурсах.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a7abc09192597e614b58f8b552b682f5>2.4 - kubectl для пользователей Docker</h1><p>Вы можете использовать инструмент командной строки kubectl в Kubernetes для работы с API-сервером. Если вы знакомы с инструментом командной строки Docker, то использование kubectl не составит проблем. Однако команды docker и kubectl отличаются. В следующих разделах показана подкоманда docker и приведена эквивалентная команда в kubectl.</p><h2 id=docker-run>docker run</h2><p>Для развёртывания nginx и открытия доступа к объекту Deployment используйте команду <a href=/docs/reference/generated/kubectl/kubectl-commands/#run>kubectl run</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker run -d --restart<span style=color:#666>=</span>always -e <span style=color:#b8860b>DOMAIN</span><span style=color:#666>=</span>cluster --name nginx-app -p 80:80 nginx
</span></span></code></pre></div><pre tabindex=0><code>55c103fa129692154a7652490236fee9be47d70a8dd562281ae7d2f9a339a6db
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker ps
</span></span></code></pre></div><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES
55c103fa1296        nginx               &#34;nginx -g &#39;daemon of…&#34;   9 seconds ago       Up 9 seconds        0.0.0.0:80-&gt;80/tcp   nginx-app
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># запустить под, в котором работает nginx</span>
</span></span><span style=display:flex><span>kubectl create deployment --image<span style=color:#666>=</span>nginx nginx-app
</span></span></code></pre></div><pre tabindex=0><code>deployment &#34;nginx-app&#34; created
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># add env to nginx-app</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>set</span> env deployment/nginx-app  <span style=color:#b8860b>DOMAIN</span><span style=color:#666>=</span>cluster
</span></span></code></pre></div><pre tabindex=0><code>deployment.apps/nginx-app env updated
</code></pre><div class="alert alert-info note callout" role=alert><strong>Заметка:</strong> Команды <code>kubectl</code> выводят тип и имя созданного или измененного ресурса, который затем может быть использован в последующих командах. После создания объекта Deployment можно открыть новый сервис Service.</div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># открыть порт, чтобы иметь доступ к сервису</span>
</span></span><span style=display:flex><span>kubectl expose deployment nginx-app --port<span style=color:#666>=</span><span style=color:#666>80</span> --name<span style=color:#666>=</span>nginx-http
</span></span></code></pre></div><pre tabindex=0><code>service &#34;nginx-http&#34; exposed
</code></pre><p>С помощью kubectl можно создать объект <a href=/docs/concepts/workloads/controllers/deployment/>Deployment</a>, чтобы убедиться, что N подов, запущены под nginx, где N — это количество реплик, указанных в спецификации (по умолчанию — 1).
Вы также можете создать <a href=/docs/concepts/services-networking/service/>сервис</a> с селектором, соответствующим меткам подов. Для получения дополнительной информации перейдите на страницу <a href=/docs/tasks/access-application-cluster/service-access-application-cluster>Use a Service to Access an Application in a Cluster</a>.</p><p>По умолчанию образы запускаются в фоновом режиме, аналогично команде <code>docker run -d ...</code>. Для запуска в центральном (интерактивном) режиме используйте команду ниже:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl run <span style=color:#666>[</span>-i<span style=color:#666>]</span> <span style=color:#666>[</span>--tty<span style=color:#666>]</span> --attach &lt;name&gt; --image<span style=color:#666>=</span>&lt;image&gt;
</span></span></code></pre></div><p>В отличие от <code>docker run ...</code>, если вы укажете <code>--attach</code>, то присоедините <code>stdin</code>, <code>stdout</code> and <code>stderr</code>. Нельзя проконтролировать, какие потоки прикрепляются (<code>docker -a ...</code>).
Чтобы отсоединиться от контейнера, воспользуетесь комбинацией клавиш Ctrl+P, а затем Ctrl+Q.</p><p>Так как команда kubectl run запускает развёртывание для контейнера, то оно начнет перезапускаться, если завершить прикрепленный процесс по нажатию Ctrl+C, в отличие от команды <code>docker run -it</code>.
Для удаления объекта Deployment вместе с подами, необходимо выполнить команду <code>kubectl delete deployment &lt;name></code>.</p><h2 id=docker-ps>docker ps</h2><p>Посмотреть, что сейчас запущено можно с помощью команды <a href=/docs/reference/generated/kubectl/kubectl-commands/#get>kubectl get</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker ps -a
</span></span></code></pre></div><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS                     PORTS                NAMES
14636241935f        ubuntu:16.04        &#34;echo test&#34;              5 seconds ago        Exited (0) 5 seconds ago                        cocky_fermi
55c103fa1296        nginx               &#34;nginx -g &#39;daemon of…&#34;   About a minute ago   Up About a minute          0.0.0.0:80-&gt;80/tcp   nginx-app
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get po
</span></span></code></pre></div><pre tabindex=0><code>NAME                        READY     STATUS      RESTARTS   AGE
nginx-app-8df569cb7-4gd89   1/1       Running     0          3m
ubuntu                      0/1       Completed   0          20s
</code></pre><h2 id=docker-attach>docker attach</h2><p>Чтобы присоединить процесс, который уже запущен в контейнере, используйте команду <a href=/docs/reference/generated/kubectl/kubectl-commands/#attach>kubectl attach</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker ps
</span></span></code></pre></div><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES
55c103fa1296        nginx               &#34;nginx -g &#39;daemon of…&#34;   5 minutes ago       Up 5 minutes        0.0.0.0:80-&gt;80/tcp   nginx-app
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker attach 55c103fa1296
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods
</span></span></code></pre></div><pre tabindex=0><code>NAME              READY     STATUS    RESTARTS   AGE
nginx-app-5jyvm   1/1       Running   0          10m
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl attach -it nginx-app-5jyvm
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>Для отсоединения его от контейнера используйте сочетания клавиш Ctrl+P и Ctrl+Q.</p><h2 id=docker-exec>docker exec</h2><p>Для выполнения команды в контейнере используйте команду <a href=/docs/reference/generated/kubectl/kubectl-commands/#exec>kubectl exec</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker ps
</span></span></code></pre></div><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES
55c103fa1296        nginx               &#34;nginx -g &#39;daemon of…&#34;   6 minutes ago       Up 6 minutes        0.0.0.0:80-&gt;80/tcp   nginx-app
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker <span style=color:#a2f>exec</span> 55c103fa1296 cat /etc/hostname
</span></span></code></pre></div><pre tabindex=0><code>55c103fa1296
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get po
</span></span></code></pre></div><pre tabindex=0><code>NAME              READY     STATUS    RESTARTS   AGE
nginx-app-5jyvm   1/1       Running   0          10m
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> nginx-app-5jyvm -- cat /etc/hostname
</span></span></code></pre></div><pre tabindex=0><code>nginx-app-5jyvm
</code></pre><p>Примеры с командной оболочкой</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker <span style=color:#a2f>exec</span> -ti 55c103fa1296 /bin/sh
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># exit</span>
</span></span></code></pre></div><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> -ti nginx-app-5jyvm -- /bin/sh
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># exit</span>
</span></span></code></pre></div><p>Для получения дополнительной информации обратитесь к странице <a href=/docs/tasks/debug-application-cluster/get-shell-running-container/>Get a Shell to a Running Container</a>.</p><h2 id=docker-logs>docker logs</h2><p>Для отслеживания логов в потоки stdout/stderr запущенного процесса используйте команду <a href=/docs/reference/generated/kubectl/kubectl-commands/#logs>kubectl logs</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker logs -f a9e
</span></span></code></pre></div><pre tabindex=0><code>192.168.9.1 - - [14/Jul/2015:01:04:02 +0000] &#34;GET / HTTP/1.1&#34; 200 612 &#34;-&#34; &#34;curl/7.35.0&#34; &#34;-&#34;
192.168.9.1 - - [14/Jul/2015:01:04:03 +0000] &#34;GET / HTTP/1.1&#34; 200 612 &#34;-&#34; &#34;curl/7.35.0&#34; &#34;-&#34;
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl logs -f nginx-app-zibvs
</span></span></code></pre></div><pre tabindex=0><code>10.240.63.110 - - [14/Jul/2015:01:09:01 +0000] &#34;GET / HTTP/1.1&#34; 200 612 &#34;-&#34; &#34;curl/7.26.0&#34; &#34;-&#34;
10.240.63.110 - - [14/Jul/2015:01:09:02 +0000] &#34;GET / HTTP/1.1&#34; 200 612 &#34;-&#34; &#34;curl/7.26.0&#34; &#34;-&#34;
</code></pre><p>Есть небольшая разница между подами и контейнерами: по умолчанию поды не прекращают выполнение, если их процессы завершаются. Вместо этого поды перезапускают процесс. Это похоже на опцию <code>--restart=always</code> в Docker, только с одной большой разницей. В Docker вывод каждого вызова процесса объединяется, в отличие от Kubernetes, где каждый вызов является отдельным. Для просмотра вывода предыдущего запуска в Kubernetes, используйте команду ниже:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl logs --previous nginx-app-zibvs
</span></span></code></pre></div><pre tabindex=0><code>10.240.63.110 - - [14/Jul/2015:01:09:01 +0000] &#34;GET / HTTP/1.1&#34; 200 612 &#34;-&#34; &#34;curl/7.26.0&#34; &#34;-&#34;
10.240.63.110 - - [14/Jul/2015:01:09:02 +0000] &#34;GET / HTTP/1.1&#34; 200 612 &#34;-&#34; &#34;curl/7.26.0&#34; &#34;-&#34;
</code></pre><p>Для получения дополнительной информации обратитесь к странице <a href=/docs/concepts/cluster-administration/logging/>Logging Architecture</a>.</p><h2 id=docker-stop-и-docker-rm>docker stop и docker rm</h2><p>Для завершения и удаления запущенного процесса используйте команду <a href=/docs/reference/generated/kubectl/kubectl-commands/#delete>kubectl delete</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker ps
</span></span></code></pre></div><pre tabindex=0><code>CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                         NAMES
a9ec34d98787        nginx               &#34;nginx -g &#39;daemon of&#34;  22 hours ago        Up 22 hours         0.0.0.0:80-&gt;80/tcp, 443/tcp   nginx-app
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker stop a9ec34d98787
</span></span></code></pre></div><pre tabindex=0><code>a9ec34d98787
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker rm a9ec34d98787
</span></span></code></pre></div><pre tabindex=0><code>a9ec34d98787
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get deployment nginx-app
</span></span></code></pre></div><pre tabindex=0><code>NAME         READY   UP-TO-DATE   AVAILABLE   AGE
nginx-app    1/1     1            1           2m
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get po -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>nginx-app
</span></span></code></pre></div><pre tabindex=0><code>NAME                         READY     STATUS    RESTARTS   AGE
nginx-app-2883164633-aklf7   1/1       Running   0          2m
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl delete deployment nginx-app
</span></span></code></pre></div><pre tabindex=0><code>deployment &#34;nginx-app&#34; deleted
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get po -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>nginx-app
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Return nothing</span>
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Заметка:</strong> При использовании kubectl удалить под напрямую не получится. Для этого сначала нужно удалить объект Deployment, которому принадлежит под. Если вы удалите под напрямую, то объект Deployment пересоздаст под.</div><h2 id=docker-login>docker login</h2><p>В kubectl нет прямого аналога команды <code>docker login</code>. Если вы планируете использовать Kubernetes с приватным реестром, изучите страницу <a href=/docs/concepts/containers/images/#using-a-private-registry>Using a Private Registry</a>.</p><h2 id=docker-version>docker version</h2><p>Для получения версии клиента и сервера используйте команду <a href=/docs/reference/generated/kubectl/kubectl-commands/#version>kubectl version</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker version
</span></span></code></pre></div><pre tabindex=0><code>Client version: 1.7.0
Client API version: 1.19
Go version (client): go1.4.2
Git commit (client): 0baf609
OS/Arch (client): linux/amd64
Server version: 1.7.0
Server API version: 1.19
Go version (server): go1.4.2
Git commit (server): 0baf609
OS/Arch (server): linux/amd64
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl version
</span></span></code></pre></div><pre tabindex=0><code>Client Version: version.Info{Major:&#34;1&#34;, Minor:&#34;6&#34;, GitVersion:&#34;v1.6.9+a3d1dfa6f4335&#34;, GitCommit:&#34;9b77fed11a9843ce3780f70dd251e92901c43072&#34;, GitTreeState:&#34;dirty&#34;, BuildDate:&#34;2017-08-29T20:32:58Z&#34;, OpenPaasKubernetesVersion:&#34;v1.03.02&#34;, GoVersion:&#34;go1.7.5&#34;, Compiler:&#34;gc&#34;, Platform:&#34;linux/amd64&#34;}
Server Version: version.Info{Major:&#34;1&#34;, Minor:&#34;6&#34;, GitVersion:&#34;v1.6.9+a3d1dfa6f4335&#34;, GitCommit:&#34;9b77fed11a9843ce3780f70dd251e92901c43072&#34;, GitTreeState:&#34;dirty&#34;, BuildDate:&#34;2017-08-29T20:32:58Z&#34;, OpenPaasKubernetesVersion:&#34;v1.03.02&#34;, GoVersion:&#34;go1.7.5&#34;, Compiler:&#34;gc&#34;, Platform:&#34;linux/amd64&#34;}
</code></pre><h2 id=docker-info>docker info</h2><p>Для получения разной информации про окружение и конфигурации перейдите в раздел <a href=/docs/reference/generated/kubectl/kubectl-commands/#cluster-info>kubectl cluster-info</a>.</p><p>docker:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>docker info
</span></span></code></pre></div><pre tabindex=0><code>Containers: 40
Images: 168
Storage Driver: aufs
 Root Dir: /usr/local/google/docker/aufs
 Backing Filesystem: extfs
 Dirs: 248
 Dirperm1 Supported: false
Execution Driver: native-0.2
Logging Driver: json-file
Kernel Version: 3.13.0-53-generic
Operating System: Ubuntu 14.04.2 LTS
CPUs: 12
Total Memory: 31.32 GiB
Name: k8s-is-fun.mtv.corp.google.com
ID: ADUV:GCYR:B3VJ:HMPO:LNPQ:KD5S:YKFQ:76VN:IANZ:7TFV:ZBF4:BYJO
WARNING: No swap limit support
</code></pre><p>kubectl:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl cluster-info
</span></span></code></pre></div><pre tabindex=0><code>Kubernetes master is running at https://203.0.113.141
KubeDNS is running at https://203.0.113.141/api/v1/namespaces/kube-system/services/kube-dns/proxy
kubernetes-dashboard is running at https://203.0.113.141/api/v1/namespaces/kube-system/services/kubernetes-dashboard/proxy
Grafana is running at https://203.0.113.141/api/v1/namespaces/kube-system/services/monitoring-grafana/proxy
Heapster is running at https://203.0.113.141/api/v1/namespaces/kube-system/services/monitoring-heapster/proxy
InfluxDB is running at https://203.0.113.141/api/v1/namespaces/kube-system/services/monitoring-influxdb/proxy
</code></pre></div><div class=td-content style=page-break-before:always><h1 id=pg-d7ffbf04ffbefb241fd0722423b80f5a>2.5 - Команды kubectl</h1><p><a href=/docs/reference/generated/kubectl/kubectl-commands/>Справочник команд kubectl</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-8aba901ac13f124e5782b90ddb166ee2>2.6 - Шпаргалка по kubectl</h1><p>Смотрите также: <a href=/ru/docs/reference/kubectl/overview/>обзор Kubectl</a> и <a href=/ru/docs/reference/kubectl/jsonpath>руководство по JsonPath</a>.</p><p>Эта команда представляет собой обзор команды <code>kubectl</code>.</p><h1 id=kubectl-шпаргалка>kubectl - Шпаргалка</h1><h2 id=автодополнение-ввода-для-kubectl>Автодополнение ввода для Kubectl</h2><h3 id=bash>BASH</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion bash<span style=color:#666>)</span> <span style=color:#080;font-style:italic># настройка автодополнения в текущую сессию bash, предварительно должен быть установлен пакет bash-completion .</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;source &lt;(kubectl completion bash)&#34;</span> &gt;&gt; ~/.bashrc <span style=color:#080;font-style:italic># добавление автодополнения autocomplete постоянно в командную оболочку bash.</span>
</span></span></code></pre></div><p>Вы также можете использовать короткий псевдоним для <code>kubectl</code>, который можно интегрировать с автодополнениями:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>alias</span> <span style=color:#b8860b>k</span><span style=color:#666>=</span>kubectl
</span></span><span style=display:flex><span><span style=color:#a2f>complete</span> -F __start_kubectl k
</span></span></code></pre></div><h3 id=zsh>ZSH</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>  <span style=color:#080;font-style:italic># настройка автодополнения в текущую сессию zsh</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;[[ </span><span style=color:#b8860b>$commands</span><span style=color:#b44>[kubectl] ]] &amp;&amp; source &lt;(kubectl completion zsh)&#34;</span> &gt;&gt; ~/.zshrc <span style=color:#080;font-style:italic># add autocomplete permanently to your zsh shell</span>
</span></span></code></pre></div><h2 id=контекст-и-конфигурация-kubectl>Контекст и конфигурация kubectl</h2><p>Установка того, с каким Kubernetes-кластером взаимодействует <code>kubectl</code> и изменяет конфигурационную информацию. Подробную информацию о конфигурационном файле смотрите на странице <a href=/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>Authenticating Across Clusters with kubeconfig</a>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config view <span style=color:#080;font-style:italic># показать объединённые настройки kubeconfig</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># использовать несколько файлов kubeconfig одновременно и посмотреть объединённую конфигурацию из этих файлов</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span>~/.kube/config:~/.kube/kubconfig2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config view
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># получить пароль для пользователя e2e</span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[?(@.name == &#34;e2e&#34;)].user.password}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[].name}&#39;</span>    <span style=color:#080;font-style:italic># показать первого пользователя</span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[*].name}&#39;</span>   <span style=color:#080;font-style:italic># получить список пользователей</span>
</span></span><span style=display:flex><span>kubectl config get-contexts                          <span style=color:#080;font-style:italic># показать список контекстов</span>
</span></span><span style=display:flex><span>kubectl config current-context                       <span style=color:#080;font-style:italic># показать текущий контекст (current-context)</span>
</span></span><span style=display:flex><span>kubectl config use-context my-cluster-name           <span style=color:#080;font-style:italic># установить my-cluster-name как контекст по умолчанию</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># добавить новую конфигурацию для кластера в kubeconf с базовой аутентификацией</span>
</span></span><span style=display:flex><span>kubectl config set-credentials kubeuser/foo.kubernetes.com --username<span style=color:#666>=</span>kubeuser --password<span style=color:#666>=</span>kubepassword
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># сохранить пространство имен для всех последующих команд kubectl в этом контексте.</span>
</span></span><span style=display:flex><span>kubectl config set-context --current --namespace<span style=color:#666>=</span>ggckad-s2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># установить контекст, используя имя пользователя и пространство имен.</span>
</span></span><span style=display:flex><span>kubectl config set-context gce --user<span style=color:#666>=</span>cluster-admin --namespace<span style=color:#666>=</span>foo <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  <span style=color:#666>&amp;&amp;</span> kubectl config use-context gce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config <span style=color:#a2f>unset</span> users.foo                       <span style=color:#080;font-style:italic># удалить пользователя foo</span>
</span></span></code></pre></div><h2 id=apply>Apply</h2><p><code>apply</code> управляет приложениями с помощью файлов, которые определяют ресурсы Kubernetes. Выполните команду <code>kubectl apply</code> для создания и обновления ресурсов. Это рекомендуемый способ управления приложениями Kubernetes в промышленном окружении. Смотрите <a href=https://kubectl.docs.kubernetes.io>Kubectl Book</a>.</p><h2 id=создание-объектов>Создание объектов</h2><p>Манифесты Kubernetes могут быть определены в YAML или JSON. Можно использовать расширение файла <code>.yaml</code>, <code>.yml</code> и <code>.json</code></p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f ./my-manifest.yaml            <span style=color:#080;font-style:italic># создать ресурсы</span>
</span></span><span style=display:flex><span>kubectl apply -f ./my1.yaml -f ./my2.yaml      <span style=color:#080;font-style:italic># создать ресурсы из нескольких файлов</span>
</span></span><span style=display:flex><span>kubectl apply -f ./dir                         <span style=color:#080;font-style:italic># создать ресурсы из всех файлов манифеста в директории</span>
</span></span><span style=display:flex><span>kubectl apply -f https://git.io/vPieo          <span style=color:#080;font-style:italic># создать ресурсы из URL-адреса</span>
</span></span><span style=display:flex><span>kubectl create deployment nginx --image<span style=color:#666>=</span>nginx  <span style=color:#080;font-style:italic># запустить один экземпляр nginx</span>
</span></span><span style=display:flex><span>kubectl explain pods                           <span style=color:#080;font-style:italic># посмотреть документацию по манифестам подов</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Создать несколько YAML-объектов из stdin</span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: busybox-sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>  - name: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    image: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    args:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>    - &#34;1000000&#34;
</span></span></span><span style=display:flex><span><span style=color:#b44>---
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: busybox-sleep-less
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>  - name: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    image: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    args:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>    - &#34;1000&#34;
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Создать секрет с несколькими ключами</span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Secret
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: mysecret
</span></span></span><span style=display:flex><span><span style=color:#b44>type: Opaque
</span></span></span><span style=display:flex><span><span style=color:#b44>data:
</span></span></span><span style=display:flex><span><span style=color:#b44>  password: $(echo -n &#34;s33msi4&#34; | base64 -w0)
</span></span></span><span style=display:flex><span><span style=color:#b44>  username: $(echo -n &#34;jane&#34; | base64 -w0)
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span></code></pre></div><h2 id=просмотр-и-поиск-ресурсов>Просмотр и поиск ресурсов</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># Get-команды с основном выводом</span>
</span></span><span style=display:flex><span>kubectl get services                          <span style=color:#080;font-style:italic># Вывести все сервисы в пространстве имён</span>
</span></span><span style=display:flex><span>kubectl get pods --all-namespaces             <span style=color:#080;font-style:italic># Вывести все поды во всех пространств имён</span>
</span></span><span style=display:flex><span>kubectl get pods -o wide                      <span style=color:#080;font-style:italic># Вывести все поды в текущем пространстве имён с подробностями</span>
</span></span><span style=display:flex><span>kubectl get deployment my-dep                 <span style=color:#080;font-style:italic># Вывести определённое развёртывание</span>
</span></span><span style=display:flex><span>kubectl get pods                              <span style=color:#080;font-style:italic># Вывести все поды в пространстве имён</span>
</span></span><span style=display:flex><span>kubectl get pod my-pod -o yaml                <span style=color:#080;font-style:italic># Получить информацию по поду в формате YAML</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Посмотреть дополнительные сведения команды с многословным выводом</span>
</span></span><span style=display:flex><span>kubectl describe nodes my-node
</span></span><span style=display:flex><span>kubectl describe pods my-pod
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести сервисы, отсортированные по имени</span>
</span></span><span style=display:flex><span>kubectl get services --sort-by<span style=color:#666>=</span>.metadata.name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести поды, отсортированные по количеству перезагрузок</span>
</span></span><span style=display:flex><span>kubectl get pods --sort-by<span style=color:#666>=</span><span style=color:#b44>&#39;.status.containerStatuses[0].restartCount&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести постоянные тома (PersistentVolumes), отсортированные по емкости</span>
</span></span><span style=display:flex><span>kubectl get pv --sort-by<span style=color:#666>=</span>.spec.capacity.storage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить метку версии всех подов с меткой app=cassandra</span>
</span></span><span style=display:flex><span>kubectl get pods --selector<span style=color:#666>=</span><span style=color:#b8860b>app</span><span style=color:#666>=</span>cassandra -o <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[*].metadata.labels.version}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить все рабочие узлы (с помощью селектора исключаем узлы с меткой &#39;node-role.kubernetes.io/master&#39;)</span>
</span></span><span style=display:flex><span>kubectl get node --selector<span style=color:#666>=</span><span style=color:#b44>&#39;!node-role.kubernetes.io/master&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить все запущенные поды в пространстве имён</span>
</span></span><span style=display:flex><span>kubectl get pods --field-selector<span style=color:#666>=</span>status.phase<span style=color:#666>=</span>Running
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить внешние IP-адреса (ExternalIP) всех узлов</span>
</span></span><span style=display:flex><span>kubectl get nodes -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[*].status.addresses[?(@.type==&#34;ExternalIP&#34;)].address}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести имена подов, принадлежащие к определённому RC</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Использование команды &#34;jq&#34; помогает упросить поиск в jsonpath, подробнее смотрите на сайте https://stedolan.github.io/jq/</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>sel</span><span style=color:#666>=</span><span style=color:#b68;font-weight:700>${</span><span style=color:#a2f;font-weight:700>$(</span>kubectl get rc my-rc --output<span style=color:#666>=</span>json | jq -j <span style=color:#b44>&#39;.spec.selector | to_entries | .[] | &#34;\(.key)=\(.value),&#34;&#39;</span><span style=color:#a2f;font-weight:700>)</span>%?<span style=color:#b68;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#a2f;font-weight:700>$(</span>kubectl get pods --selector<span style=color:#666>=</span><span style=color:#b8860b>$sel</span> --output<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>={</span>.items..metadata.name<span style=color:#666>}</span><span style=color:#a2f;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Показать метки всех подов (или любого другого объекта Kubernetes, которым можно прикреплять метки)</span>
</span></span><span style=display:flex><span>kubectl get pods --show-labels
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Получить готовые узлы</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>JSONPATH</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{@.metadata.name}:{range @.status.conditions[*]}{@.type}={@.status};{end}{end}&#39;</span> <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span> <span style=color:#666>&amp;&amp;</span> kubectl get nodes -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;</span><span style=color:#b8860b>$JSONPATH</span><span style=color:#b44>&#34;</span> | grep <span style=color:#b44>&#34;Ready=True&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывод декодированных секретов без внешних инструментов</span>
</span></span><span style=display:flex><span>kubectl get secret my-secret -o go-template<span style=color:#666>=</span><span style=color:#b44>&#39;{{range $k,$v := .data}}{{&#34;### &#34;}}{{$k}}{{&#34;\n&#34;}}{{$v|base64decode}}{{&#34;\n\n&#34;}}{{end}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все секреты, используемые сейчас в поде.</span>
</span></span><span style=display:flex><span>kubectl get pods -o json | jq <span style=color:#b44>&#39;.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name&#39;</span> | grep -v null | sort | uniq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести все идентификаторы (containerID) контейнеров инициализации (initContainers) во всех подах.</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Это полезно при очистке остановленных контейнеров, не удаляя при этом контейнеры инициализации.</span>
</span></span><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*].status.initContainerStatuses[*]}{.containerID}{&#34;\n&#34;}{end}&#39;</span> | cut -d/ -f3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Вывести события, отсортированные по временной метке</span>
</span></span><span style=display:flex><span>kubectl get events --sort-by<span style=color:#666>=</span>.metadata.creationTimestamp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Сравнить текущее состояние кластера с состоянием, в котором находился бы кластер в случае применения манифеста.</span>
</span></span><span style=display:flex><span>kubectl diff -f ./my-manifest.yaml
</span></span></code></pre></div><h2 id=обновление-ресурсов>Обновление ресурсов</h2><p>Начиная с версии 1.11 подкоманда <code>rolling-update</code> была удалена (см. <a href=https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.11.md>CHANGELOG-1.11.md</a>), поэтому вместо неё используйте <code>rollout</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl <span style=color:#a2f>set</span> image deployment/frontend <span style=color:#b8860b>www</span><span style=color:#666>=</span>image:v2               <span style=color:#080;font-style:italic># Плавающее обновление контейнеров &#34;www&#34; развёртывания &#34;frontend&#34;, обновление образа</span>
</span></span><span style=display:flex><span>kubectl rollout <span style=color:#a2f>history</span> deployment/frontend                      <span style=color:#080;font-style:italic># Проверить историю развёртывания, включая ревизии.</span>
</span></span><span style=display:flex><span>kubectl rollout undo deployment/frontend                         <span style=color:#080;font-style:italic># Откатиться к предыдущему развёртыванию</span>
</span></span><span style=display:flex><span>kubectl rollout undo deployment/frontend --to-revision<span style=color:#666>=</span><span style=color:#666>2</span>         <span style=color:#080;font-style:italic># Откатиться к определённой ревизии</span>
</span></span><span style=display:flex><span>kubectl rollout status -w deployment/frontend                    <span style=color:#080;font-style:italic># Отслеживать статус плавающего развёртывания &#34;frontend&#34; до его завершения</span>
</span></span><span style=display:flex><span>kubectl rollout restart deployment/frontend                      <span style=color:#080;font-style:italic># Перезапуск плавающего развёртывания &#34;frontend&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Объявлено устаревшим, начиная с версии 1.11</span>
</span></span><span style=display:flex><span>kubectl rolling-update frontend-v1 -f frontend-v2.json           <span style=color:#080;font-style:italic># (устарело) Плавающее обновление подов frontend-v1</span>
</span></span><span style=display:flex><span>kubectl rolling-update frontend-v1 frontend-v2 --image<span style=color:#666>=</span>image:v2  <span style=color:#080;font-style:italic># (устарело) Изменить имя ресурса и обновить образ</span>
</span></span><span style=display:flex><span>kubectl rolling-update frontend --image<span style=color:#666>=</span>image:v2                 <span style=color:#080;font-style:italic># (устарело) Обновить образ подов frontend</span>
</span></span><span style=display:flex><span>kubectl rolling-update frontend-v1 frontend-v2 --rollback        <span style=color:#080;font-style:italic># (устарело) Отменить выполняющееся обновление</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat pod.json | kubectl replace -f -                              <span style=color:#080;font-style:italic># Заменить под из определения в JSON-файле, переданного в поток stdin</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Принудительно заменить, удалить, а затем пересоздать ресурс. Это приведет к простою приложения</span>
</span></span><span style=display:flex><span>kubectl replace --force -f ./pod.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Создать сервис с реплицированным nginx на порту 80, который подключается к контейнерам на порту 8000.</span>
</span></span><span style=display:flex><span>kubectl expose rc nginx --port<span style=color:#666>=</span><span style=color:#666>80</span> --target-port<span style=color:#666>=</span><span style=color:#666>8000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Обновить версию (метку) образа пода из одного контейнера single до v4</span>
</span></span><span style=display:flex><span>kubectl get pod mypod -o yaml | sed <span style=color:#b44>&#39;s/\(image: myimage\):.*$/\1:v4/&#39;</span> | kubectl replace -f -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl label pods my-pod new-label<span style=color:#666>=</span>awesome                      <span style=color:#080;font-style:italic># Добавить метку</span>
</span></span><span style=display:flex><span>kubectl annotate pods my-pod icon-url<span style=color:#666>=</span>http://goo.gl/XXBTWq       <span style=color:#080;font-style:italic># Добавить аннотацию</span>
</span></span><span style=display:flex><span>kubectl autoscale deployment foo --min<span style=color:#666>=</span><span style=color:#666>2</span> --max<span style=color:#666>=</span><span style=color:#666>10</span>                <span style=color:#080;font-style:italic># Автоматически масштабировать развёртывание &#34;foo&#34; в диапазоне от 2 до 10 подов</span>
</span></span></code></pre></div><h2 id=обновление-ресурсов-1>Обновление ресурсов</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># Обновить часть узла</span>
</span></span><span style=display:flex><span>kubectl patch node k8s-node-1 -p <span style=color:#b44>&#39;{&#34;spec&#34;:{&#34;unschedulable&#34;:true}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Обновить образ контейнера; необходимо указать spec.containers[*].name, чтобы произвести слияние</span>
</span></span><span style=display:flex><span>kubectl patch pod valid-pod -p <span style=color:#b44>&#39;{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;kubernetes-serve-hostname&#34;,&#34;image&#34;:&#34;new image&#34;}]}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Обновить образ контейнера через json-патч с позиционными массивами</span>
</span></span><span style=display:flex><span>kubectl patch pod valid-pod --type<span style=color:#666>=</span><span style=color:#b44>&#39;json&#39;</span> -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;replace&#34;, &#34;path&#34;: &#34;/spec/containers/0/image&#34;, &#34;value&#34;:&#34;new image&#34;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Удалить развертывание livenessProbe через json-патч с позиционными массивами</span>
</span></span><span style=display:flex><span>kubectl patch deployment valid-deployment  --type json   -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;remove&#34;, &#34;path&#34;: &#34;/spec/template/spec/containers/0/livenessProbe&#34;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Добавить нового элемента в позиционный массив</span>
</span></span><span style=display:flex><span>kubectl patch sa default --type<span style=color:#666>=</span><span style=color:#b44>&#39;json&#39;</span> -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/secrets/1&#34;, &#34;value&#34;: {&#34;name&#34;: &#34;whatever&#34; } }]&#39;</span>
</span></span></code></pre></div><h2 id=редактирование-ресурсов>Редактирование ресурсов</h2><p>Вы можете отредактировать API-ресурс в любом редакторе.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl edit svc/docker-registry                      <span style=color:#080;font-style:italic># Отредактировать сервис docker-registry</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>KUBE_EDITOR</span><span style=color:#666>=</span><span style=color:#b44>&#34;nano&#34;</span> kubectl edit svc/docker-registry   <span style=color:#080;font-style:italic># Использовать другой редактор</span>
</span></span></code></pre></div><h2 id=масштабирование-ресурсов>Масштабирование ресурсов</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>3</span> rs/foo                                 <span style=color:#080;font-style:italic># Масштабирование набора реплик (replicaset) &#39;foo&#39; до 3</span>
</span></span><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>3</span> -f foo.yaml                            <span style=color:#080;font-style:italic># Масштабирование ресурса в &#34;foo.yaml&#34; до 3</span>
</span></span><span style=display:flex><span>kubectl scale --current-replicas<span style=color:#666>=</span><span style=color:#666>2</span> --replicas<span style=color:#666>=</span><span style=color:#666>3</span> deployment/mysql  <span style=color:#080;font-style:italic># Если количество реплик в развёртывании mysql равен 2, масштабировать его до 3</span>
</span></span><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>5</span> rc/foo rc/bar rc/baz                   <span style=color:#080;font-style:italic># Масштабирование нескольких контроллеров репликации до 5</span>
</span></span></code></pre></div><h2 id=удаление-ресурсов>Удаление ресурсов</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f ./pod.json                                              <span style=color:#080;font-style:italic># Удалить под по типу и имени в pod.json</span>
</span></span><span style=display:flex><span>kubectl delete pod,service baz foo                                        <span style=color:#080;font-style:italic># Удалить поды и сервисы с одноимёнными именам &#34;baz&#34; и &#34;foo&#34;</span>
</span></span><span style=display:flex><span>kubectl delete pods,services -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel                              <span style=color:#080;font-style:italic># Удалить поды и сервисы с именем метки myLabel</span>
</span></span><span style=display:flex><span>kubectl -n my-ns delete pod,svc --all                                     <span style=color:#080;font-style:italic># Удалить все поды и сервисы в пространстве имен my-ns</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Удалить все поды, соответствующие pattern1 или pattern2 в awk</span>
</span></span><span style=display:flex><span>kubectl get pods  -n mynamespace --no-headers<span style=color:#666>=</span><span style=color:#a2f>true</span> | awk <span style=color:#b44>&#39;/pattern1|pattern2/{print $1}&#39;</span> | xargs  kubectl delete -n mynamespace pod
</span></span></code></pre></div><h2 id=работа-с-запущенными-подами>Работа с запущенными подами</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs my-pod                                 <span style=color:#080;font-style:italic># вывести логи пода (в stdout)</span>
</span></span><span style=display:flex><span>kubectl logs -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel                        <span style=color:#080;font-style:italic># вывести логи пода с меткой myLabel (в stdout)</span>
</span></span><span style=display:flex><span>kubectl logs my-pod --previous                      <span style=color:#080;font-style:italic># вывести логи пода (в stdout) по предыдущему экземпляру контейнера</span>
</span></span><span style=display:flex><span>kubectl logs my-pod -c my-container                 <span style=color:#080;font-style:italic># вывести логи контейнера пода (в stdout, при работе с несколькими контейнерами)</span>
</span></span><span style=display:flex><span>kubectl logs -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel -c my-container        <span style=color:#080;font-style:italic># вывести логи пода с меткой myLabel (в stdout)</span>
</span></span><span style=display:flex><span>kubectl logs my-pod -c my-container --previous      <span style=color:#080;font-style:italic># вывести логи контейнера пода (в stdout, при работе с несколькими контейнерами) по предыдущему экземпляру контейнера</span>
</span></span><span style=display:flex><span>kubectl logs -f my-pod                              <span style=color:#080;font-style:italic># вывести логи пода в режиме реального времени (в stdout)</span>
</span></span><span style=display:flex><span>kubectl logs -f my-pod -c my-container              <span style=color:#080;font-style:italic># вывести логи контейнера пода в режиме реального времени (в stdout, при работе с несколькими контейнерами)</span>
</span></span><span style=display:flex><span>kubectl logs -f -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel --all-containers    <span style=color:#080;font-style:italic># вывести логи всех подов с меткой myLabel (в stdout)</span>
</span></span><span style=display:flex><span>kubectl run -i --tty busybox --image<span style=color:#666>=</span>busybox -- sh  <span style=color:#080;font-style:italic># запустить под как интерактивную оболочку</span>
</span></span><span style=display:flex><span>kubectl run nginx --image<span style=color:#666>=</span>nginx --restart<span style=color:#666>=</span>Never -n
</span></span><span style=display:flex><span>mynamespace                                         <span style=color:#080;font-style:italic># Запустить под nginx в заданном пространстве имён</span>
</span></span><span style=display:flex><span>kubectl run nginx --image<span style=color:#666>=</span>nginx --restart<span style=color:#666>=</span>Never     <span style=color:#080;font-style:italic># Запустить под nginx и записать его спецификацию в файл pod.yaml</span>
</span></span><span style=display:flex><span>--dry-run -o yaml &gt; pod.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl attach my-pod -i                            <span style=color:#080;font-style:italic># Прикрепить к запущенному контейнеру</span>
</span></span><span style=display:flex><span>kubectl port-forward my-pod 5000:6000               <span style=color:#080;font-style:italic># Переадресовать порт 5000 в локальной машине на порт 6000 в поде my-pod</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> my-pod -- ls /                         <span style=color:#080;font-style:italic># Выполнить команду в существующем поде (в случае одного контейнера).</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> my-pod -c my-container -- ls /         <span style=color:#080;font-style:italic># Выполнить команду в существующем поде (в случае нескольких контейнеров)</span>
</span></span><span style=display:flex><span>kubectl top pod POD_NAME --containers               <span style=color:#080;font-style:italic># Показать метрики по заданному поду вместе с его контейнерами</span>
</span></span></code></pre></div><h2 id=работа-с-узлами-и-кластером>Работа с узлами и кластером</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl cordon my-node                                                <span style=color:#080;font-style:italic># Отметить узел my-node как неназначаемый</span>
</span></span><span style=display:flex><span>kubectl drain my-node                                                 <span style=color:#080;font-style:italic># Вытеснить узел my-node, чтобы подготовиться к эксплуатации</span>
</span></span><span style=display:flex><span>kubectl uncordon my-node                                              <span style=color:#080;font-style:italic># Отметить узел my-node как назначаемый</span>
</span></span><span style=display:flex><span>kubectl top node my-node                                              <span style=color:#080;font-style:italic># Показать метрики по заданному узлу</span>
</span></span><span style=display:flex><span>kubectl cluster-info                                                  <span style=color:#080;font-style:italic># Показать адреса главного узла и сервисов</span>
</span></span><span style=display:flex><span>kubectl cluster-info dump                                             <span style=color:#080;font-style:italic># Вывести состояние текущего кластера в stdout</span>
</span></span><span style=display:flex><span>kubectl cluster-info dump --output-directory<span style=color:#666>=</span>/path/to/cluster-state   <span style=color:#080;font-style:italic># Вывести состояние текущего кластера в /path/to/cluster-state</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Если ограничение с заданным ключом и проявлением уже существует, его значение будет заменено указанным</span>
</span></span><span style=display:flex><span>kubectl taint nodes foo <span style=color:#b8860b>dedicated</span><span style=color:#666>=</span>special-user:NoSchedule
</span></span></code></pre></div><h3 id=типы-ресурсов>Типы ресурсов</h3><p>Вывести все поддерживаемые типы ресурсов, включая <a href=/docs/concepts/overview/kubernetes-api/#api-groups>API-группу</a>, флаг <a href=/docs/concepts/overview/working-with-objects/namespaces>namespaced</a> (организован ли ресурс в пространство имён или нет) и <a href=/docs/concepts/overview/working-with-objects/kubernetes-objects>Kind</a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl api-resources
</span></span></code></pre></div><p>Другие варианты команды для анализа API-ресурсов:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl api-resources --namespaced<span style=color:#666>=</span><span style=color:#a2f>true</span>      <span style=color:#080;font-style:italic># Все ресурсы с пространством имён</span>
</span></span><span style=display:flex><span>kubectl api-resources --namespaced<span style=color:#666>=</span><span style=color:#a2f>false</span>     <span style=color:#080;font-style:italic># Все ресурсы без пространства имён</span>
</span></span><span style=display:flex><span>kubectl api-resources -o name                <span style=color:#080;font-style:italic># Все ресурсы с простым выводом  (только имя ресурса)</span>
</span></span><span style=display:flex><span>kubectl api-resources -o wide                <span style=color:#080;font-style:italic># Все ресурсы с расширенным (с неограниченной длинной) выводом</span>
</span></span><span style=display:flex><span>kubectl api-resources --verbs<span style=color:#666>=</span>list,get       <span style=color:#080;font-style:italic># Все ресурсы, которые поддерживают глаголы запроса &#34;list&#34; и &#34;get&#34;</span>
</span></span><span style=display:flex><span>kubectl api-resources --api-group<span style=color:#666>=</span>extensions <span style=color:#080;font-style:italic># Все ресурсы в API-группе &#34;extensions&#34;</span>
</span></span></code></pre></div><h3 id=форматирование-вывода>Форматирование вывода</h3><p>Для вывода подробной информации в окно терминала в определенном формате, добавьте флаг <code>-o</code> (или <code>--output</code>) в команду <code>kubectl</code>, которая поддерживает форматирование.</p><table><thead><tr><th>Формат вывода</th><th>Описание</th></tr></thead><tbody><tr><td><code>-o=custom-columns=&lt;spec></code></td><td>Вывод таблицы из списка пользовательских столбцов через запятую</td></tr><tr><td><code>-o=custom-columns-file=&lt;filename></code></td><td>Вывод таблицы из списка пользовательских столбцов, определённых в файле <code>&lt;filename></code></td></tr><tr><td><code>-o=json</code></td><td>Вывод API-объекта в формате JSON</td></tr><tr><td><code>-o=jsonpath=&lt;template></code></td><td>Вывод полей, определённых в выражении <a href=/docs/reference/kubectl/jsonpath>jsonpath</a></td></tr><tr><td><code>-o=jsonpath-file=&lt;filename></code></td><td>Вывод полей, определённых в выражении <a href=/docs/reference/kubectl/jsonpath>jsonpath</a> из файла <code>&lt;filename></code></td></tr><tr><td><code>-o=name</code></td><td>Вывод только имена ресурсов</td></tr><tr><td><code>-o=wide</code></td><td>Вывод дополнительную информации в обычном текстовом формате, в случае подов отображается имя узла</td></tr><tr><td><code>-o=yaml</code></td><td>Вывод API-объекта в формате YAML</td></tr></tbody></table><h3 id=уровни-детальности-вывода-и-отладки-в-kubectl>Уровни детальности вывода и отладки в Kubectl</h3><p>Уровни детальности вывода Kubectl регулируются с помощью флагов <code>-v</code> или <code>--v</code>, за которыми следует целое число, представляющее уровни логирования. Общие соглашения по логированию Kubernetes и связанные с ними уровни описаны <a href=https://github.com/kubernetes/community/blob/master/contributors/devel/sig-instrumentation/logging.md>здесь</a>.</p><table><thead><tr><th>Уровень детальности</th><th>Описание</th></tr></thead><tbody><tr><td><code>--v=0</code></td><td>Как правило, используется чтобы <em>всегда</em> видеть, что происходит</td></tr><tr><td><code>--v=1</code></td><td>Достаточный уровень логирования по умолчанию, если вам не нужна большая детальность.</td></tr><tr><td><code>--v=2</code></td><td>Полезная информация про стабильное состояние сервиса и важные сообщения логов, которые могут связаны со значительными изменениями в системе. Это рекомендуемый уровень логирования по умолчанию для большинства систем.</td></tr><tr><td><code>--v=3</code></td><td>Расширенная информация об изменениях.</td></tr><tr><td><code>--v=4</code></td><td>Уровень детальности для отладки.</td></tr><tr><td><code>--v=6</code></td><td>Показать запрашиваемые ресурсы.</td></tr><tr><td><code>--v=7</code></td><td>Показать заголовки HTTP-запросов.</td></tr><tr><td><code>--v=8</code></td><td>Показать содержимое HTTP-запросов.</td></tr><tr><td><code>--v=9</code></td><td>Показать содержимого HTTP-запроса в полном виде.</td></tr></tbody></table><h2 id=что-дальше>Что дальше</h2><ul><li><p>Подробнее о kubectl на странице <a href=/ru/docs/reference/kubectl/overview/>обзора</a>.</p></li><li><p>Посмотреть опции <a href=/ru/docs/reference/kubectl/kubectl/>kubectl</a>.</p></li><li><p>Ознакомиться с <a href=/docs/reference/kubectl/conventions/>соглашениями по использованию kubectl</a>, чтобы понять, как использовать его в повторно используемых скриптах.</p></li><li><p>Посмотреть <a href=https://github.com/dennyzhang/cheatsheet-kubernetes-A4>шпаргалки по kubectl</a> сообщества.</p></li></ul></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/ru/docs/home/>Главная</a>
<a class=text-white href=/ru/community/>Сообщество</a>
<a class=text-white href=/ru/case-studies/>Примеры использования</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 Авторы Kubernetes | Документация распространяется под лицензией <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. Все права защищены. The Linux Foundation является зарегистрированной торговой маркой. Список торговых марок The Linux Foundation приведен на странице <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>использования торговых марок</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>