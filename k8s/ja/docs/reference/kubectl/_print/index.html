<!doctype html><html lang=ja class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/reference/kubectl/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/docs/reference/kubectl/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/reference/kubectl/><link rel=alternate hreflang=fr href=https://kubernetes.io/fr/docs/reference/kubectl/><link rel=alternate hreflang=de href=https://kubernetes.io/de/docs/reference/kubectl/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/reference/kubectl/><link rel=alternate hreflang=pt-br href=https://kubernetes.io/pt-br/docs/reference/kubectl/><link rel=alternate hreflang=id href=https://kubernetes.io/id/docs/reference/kubectl/><link rel=alternate hreflang=ru href=https://kubernetes.io/ru/docs/reference/kubectl/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/ja/docs/reference/kubectl/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>kubectl CLI | Kubernetes</title><meta property="og:title" content="kubectl CLI"><meta property="og:description" content="プロダクショングレードのコンテナ管理基盤"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/ja/docs/reference/kubectl/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="kubectl CLI"><meta itemprop=description content="プロダクショングレードのコンテナ管理基盤"><meta name=twitter:card content="summary"><meta name=twitter:title content="kubectl CLI"><meta name=twitter:description content="プロダクショングレードのコンテナ管理基盤"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content><meta property="og:description" content><meta name=twitter:description content><meta property="og:url" content="https://kubernetes.io/ja/docs/reference/kubectl/"><meta property="og:title" content="kubectl CLI"><meta name=twitter:title content="kubectl CLI"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/ja/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/ja/docs/>ドキュメント</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ja/blog/>Blogs</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ja/training/>トレーニング</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ja/partners/>パートナー</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ja/community/>コミュニティ</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ja/case-studies/>ケーススタディ</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>バージョン</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/ja/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/ja/docs/reference/kubectl/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/ja/docs/reference/kubectl/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/ja/docs/reference/kubectl/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/ja/docs/reference/kubectl/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/ja/docs/reference/kubectl/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>日本語 (Japanese)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/reference/kubectl/>English</a>
<a class=dropdown-item href=/zh-cn/docs/reference/kubectl/>中文 (Chinese)</a>
<a class=dropdown-item href=/ko/docs/reference/kubectl/>한국어 (Korean)</a>
<a class=dropdown-item href=/fr/docs/reference/kubectl/>Français (French)</a>
<a class=dropdown-item href=/de/docs/reference/kubectl/>Deutsch (German)</a>
<a class=dropdown-item href=/es/docs/reference/kubectl/>Español (Spanish)</a>
<a class=dropdown-item href=/pt-br/docs/reference/kubectl/>Português (Portuguese)</a>
<a class=dropdown-item href=/id/docs/reference/kubectl/>Bahasa Indonesia</a>
<a class=dropdown-item href=/ru/docs/reference/kubectl/>Русский (Russian)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>これは、このセクションの複数ページの印刷可能なビューです。
<a href=# onclick="return print(),!1">印刷するには、ここをクリックしてください</a>.</p><p><a href=/ja/docs/reference/kubectl/>このページの通常のビューに戻る</a>.</p></div><h1 class=title>kubectl CLI</h1><ul><li>1: <a href=#pg-f14fe15ecc2d41b5e901ef5e872ca657>kubectlの概要</a></li><li>2: <a href=#pg-a938176c695852fe70362c29cf615f1c>JSONPathのサポート</a></li><li>3: <a href=#pg-8aba901ac13f124e5782b90ddb166ee2>kubectlチートシート</a></li><li>4: <a href=#pg-8de6aceb8bf692c06cced446bac5bc92>kubectlの使用規則</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-f14fe15ecc2d41b5e901ef5e872ca657>1 - kubectlの概要</h1><p><code>kubectl</code>コマンドラインツールを使うと、Kubernetesクラスターを制御できます。環境設定のために、<code>kubectl</code>は、<code>$HOME/.kube</code>ディレクトリにある<code>config</code>という名前のファイルを探します。他の<a href=/ja/docs/concepts/configuration/organize-cluster-access-kubeconfig/>kubeconfig</a>ファイルは、<code>KUBECONFIG</code>環境変数を設定するか、<a href=/docs/concepts/configuration/organize-cluster-access-kubeconfig/><code>--kubeconfig</code></a>フラグを設定することで指定できます。
この概要では、<code>kubectl</code>の構文を扱い、コマンド操作を説明し、一般的な例を示します。サポートされているすべてのフラグやサブコマンドを含め、各コマンドの詳細については、<a href=/docs/reference/generated/kubectl/kubectl-commands/>kubectl</a>リファレンスドキュメントを参照してください。インストール方法については、<a href=/ja/docs/tasks/tools/install-kubectl/>kubectlのインストールおよびセットアップ</a>をご覧ください。</p><h2 id=構文>構文</h2><p>ターミナルウィンドウから<code>kubectl</code>コマンドを実行するには、以下の構文を使用します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>command<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NAME<span style=color:#666>]</span> <span style=color:#666>[</span>flags<span style=color:#666>]</span>
</span></span></code></pre></div><p>ここで、<code>command</code>、<code>TYPE</code>、<code>NAME</code>、<code>flags</code>は、以下を表します。</p><ul><li><p><code>command</code>: 1つ以上のリソースに対して実行したい操作を指定します。例えば、<code>create</code>、<code>get</code>、<code>describe</code>、<code>delete</code>です。</p></li><li><p><code>TYPE</code>: <a href=#resource-types>リソースタイプ</a>を指定します。リソースタイプは大文字と小文字を区別せず、単数形や複数形、省略形を指定できます。例えば、以下のコマンドは同じ出力を生成します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pod pod1
</span></span><span style=display:flex><span>kubectl get pods pod1
</span></span><span style=display:flex><span>kubectl get po pod1
</span></span></code></pre></div></li><li><p><code>NAME</code>: リソースの名前を指定します。名前は大文字と小文字を区別します。<code>kubectl get pods</code>のように名前が省略された場合は、すべてのリソースの詳細が表示されます。</p><p>複数のリソースに対して操作を行う場合は、各リソースをタイプと名前で指定するか、1つまたは複数のファイルを指定することができます。</p><ul><li><p>リソースをタイプと名前で指定する場合</p><ul><li><p>タイプがすべて同じとき、リソースをグループ化するには<code>TYPE1 name1 name2 name&lt;#></code>とします。<br>例: <code>kubectl get pod example-pod1 example-pod2</code></p></li><li><p>複数のリソースタイプを個別に指定するには、<code>TYPE1/name1 TYPE1/name2 TYPE2/name3 TYPE&lt;#>/name&lt;#></code>とします。<br>例: <code>kubectl get pod/example-pod1 replicationcontroller/example-rc1</code></p></li></ul></li><li><p>リソースを1つ以上のファイルで指定する場合は、<code>-f file1 -f file2 -f file&lt;#></code>とします。</p><ul><li>特に設定ファイルについては、YAMLの方がより使いやすいため、<a href=/ja/docs/concepts/configuration/overview/#%E4%B8%80%E8%88%AC%E7%9A%84%E3%81%AA%E8%A8%AD%E5%AE%9A%E3%81%AEtips>JSONではなくYAMLを使用してください</a>。<br>例: <code>kubectl get pod -f ./pod.yaml</code></li></ul></li></ul></li><li><p><code>flags</code>: オプションのフラグを指定します。例えば、<code>-s</code>または<code>--server</code>フラグを使って、Kubernetes APIサーバーのアドレスやポートを指定できます。<br></p></li></ul><div class="alert alert-warning caution callout" role=alert><strong>注意:</strong> コマンドラインから指定したフラグは、デフォルト値および対応する任意の環境変数を上書きします。</div><p>ヘルプが必要な場合は、ターミナルウィンドウから<code>kubectl help</code>を実行してください。</p><h2 id=操作>操作</h2><p>以下の表に、<code>kubectl</code>のすべての操作の簡単な説明と一般的な構文を示します。</p><table><thead><tr><th>操作                </th><th>構文</th><th>説明</th></tr></thead><tbody><tr><td><code>alpha</code></td><td><code>kubectl alpha SUBCOMMAND [flags]</code></td><td>アルファ機能に該当する利用可能なコマンドを一覧表示します。これらの機能は、デフォルトではKubernetesクラスターで有効になっていません。</td></tr><tr><td><code>annotate</code></td><td><code>kubectl annotate (-f FILENAME | TYPE NAME | TYPE/NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]</code></td><td>1つ以上のリソースのアノテーションを、追加または更新します。</td></tr><tr><td><code>api-resources</code></td><td><code>kubectl api-resources [flags]</code></td><td>利用可能なAPIリソースを一覧表示します。</td></tr><tr><td><code>api-versions</code></td><td><code>kubectl api-versions [flags]</code></td><td>利用可能なAPIバージョンを一覧表示します。</td></tr><tr><td><code>apply</code></td><td><code>kubectl apply -f FILENAME [flags]</code></td><td>ファイルまたは標準出力から、リソースの設定変更を適用します。</td></tr><tr><td><code>attach</code></td><td><code>kubectl attach POD -c CONTAINER [-i] [-t] [flags]</code></td><td>実行中のコンテナにアタッチして、出力ストリームを表示するか、コンテナ(標準入力)と対話します。</td></tr><tr><td><code>auth</code></td><td><code>kubectl auth [flags] [options]</code></td><td>認可を検査します。</td></tr><tr><td><code>autoscale</code></td><td><code>kubectl autoscale (-f FILENAME | TYPE NAME | TYPE/NAME) [--min=MINPODS] --max=MAXPODS [--cpu-percent=CPU] [flags]</code></td><td>ReplicationControllerで管理されているPodのセットを、自動的にスケールします。</td></tr><tr><td><code>certificate</code></td><td><code>kubectl certificate SUBCOMMAND [options]</code></td><td>証明書のリソースを変更します。</td></tr><tr><td><code>cluster-info</code></td><td><code>kubectl cluster-info [flags]</code></td><td>クラスター内のマスターとサービスに関するエンドポイント情報を表示します。</td></tr><tr><td><code>completion</code></td><td><code>kubectl completion SHELL [options]</code></td><td>指定されたシェル(bashまたはzsh)のシェル補完コードを出力します。</td></tr><tr><td><code>config</code></td><td><code>kubectl config SUBCOMMAND [flags]</code></td><td>kubeconfigファイルを変更します。詳細は、個々のサブコマンドを参照してください。</td></tr><tr><td><code>convert</code></td><td><code>kubectl convert -f FILENAME [options]</code></td><td>異なるAPIバージョン間で設定ファイルを変換します。YAMLとJSONに対応しています。</td></tr><tr><td><code>cordon</code></td><td><code>kubectl cordon NODE [options]</code></td><td>Nodeをスケジュール不可に設定します。</td></tr><tr><td><code>cp</code></td><td><code>kubectl cp &lt;file-spec-src> &lt;file-spec-dest> [options]</code></td><td>コンテナとの間でファイルやディレクトリをコピーします。</td></tr><tr><td><code>create</code></td><td><code>kubectl create -f FILENAME [flags]</code></td><td>ファイルまたは標準出力から、1つ以上のリソースを作成します。</td></tr><tr><td><code>delete</code></td><td><code>kubectl delete (-f FILENAME | TYPE [NAME | /NAME | -l label | --all]) [flags]</code></td><td>ファイル、標準出力、またはラベルセレクター、リソースセレクター、リソースを指定して、リソースを削除します。</td></tr><tr><td><code>describe</code></td><td><code>kubectl describe (-f FILENAME | TYPE [NAME_PREFIX | /NAME | -l label]) [flags]</code></td><td>1つ以上のリソースの詳細な状態を表示します。</td></tr><tr><td><code>diff</code></td><td><code>kubectl diff -f FILENAME [flags]</code></td><td>ファイルまたは標準出力と、現在の設定との差分を表示します。</td></tr><tr><td><code>drain</code></td><td><code>kubectl drain NODE [options]</code></td><td>メンテナンスの準備のためにNodeをdrainします。</td></tr><tr><td><code>edit</code></td><td><code>kubectl edit (-f FILENAME | TYPE NAME | TYPE/NAME) [flags]</code></td><td>デファルトのエディタを使い、サーバー上の1つ以上のリソースリソースの定義を編集し、更新します。</td></tr><tr><td><code>exec</code></td><td><code>kubectl exec POD [-c CONTAINER] [-i] [-t] [flags] [-- COMMAND [args...]]</code></td><td>Pod内のコンテナに対して、コマンドを実行します。</td></tr><tr><td><code>explain</code></td><td><code>kubectl explain [--recursive=false] [flags]</code></td><td>様々なリソースのドキュメントを取得します。例えば、Pod、Node、Serviceなどです。</td></tr><tr><td><code>expose</code></td><td><code>kubectl expose (-f FILENAME | TYPE NAME | TYPE/NAME) [--port=port] [--protocol=TCP|UDP] [--target-port=number-or-name] [--name=name] [--external-ip=external-ip-of-service] [--type=type] [flags]</code></td><td>ReplicationController、Service、Podを、新しいKubernetesサービスとして公開します。</td></tr><tr><td><code>get</code></td><td><code>kubectl get (-f FILENAME | TYPE [NAME | /NAME | -l label]) [--watch] [--sort-by=FIELD] [[-o | --output]=OUTPUT_FORMAT] [flags]</code></td><td>1つ以上のリソースを表示します。</td></tr><tr><td><code>kustomize</code></td><td><code>kubectl kustomize &lt;dir> [flags] [options]</code></td><td>kustomization.yamlファイル内の指示から生成されたAPIリソースのセットを一覧表示します。引数はファイルを含むディレクトリのPath，またはリポジトリルートに対して同じ場所を示すパスサフィックス付きのgitリポジトリのURLを指定しなければなりません。</td></tr><tr><td><code>label</code></td><td><code>kubectl label (-f FILENAME | TYPE NAME | TYPE/NAME) KEY_1=VAL_1 ... KEY_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]</code></td><td>1つ以上のリソースのラベルを、追加または更新します。</td></tr><tr><td><code>logs</code></td><td><code>kubectl logs POD [-c CONTAINER] [--follow] [flags]</code></td><td>Pod内のコンテナのログを表示します。</td></tr><tr><td><code>options</code></td><td><code>kubectl options</code></td><td>すべてのコマンドに適用されるグローバルコマンドラインオプションを一覧表示します。</td></tr><tr><td><code>patch</code></td><td><code>kubectl patch (-f FILENAME | TYPE NAME | TYPE/NAME) --patch PATCH [flags]</code></td><td>Strategic Merge Patchの処理を使用して、リソースの1つ以上のフィールドを更新します。</td></tr><tr><td><code>plugin</code></td><td><code>kubectl plugin [flags] [options]</code></td><td>プラグインと対話するためのユーティリティを提供します。</td></tr><tr><td><code>port-forward</code></td><td><code>kubectl port-forward POD [LOCAL_PORT:]REMOTE_PORT [...[LOCAL_PORT_N:]REMOTE_PORT_N] [flags]</code></td><td>1つ以上のローカルポートを、Podに転送します。</td></tr><tr><td><code>proxy</code></td><td><code>kubectl proxy [--port=PORT] [--www=static-dir] [--www-prefix=prefix] [--api-prefix=prefix] [flags]</code></td><td>Kubernetes APIサーバーへのプロキシーを実行します。</td></tr><tr><td><code>replace</code></td><td><code>kubectl replace -f FILENAME</code></td><td>ファイルや標準出力から、リソースを置き換えます。</td></tr><tr><td><code>rollout</code></td><td><code>kubectl rollout SUBCOMMAND [options]</code></td><td>リソースのロールアウトを管理します。有効なリソースには、Deployment、DaemonSetとStatefulSetが含まれます。</td></tr><tr><td><code>run</code></td><td><code>kubectl run NAME --image=image [--env="key=value"] [--port=port] [--dry-run=server|client|none] [--overrides=inline-json] [flags]</code></td><td>指定したイメージを、クラスタ上で実行します。</td></tr><tr><td><code>scale</code></td><td><code>kubectl scale (-f FILENAME | TYPE NAME | TYPE/NAME) --replicas=COUNT [--resource-version=version] [--current-replicas=count] [flags]</code></td><td>指定したReplicationControllerのサイズを更新します。</td></tr><tr><td><code>set</code></td><td><code>kubectl set SUBCOMMAND [options]</code></td><td>アプリケーションリソースを設定します。</td></tr><tr><td><code>taint</code></td><td><code>kubectl taint NODE NAME KEY_1=VAL_1:TAINT_EFFECT_1 ... KEY_N=VAL_N:TAINT_EFFECT_N [options]</code></td><td>1つ以上のNodeのtaintを更新します。</td></tr><tr><td><code>top</code></td><td><code>kubectl top [flags] [options]</code></td><td>リソース(CPU/メモリー/ストレージ)の使用量を表示します。</td></tr><tr><td><code>uncordon</code></td><td><code>kubectl uncordon NODE [options]</code></td><td>Nodeをスケジュール可に設定します。</td></tr><tr><td><code>version</code></td><td><code>kubectl version [--client] [flags]</code></td><td>クライアントとサーバーで実行中のKubernetesのバージョンを表示します。</td></tr><tr><td><code>wait</code></td><td><code>kubectl wait ([-f FILENAME] | resource.group/resource.name | resource.group [(-l label | --all)]) [--for=delete|--for condition=available] [options]</code></td><td>実験中の機能: 1つ以上のリソースが特定の状態になるまで待ちます。</td></tr></tbody></table><p>コマンド操作について詳しく知りたい場合は、<a href=/docs/reference/kubectl/kubectl/>kubectl</a>リファレンスドキュメントを参照してください。</p><h2 id=resource-types>リソースタイプ</h2><p>以下の表に、サポートされているすべてのリソースと、省略されたエイリアスの一覧を示します。</p><p>(この出力は<code>kubectl api-resources</code>から取得でき、Kubernetes 1.13.3時点で正確でした。)</p><table><thead><tr><th>リソース名</th><th>短縮名</th><th>APIグループ</th><th>名前空間に属するか</th><th>リソースの種類</th></tr></thead><tbody><tr><td><code>bindings</code></td><td></td><td></td><td>true</td><td>Binding</td></tr><tr><td><code>componentstatuses</code></td><td><code>cs</code></td><td></td><td>false</td><td>ComponentStatus</td></tr><tr><td><code>configmaps</code></td><td><code>cm</code></td><td></td><td>true</td><td>ConfigMap</td></tr><tr><td><code>endpoints</code></td><td><code>ep</code></td><td></td><td>true</td><td>Endpoints</td></tr><tr><td><code>limitranges</code></td><td><code>limits</code></td><td></td><td>true</td><td>LimitRange</td></tr><tr><td><code>namespaces</code></td><td><code>ns</code></td><td></td><td>false</td><td>Namespace</td></tr><tr><td><code>nodes</code></td><td><code>no</code></td><td></td><td>false</td><td>Node</td></tr><tr><td><code>persistentvolumeclaims</code></td><td><code>pvc</code></td><td></td><td>true</td><td>PersistentVolumeClaim</td></tr><tr><td><code>persistentvolumes</code></td><td><code>pv</code></td><td></td><td>false</td><td>PersistentVolume</td></tr><tr><td><code>pods</code></td><td><code>po</code></td><td></td><td>true</td><td>Pod</td></tr><tr><td><code>podtemplates</code></td><td></td><td></td><td>true</td><td>PodTemplate</td></tr><tr><td><code>replicationcontrollers</code></td><td><code>rc</code></td><td></td><td>true</td><td>ReplicationController</td></tr><tr><td><code>resourcequotas</code></td><td><code>quota</code></td><td></td><td>true</td><td>ResourceQuota</td></tr><tr><td><code>secrets</code></td><td></td><td></td><td>true</td><td>Secret</td></tr><tr><td><code>serviceaccounts</code></td><td><code>sa</code></td><td></td><td>true</td><td>ServiceAccount</td></tr><tr><td><code>services</code></td><td><code>svc</code></td><td></td><td>true</td><td>Service</td></tr><tr><td><code>mutatingwebhookconfigurations</code></td><td></td><td>admissionregistration.k8s.io</td><td>false</td><td>MutatingWebhookConfiguration</td></tr><tr><td><code>validatingwebhookconfigurations</code></td><td></td><td>admissionregistration.k8s.io</td><td>false</td><td>ValidatingWebhookConfiguration</td></tr><tr><td><code>customresourcedefinitions</code></td><td><code>crd</code>, <code>crds</code></td><td>apiextensions.k8s.io</td><td>false</td><td>CustomResourceDefinition</td></tr><tr><td><code>apiservices</code></td><td></td><td>apiregistration.k8s.io</td><td>false</td><td>APIService</td></tr><tr><td><code>controllerrevisions</code></td><td></td><td>apps</td><td>true</td><td>ControllerRevision</td></tr><tr><td><code>daemonsets</code></td><td><code>ds</code></td><td>apps</td><td>true</td><td>DaemonSet</td></tr><tr><td><code>deployments</code></td><td><code>deploy</code></td><td>apps</td><td>true</td><td>Deployment</td></tr><tr><td><code>replicasets</code></td><td><code>rs</code></td><td>apps</td><td>true</td><td>ReplicaSet</td></tr><tr><td><code>statefulsets</code></td><td><code>sts</code></td><td>apps</td><td>true</td><td>StatefulSet</td></tr><tr><td><code>tokenreviews</code></td><td></td><td>authentication.k8s.io</td><td>false</td><td>TokenReview</td></tr><tr><td><code>localsubjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>true</td><td>LocalSubjectAccessReview</td></tr><tr><td><code>selfsubjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SelfSubjectAccessReview</td></tr><tr><td><code>selfsubjectrulesreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SelfSubjectRulesReview</td></tr><tr><td><code>subjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SubjectAccessReview</td></tr><tr><td><code>horizontalpodautoscalers</code></td><td><code>hpa</code></td><td>autoscaling</td><td>true</td><td>HorizontalPodAutoscaler</td></tr><tr><td><code>cronjobs</code></td><td><code>cj</code></td><td>batch</td><td>true</td><td>CronJob</td></tr><tr><td><code>jobs</code></td><td></td><td>batch</td><td>true</td><td>Job</td></tr><tr><td><code>certificatesigningrequests</code></td><td><code>csr</code></td><td>certificates.k8s.io</td><td>false</td><td>CertificateSigningRequest</td></tr><tr><td><code>leases</code></td><td></td><td>coordination.k8s.io</td><td>true</td><td>Lease</td></tr><tr><td><code>events</code></td><td><code>ev</code></td><td>events.k8s.io</td><td>true</td><td>Event</td></tr><tr><td><code>ingresses</code></td><td><code>ing</code></td><td>extensions</td><td>true</td><td>Ingress</td></tr><tr><td><code>networkpolicies</code></td><td><code>netpol</code></td><td>networking.k8s.io</td><td>true</td><td>NetworkPolicy</td></tr><tr><td><code>poddisruptionbudgets</code></td><td><code>pdb</code></td><td>policy</td><td>true</td><td>PodDisruptionBudget</td></tr><tr><td><code>podsecuritypolicies</code></td><td><code>psp</code></td><td>policy</td><td>false</td><td>PodSecurityPolicy</td></tr><tr><td><code>clusterrolebindings</code></td><td></td><td>rbac.authorization.k8s.io</td><td>false</td><td>ClusterRoleBinding</td></tr><tr><td><code>clusterroles</code></td><td></td><td>rbac.authorization.k8s.io</td><td>false</td><td>ClusterRole</td></tr><tr><td><code>rolebindings</code></td><td></td><td>rbac.authorization.k8s.io</td><td>true</td><td>RoleBinding</td></tr><tr><td><code>roles</code></td><td></td><td>rbac.authorization.k8s.io</td><td>true</td><td>Role</td></tr><tr><td><code>priorityclasses</code></td><td><code>pc</code></td><td>scheduling.k8s.io</td><td>false</td><td>PriorityClass</td></tr><tr><td><code>csidrivers</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>CSIDriver</td></tr><tr><td><code>csinodes</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>CSINode</td></tr><tr><td><code>storageclasses</code></td><td><code>sc</code></td><td>storage.k8s.io</td><td>false</td><td>StorageClass</td></tr><tr><td><code>volumeattachments</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>VolumeAttachment</td></tr></tbody></table><h2 id=出力オプション>出力オプション</h2><p>ある特定のコマンドの出力に対してフォーマットやソートを行う方法については、以下の節を参照してください。どのコマンドが様々な出力オプションをサポートしているかについては、<a href=/docs/reference/kubectl/kubectl/>kubectl</a>リファレンスドキュメントをご覧ください。</p><h3 id=出力のフォーマット>出力のフォーマット</h3><p>すべての<code>kubectl</code>コマンドのデフォルトの出力フォーマットは、人間が読みやすいプレーンテキスト形式です。特定のフォーマットで、詳細をターミナルウィンドウに出力するには、サポートされている<code>kubectl</code>コマンドに<code>-o</code>または<code>--output</code>フラグのいずれかを追加します。</p><h4 id=構文-1>構文</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>command<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NAME<span style=color:#666>]</span> -o &lt;output_format&gt;
</span></span></code></pre></div><p><code>kubectl</code>の操作に応じて、以下の出力フォーマットがサポートされています。</p><table><thead><tr><th>出力フォーマット</th><th>説明</th></tr></thead><tbody><tr><td><code>-o custom-columns=&lt;spec></code></td><td><a href=#custom-columns>カスタムカラム</a>のコンマ区切りのリストを使用して、テーブルを表示します。</td></tr><tr><td><code>-o custom-columns-file=&lt;filename></code></td><td><code>&lt;filename></code>ファイル内の<a href=#custom-columns>カスタムカラム</a>のテンプレートを使用して、テーブルを表示します。</td></tr><tr><td><code>-o json</code></td><td>JSON形式のAPIオブジェクトを出力します。</td></tr><tr><td><code>-o jsonpath=&lt;template></code></td><td><a href=/ja/docs/reference/kubectl/jsonpath/>jsonpath</a>式で定義されたフィールドを表示します。</td></tr><tr><td><code>-o jsonpath-file=&lt;filename></code></td><td><code>&lt;filename></code>ファイル内の<a href=/ja/docs/reference/kubectl/jsonpath/>jsonpath</a>式で定義されたフィールドを表示します。</td></tr><tr><td><code>-o name</code></td><td>リソース名のみを表示します。</td></tr><tr><td><code>-o wide</code></td><td>追加情報を含めて、プレーンテキスト形式で出力します。Podの場合は、Node名が含まれます。</td></tr><tr><td><code>-o yaml</code></td><td>YAML形式のAPIオブジェクトを出力します。</td></tr></tbody></table><h5 id=例>例</h5><p>この例において、以下のコマンドは1つのPodの詳細を、YAML形式のオブジェクトとして出力します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pod web-pod-13je7 -o yaml
</span></span></code></pre></div><p>各コマンドでサポートされている出力フォーマットの詳細については、<a href=/docs/reference/kubectl/kubectl/>kubectl</a>リファレンスドキュメントを参照してください。</p><h4 id=custom-columns>カスタムカラム</h4><p>カスタムカラムを定義して、必要な詳細のみをテーブルに出力するには、<code>custom-columns</code>オプションを使います。カスタムカラムをインラインで定義するか、<code>-o custom-columns=&lt;spec></code>または<code>-o custom-columns-file=&lt;filename></code>のようにテンプレートファイルを使用するかを選択できます。</p><h5 id=例-1>例</h5><p>インラインで定義する例は、以下の通りです。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;pod-name&gt; -o custom-columns<span style=color:#666>=</span>NAME:.metadata.name,RSRC:.metadata.resourceVersion
</span></span></code></pre></div><p>テンプレートファイルを使用して定義する例は、以下の通りです。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;pod-name&gt; -o custom-columns-file<span style=color:#666>=</span>template.txt
</span></span></code></pre></div><p>ここで、<code>template.txt</code>には以下の内容が含まれます。</p><pre tabindex=0><code>NAME          RSRC
metadata.name metadata.resourceVersion
</code></pre><p>どちらのコマンドを実行した場合でも、以下の結果を得ます。</p><pre tabindex=0><code>NAME           RSRC
submit-queue   610995
</code></pre><h4 id=サーバーサイドカラム>サーバーサイドカラム</h4><p><code>kubectl</code>は、サーバーからオブジェクトに関する特定のカラム情報を受け取ることをサポートしています。
つまり、与えられた任意のリソースについて、サーバーはそのリソースに関連する列や行を返し、クライアントが表示できるようにします。
これにより、サーバーが表示の詳細をカプセル化することで、同一クラスターに対して使用されているクライアント間で、一貫した人間が読みやすい出力が可能です。</p><p>この機能は、デフォルトで有効になっています。無効にするには、<code>kubectl get</code>コマンドに<code>--server-print=false</code>フラグを追加します。</p><h5 id=例-2>例</h5><p>Podの状態に関する情報を表示するには、以下のようなコマンドを使用します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;pod-name&gt; --server-print<span style=color:#666>=</span><span style=color:#a2f>false</span>
</span></span></code></pre></div><p>以下のように出力されます。</p><pre tabindex=0><code>NAME       AGE
pod-name   1m
</code></pre><h3 id=オブジェクトリストのソート>オブジェクトリストのソート</h3><p>ターミナルウィンドウで、オブジェクトをソートされたリストに出力するには、サポートされている<code>kubectl</code>コマンドに<code>--sort-by</code>フラグを追加します。<code>--sort-by</code>フラグで任意の数値フィールドや文字列フィールドを指定することで、オブジェクトをソートします。フィールドの指定には、<a href=/ja/docs/reference/kubectl/jsonpath/>jsonpath</a>式を使用します。</p><h4 id=構文-2>構文</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>command<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NAME<span style=color:#666>]</span> --sort-by<span style=color:#666>=</span>&lt;jsonpath_exp&gt;
</span></span></code></pre></div><h5 id=例-3>例</h5><p>名前でソートしたPodのリストを表示するには、以下のように実行します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --sort-by<span style=color:#666>=</span>.metadata.name
</span></span></code></pre></div><h2 id=例-一般的な操作>例: 一般的な操作</h2><p>よく使われる<code>kubectl</code>の操作に慣れるために、以下の例を使用してください。</p><p><code>kubectl apply</code> - ファイルや標準出力から、リソースの適用や更新を行います。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># example-service.yaml内の定義を使用して、Serviceを作成します。</span>
</span></span><span style=display:flex><span>kubectl apply -f example-service.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># example-controller.yaml内の定義を使用して、ReplicationControllerを作成します。</span>
</span></span><span style=display:flex><span>kubectl apply -f example-controller.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># &lt;directory&gt;ディレクトリ内の、任意の.yaml、.yml、.jsonファイルで定義されているオブジェクトを作成します。</span>
</span></span><span style=display:flex><span>kubectl apply -f &lt;directory&gt;
</span></span></code></pre></div><p><code>kubectl get</code> - 1つ以上のリソースの一覧を表示します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのPodの一覧をプレーンテキスト形式で表示します。</span>
</span></span><span style=display:flex><span>kubectl get pods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのPodの一覧を、ノード名などの追加情報を含めて、プレーンテキスト形式で表示します。</span>
</span></span><span style=display:flex><span>kubectl get pods -o wide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 指定した名前のReplicationControllerの一覧をプレーンテキスト形式で表示します。&#39;replicationcontroller&#39;リソースタイプを短縮して、エイリアス&#39;rc&#39;で置き換えることもできます。</span>
</span></span><span style=display:flex><span>kubectl get replicationcontroller &lt;rc-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのReplicationControllerとServiceの一覧をまとめてプレーンテキスト形式で表示します。</span>
</span></span><span style=display:flex><span>kubectl get rc,services
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのDaemonSetの一覧をプレーンテキスト形式で表示します。</span>
</span></span><span style=display:flex><span>kubectl get ds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># server01ノードで実行中のPodの一覧をプレーンテキスト形式で表示します。</span>
</span></span><span style=display:flex><span>kubectl get pods --field-selector<span style=color:#666>=</span>spec.nodeName<span style=color:#666>=</span>server01
</span></span></code></pre></div><p><code>kubectl describe</code> - 1つ以上のリソースの詳細な状態を、デフォルトでは初期化されないものも含めて表示します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Node &lt;node-name&gt;の詳細を表示します。</span>
</span></span><span style=display:flex><span>kubectl describe nodes &lt;node-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Pod &lt;pod-name&gt;の詳細を表示します。</span>
</span></span><span style=display:flex><span>kubectl describe pods/&lt;pod-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ReplicationController &lt;rc-name&gt;が管理しているすべてのPodの詳細を表示します。</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ReplicationControllerによって作成された任意のPodには、ReplicationControllerの名前がプレフィックスとして付与されます。</span>
</span></span><span style=display:flex><span>kubectl describe pods &lt;rc-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのPodの詳細を表示します。</span>
</span></span><span style=display:flex><span>kubectl describe pods
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>備考:</strong> <code>kubectl get</code>コマンドは通常、同じリソースタイプの1つ以上のリソースを取得するために使用します。豊富なフラグが用意されており、例えば<code>-o</code>や<code>--output</code>フラグを使って、出力フォーマットをカスタマイズできます。<code>-w</code>や<code>--watch</code>フラグを指定することで、特定のオブジェクトの更新を監視できます。<code>kubectl describe</code>コマンドは、指定されたリソースに関する多くの側面を説明することに重点を置いています。ユーザーに対してビューを構築するために、APIサーバーへ複数のAPIコールを呼び出すことができます。例えば、<code>kubectl describe node</code>コマンドは、Nodeに関する情報だけでなく、その上で動いているPodやNodeで生成されたイベントなどをまとめて表示します。</div><p><code>kubectl delete</code> - ファイル、標準出力、または指定したラベルセレクター、名前、リソースセレクター、リソースを指定して、リソースを削除します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># pod.yamlファイルで指定されたタイプと名前を用いて、Podを削除します。</span>
</span></span><span style=display:flex><span>kubectl delete -f pod.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># &#39;&lt;label-key&gt;=&lt;label-value&gt;&#39;というラベルを持つPodとServiceをすべて削除します。</span>
</span></span><span style=display:flex><span>kubectl delete pods,services -l &lt;label-key&gt;<span style=color:#666>=</span>&lt;label-value&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 初期化されていないPodを含む、すべてのPodを削除します。</span>
</span></span><span style=display:flex><span>kubectl delete pods --all
</span></span></code></pre></div><p><code>kubectl exec</code> - Pod内のコンテナに対してコマンドを実行します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Pod &lt;pod-name&gt;から、&#39;date&#39;を実行している時の出力を取得します。デフォルトでは、最初のコンテナから出力されます。</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> &lt;pod-name&gt; -- date
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Pod &lt;pod-name&gt;のコンテナ &lt;container-name&gt;から、&#39;date&#39;を実行している時の出力を取得します。</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> &lt;pod-name&gt; -c &lt;container-name&gt; -- date
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># インタラクティブな TTY を取得し、Pod &lt;pod-name&gt;から/bin/bashを実行します。デフォルトでは、最初のコンテナから出力されます。</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> -ti &lt;pod-name&gt; -- /bin/bash
</span></span></code></pre></div><p><code>kubectl logs</code> - Pod内のコンテナのログを表示します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Pod &lt;pod-name&gt;のログのスナップショットを返します。</span>
</span></span><span style=display:flex><span>kubectl logs &lt;pod-name&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Pod &lt;pod-name&gt;から、ログのストリーミングを開始します。Linuxの&#39;tail -f&#39;コマンドと似ています。</span>
</span></span><span style=display:flex><span>kubectl logs -f &lt;pod-name&gt;
</span></span></code></pre></div><p><code>kubectl diff</code> - 提案されたクラスタに対する更新の差分を表示します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># pod.jsonに含まれるリソースの差分を表示します。</span>
</span></span><span style=display:flex><span>kubectl diff -f pod.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 標準出力から読み込んだファイルの差分を表示します。</span>
</span></span><span style=display:flex><span>cat service.yaml | kubectl diff -f -
</span></span></code></pre></div><h2 id=例-プラグインの作成と使用>例: プラグインの作成と使用</h2><p><code>kubectl</code>プラグインの書き方や使い方に慣れるために、以下の例を使用してください。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># 任意の言語でシンプルなプラグインを作成し、生成される実行可能なファイルに</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># プレフィックス&#34;kubectl-&#34;で始まる名前を付けます。</span>
</span></span><span style=display:flex><span>cat ./kubectl-hello
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080>#!/bin/sh
</span></span></span><span style=display:flex><span><span style=color:#080></span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># このプラグインは、&#34;hello world&#34;という単語を表示します。</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;hello world&#34;</span>
</span></span></code></pre></div><p>プラグインを書いたら、実行可能にします。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chmod a+x ./kubectl-hello
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># さらに、PATH内の場所に移動させます。</span>
</span></span><span style=display:flex><span>sudo mv ./kubectl-hello /usr/local/bin
</span></span><span style=display:flex><span>sudo chown root:root /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># これでkubectlプラグインを作成し、&#34;インストール&#34;できました。</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 通常のコマンドのようにkubectlから呼び出すことで、プラグインを使用できます。</span>
</span></span><span style=display:flex><span>kubectl hello
</span></span></code></pre></div><pre tabindex=0><code>hello world
</code></pre><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># 配置したPATHのフォルダから削除することで、プラグインを&#34;アンインストール&#34;できます。</span>
</span></span><span style=display:flex><span>sudo rm /usr/local/bin/kubectl-hello
</span></span></code></pre></div><p><code>kubectl</code>で利用可能なプラグインをすべて表示するには、<code>kubectl plugin list</code>サブコマンドを使用してください。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl plugin list
</span></span></code></pre></div><p>出力は以下のようになります。</p><pre tabindex=0><code>The following kubectl-compatible plugins are available:

/usr/local/bin/kubectl-hello
/usr/local/bin/kubectl-foo
/usr/local/bin/kubectl-bar
</code></pre><p><code>kubectl plugin list</code>コマンドは、実行不可能なプラグインや、他のプラグインの影に隠れてしまっているプラグインなどについて、警告することもできます。例えば、以下のようになります。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>sudo chmod -x /usr/local/bin/kubectl-foo <span style=color:#080;font-style:italic># 実行権限を削除します。</span>
</span></span><span style=display:flex><span>kubectl plugin list
</span></span></code></pre></div><pre tabindex=0><code>The following kubectl-compatible plugins are available:

/usr/local/bin/kubectl-hello
/usr/local/bin/kubectl-foo
  - warning: /usr/local/bin/kubectl-foo identified as a plugin, but it is not executable
/usr/local/bin/kubectl-bar

error: one plugin warning was found
</code></pre><p>プラグインは、既存の<code>kubectl</code>コマンドの上に、より複雑な機能を構築するための手段であると考えることができます。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat ./kubectl-whoami
</span></span></code></pre></div><p>次の例では、下記の内容を含んだ<code>kubectl-whoami</code>が既に作成済であることを前提としています。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#080></span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># このプラグインは、`kubectl config`コマンドを使って</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 現在選択されているコンテキストに基づいて、現在のユーザーに関する情報を提供します。</span>
</span></span><span style=display:flex><span>kubectl config view --template<span style=color:#666>=</span><span style=color:#b44>&#39;{{ range .contexts }}{{ if eq .name &#34;&#39;</span><span style=color:#a2f;font-weight:700>$(</span>kubectl config current-context<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#39;&#34; }}Current user: {{ printf &#34;%s\n&#34; .context.user }}{{ end }}{{ end }}&#39;</span>
</span></span></code></pre></div><p>上記のコマンドを実行すると、KUBECONFIGファイル内のカレントコンテキストのユーザーを含んだ出力を得られます。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># ファイルを実行可能にします。</span>
</span></span><span style=display:flex><span>sudo chmod +x ./kubectl-whoami
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># さらに、ファイルをPATHに移動します。</span>
</span></span><span style=display:flex><span>sudo mv ./kubectl-whoami /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl whoami
</span></span><span style=display:flex><span>Current user: plugins-user
</span></span></code></pre></div><h2 id=次の項目>次の項目</h2><ul><li><p><a href=/docs/reference/generated/kubectl/kubectl-commands/>kubectl</a>を使い始めてください。</p></li><li><p>プラグインについてより詳しく知りたい場合は, <a href=https://github.com/kubernetes/sample-cli-plugin>example cli plugin</a>を御覧ください。</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-a938176c695852fe70362c29cf615f1c>2 - JSONPathのサポート</h1><p>kubectlはJSONPathのテンプレートをサポートしています。</p><p>JSONPathのテンプレートは、波括弧<code>{}</code>によって囲まれたJSONPathの式によって構成されています。
kubectlでは、JSONPathの式を使うことで、JSONオブジェクトの特定のフィールドをフィルターしたり、出力のフォーマットを変更することができます。
本来のJSONPathのテンプレートの構文に加え、以下の機能と構文が使えます:</p><ol><li>JSONPathの式の内部でテキストをクォートするために、ダブルクォーテーションを使用します。</li><li>リストを反復するために、<code>range</code>、<code>end</code>オペレーターを使用します。</li><li>リストを末尾側から参照するために、負の数のインデックスを使用します。負の数のインデックスはリストを「周回」せず、<code>-index + listLength >= 0</code>が満たされる限りにおいて有効になります。</li></ol><div class="alert alert-info note callout" role=alert><strong>備考:</strong><ul><li><p>式は常にルートのオブジェクトから始まるので、<code>$</code>オペレーターの入力は任意になります。</p></li><li><p>結果のオブジェクトはString()関数を適用した形で表示されます。</p></li></ul></div><p>以下のようなJSONの入力が与えられたとします。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;kind&#34;</span>: <span style=color:#b44>&#34;List&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;items&#34;</span>:[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;kind&#34;</span>:<span style=color:#b44>&#34;None&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;metadata&#34;</span>:{<span style=color:green;font-weight:700>&#34;name&#34;</span>:<span style=color:#b44>&#34;127.0.0.1&#34;</span>},
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;status&#34;</span>:{
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;capacity&#34;</span>:{<span style=color:green;font-weight:700>&#34;cpu&#34;</span>:<span style=color:#b44>&#34;4&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;addresses&#34;</span>:[{<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;LegacyHostIP&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.1&#34;</span>}]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;kind&#34;</span>:<span style=color:#b44>&#34;None&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;metadata&#34;</span>:{<span style=color:green;font-weight:700>&#34;name&#34;</span>:<span style=color:#b44>&#34;127.0.0.2&#34;</span>},
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;status&#34;</span>:{
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;capacity&#34;</span>:{<span style=color:green;font-weight:700>&#34;cpu&#34;</span>:<span style=color:#b44>&#34;8&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;addresses&#34;</span>:[
</span></span><span style=display:flex><span>          {<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;LegacyHostIP&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.2&#34;</span>},
</span></span><span style=display:flex><span>          {<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;another&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.3&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;users&#34;</span>:[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;myself&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;user&#34;</span>: {}
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;e2e&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;user&#34;</span>: {<span style=color:green;font-weight:700>&#34;username&#34;</span>: <span style=color:#b44>&#34;admin&#34;</span>, <span style=color:green;font-weight:700>&#34;password&#34;</span>: <span style=color:#b44>&#34;secret&#34;</span>}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><table><thead><tr><th>機能</th><th>説明</th><th>例</th><th>結果</th></tr></thead><tbody><tr><td><code>text</code></td><td>プレーンテキスト</td><td><code>kind is {.kind}</code></td><td><code>kind is List</code></td></tr><tr><td><code>@</code></td><td>現在のオブジェクト</td><td><code>{@}</code></td><td>入力した値と同じ値</td></tr><tr><td><code>.</code> or <code>[]</code></td><td>子要素</td><td><code>{.kind}</code>, <code>{['kind']}</code> or <code>{['name\.type']}</code></td><td><code>List</code></td></tr><tr><td><code>..</code></td><td>子孫要素を再帰的に探す</td><td><code>{..name}</code></td><td><code>127.0.0.1 127.0.0.2 myself e2e</code></td></tr><tr><td><code>*</code></td><td>ワイルドカード。すべてのオブジェクトを取得する</td><td><code>{.items[*].metadata.name}</code></td><td><code>[127.0.0.1 127.0.0.2]</code></td></tr><tr><td><code>[start:end:step]</code></td><td>添字</td><td><code>{.users[0].name}</code></td><td><code>myself</code></td></tr><tr><td><code>[,]</code></td><td>和集合</td><td><code>{.items[*]['metadata.name', 'status.capacity']}</code></td><td><code>127.0.0.1 127.0.0.2 map[cpu:4] map[cpu:8]</code></td></tr><tr><td><code>?()</code></td><td>フィルター</td><td><code>{.users[?(@.name=="e2e")].user.password}</code></td><td><code>secret</code></td></tr><tr><td><code>range</code>, <code>end</code></td><td>リストの反復</td><td><code>{range .items[*]}[{.metadata.name}, {.status.capacity}] {end}</code></td><td><code>[127.0.0.1, map[cpu:4]] [127.0.0.2, map[cpu:8]]</code></td></tr><tr><td><code>''</code></td><td>解釈済みの文字列をクォートする</td><td><code>{range .items[*]}{.metadata.name}{'\t'}{end}</code></td><td><code>127.0.0.1 127.0.0.2</code></td></tr></tbody></table><p><code>kubectl</code>とJSONPathの式を使った例:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods -o json
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{@}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[0]}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[0].metadata.name}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*][&#39;metadata.name&#39;, &#39;status.capacity&#39;]}&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{.metadata.name}{&#34;\t&#34;}{.status.startTime}{&#34;\n&#34;}{end}&#39;</span>
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>備考:</strong><p>Windowsでは、空白が含まれるJSONPathのテンプレートをクォートする場合は(上記のようにシングルクォーテーションを使うのではなく)、ダブルクォーテーションを使わなければなりません。
また、テンプレート内のリテラルをクォートする際には、シングルクォーテーションか、エスケープされたダブルクォーテーションを使わなければなりません。例えば:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>kubectl get pods -o=jsonpath=<span style=color:#b44>&#34;{range .items[*]}{.metadata.name}{&#39;\t&#39;}{.status.startTime}{&#39;\n&#39;}{end}&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -o=jsonpath=<span style=color:#b44>&#34;{range .items[*]}{.metadata.name}{\&#34;</span>\t\<span style=color:#b44>&#34;}{.status.startTime}{\&#34;</span>\n\<span style=color:#b44>&#34;}{end}&#34;</span>
</span></span></code></pre></div></div><div class="alert alert-info note callout" role=alert><strong>備考:</strong><p>JSONPathの正規表現はサポートされていません。正規表現を利用した検索を行いたい場合は、<code>jq</code>のようなツールを使ってください。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># kubectlはJSONpathの出力として正規表現をサポートしていないので、以下のコマンドは動作しない</span>
</span></span><span style=display:flex><span>kubectl get pods -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[?(@.metadata.name=~/^test$/)].metadata.name}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 上のコマンドに期待される結果が欲しい場合、以下のコマンドを使うとよい</span>
</span></span><span style=display:flex><span>kubectl get pods -o json | jq -r <span style=color:#b44>&#39;.items[] | select(.metadata.name | test(&#34;test-&#34;)).spec.containers[].image&#39;</span>
</span></span></code></pre></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8aba901ac13f124e5782b90ddb166ee2>3 - kubectlチートシート</h1><p>このページには、一般的によく使われる<code>kubectl</code>コマンドとフラグのリストが含まれています。</p><h2 id=kubectlコマンドの補完>Kubectlコマンドの補完</h2><h3 id=bash>BASH</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion bash<span style=color:#666>)</span> <span style=color:#080;font-style:italic># 現在のbashシェルにコマンド補完を設定するには、最初にbash-completionパッケージをインストールする必要があります。</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;source &lt;(kubectl completion bash)&#34;</span> &gt;&gt; ~/.bashrc <span style=color:#080;font-style:italic># bashシェルでのコマンド補完を永続化するために.bashrcに追記します。</span>
</span></span></code></pre></div><p>また、エイリアスを使用している場合にも<code>kubectl</code>コマンドを補完できます。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>alias</span> <span style=color:#b8860b>k</span><span style=color:#666>=</span>kubectl
</span></span><span style=display:flex><span><span style=color:#a2f>complete</span> -F __start_kubectl k
</span></span></code></pre></div><h3 id=zsh>ZSH</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>  <span style=color:#080;font-style:italic># 現在のzshシェルにコマンド補完を設定します</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;[[ </span><span style=color:#b8860b>$commands</span><span style=color:#b44>[kubectl] ]] &amp;&amp; source &lt;(kubectl completion zsh)&#34;</span> &gt;&gt; ~/.zshrc <span style=color:#080;font-style:italic># zshシェルでのコマンド補完を永続化するために.zshrcに追記します。</span>
</span></span></code></pre></div><h2 id=kubectlコンテキストの設定>Kubectlコンテキストの設定</h2><p><code>kubectl</code>がどのKubernetesクラスターと通信するかを設定します。
設定ファイル詳細については<a href=/ja/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>kubeconfigを使用した複数クラスターとの認証</a>をご覧ください。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config view <span style=color:#080;font-style:italic># マージされたkubeconfigの設定を表示します。</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 複数のkubeconfigファイルを同時に読み込む場合はこのように記述します。</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span>~/.kube/config:~/.kube/kubconfig2 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config view
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># e2eユーザのパスワードを取得します。</span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[?(@.name == &#34;e2e&#34;)].user.password}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[].name}&#39;</span>    <span style=color:#080;font-style:italic># 最初のユーザー名を表示します</span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[*].name}&#39;</span>   <span style=color:#080;font-style:italic># ユーザー名のリストを表示します</span>
</span></span><span style=display:flex><span>kubectl config get-contexts                          <span style=color:#080;font-style:italic># コンテキストのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl config current-context                       <span style=color:#080;font-style:italic># 現在のコンテキストを表示します</span>
</span></span><span style=display:flex><span>kubectl config use-context my-cluster-name           <span style=color:#080;font-style:italic># デフォルトのコンテキストをmy-cluster-nameに設定します</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># basic認証をサポートする新たなユーザーをkubeconfigに追加します</span>
</span></span><span style=display:flex><span>kubectl config set-credentials kubeuser/foo.kubernetes.com --username<span style=color:#666>=</span>kubeuser --password<span style=color:#666>=</span>kubepassword
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 現在のコンテキストでkubectlのサブコマンドの名前空間を永続的に変更します</span>
</span></span><span style=display:flex><span>kubectl config set-context --current --namespace<span style=color:#666>=</span>ggckad-s2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 特定のユーザー名と名前空間を使用してコンテキストを設定します</span>
</span></span><span style=display:flex><span>kubectl config set-context gce --user<span style=color:#666>=</span>cluster-admin --namespace<span style=color:#666>=</span>foo <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  <span style=color:#666>&amp;&amp;</span> kubectl config use-context gce
</span></span><span style=display:flex><span> 
</span></span><span style=display:flex><span>kubectl config <span style=color:#a2f>unset</span> users.foo    <span style=color:#080;font-style:italic># ユーザーfooを削除します</span>
</span></span></code></pre></div><h2 id=kubectl-apply>Kubectl Apply</h2><p><code>apply</code>はKubernetesリソースを定義するファイルを通じてアプリケーションを管理します。<code>kubectl apply</code>を実行して、クラスター内のリソースを作成および更新します。これは、本番環境でKubernetesアプリケーションを管理する推奨方法です。
詳しくは<a href=https://kubectl.docs.kubernetes.io>Kubectl Book</a>をご覧ください。</p><h2 id=objectの作成>Objectの作成</h2><p>Kubernetesのマニフェストファイルは、JSONまたはYAMLで定義できます。ファイル拡張子として、<code>.yaml</code>や<code>.yml</code>、<code>.json</code>が使えます。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f ./my-manifest.yaml            <span style=color:#080;font-style:italic># リソースを作成します</span>
</span></span><span style=display:flex><span>kubectl apply -f ./my1.yaml -f ./my2.yaml      <span style=color:#080;font-style:italic># 複数のファイルからリソースを作成します</span>
</span></span><span style=display:flex><span>kubectl apply -f ./dir                         <span style=color:#080;font-style:italic># dirディレクトリ内のすべてのマニフェストファイルからリソースを作成します</span>
</span></span><span style=display:flex><span>kubectl apply -f https://git.io/vPieo          <span style=color:#080;font-style:italic># urlで公開されているファイルからリソースを作成します</span>
</span></span><span style=display:flex><span>kubectl create deployment nginx --image<span style=color:#666>=</span>nginx  <span style=color:#080;font-style:italic># 単一のnginx Deploymentを作成します</span>
</span></span><span style=display:flex><span>kubectl explain pods                           <span style=color:#080;font-style:italic># Podマニフェストのドキュメントを取得します</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 標準入力から複数のYAMLオブジェクトを作成します</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: busybox-sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>  - name: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    image: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    args:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>    - &#34;1000000&#34;
</span></span></span><span style=display:flex><span><span style=color:#b44>---
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: busybox-sleep-less
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>  - name: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    image: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    args:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>    - &#34;1000&#34;
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># いくつかの鍵を含むSecretを作成します</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Secret
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: mysecret
</span></span></span><span style=display:flex><span><span style=color:#b44>type: Opaque
</span></span></span><span style=display:flex><span><span style=color:#b44>data:
</span></span></span><span style=display:flex><span><span style=color:#b44>  password: $(echo -n &#34;s33msi4&#34; | base64 -w0)
</span></span></span><span style=display:flex><span><span style=color:#b44>  username: $(echo -n &#34;jane&#34; | base64 -w0)
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span></code></pre></div><h2 id=リソースの検索と閲覧>リソースの検索と閲覧</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># Getコマンドで基本的な情報を確認します</span>
</span></span><span style=display:flex><span>kubectl get services                          <span style=color:#080;font-style:italic># 現在の名前空間上にあるすべてのサービスのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods --all-namespaces             <span style=color:#080;font-style:italic># すべての名前空間上にあるすべてのPodのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods -o wide                      <span style=color:#080;font-style:italic># 現在の名前空間上にあるすべてのPodについてより詳細なリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get deployment my-dep                 <span style=color:#080;font-style:italic># 特定のDeploymentを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods                              <span style=color:#080;font-style:italic># 現在の名前空間上にあるすべてのPodのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pod my-pod -o yaml                <span style=color:#080;font-style:italic># PodのYAMLを表示します</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Describeコマンドで詳細な情報を確認します</span>
</span></span><span style=display:flex><span>kubectl describe nodes my-node
</span></span><span style=display:flex><span>kubectl describe pods my-pod
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 名前順にソートしたServiceのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get services --sort-by<span style=color:#666>=</span>.metadata.name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Restartカウント順にPodのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods --sort-by<span style=color:#666>=</span><span style=color:#b44>&#39;.status.containerStatuses[0].restartCount&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># capacity順にソートしたPersistentVolumeのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pv --sort-by<span style=color:#666>=</span>.spec.capacity.storage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># app=cassandraラベルのついたすべてのPodのversionラベルを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods --selector<span style=color:#666>=</span><span style=color:#b8860b>app</span><span style=color:#666>=</span>cassandra -o <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[*].metadata.labels.version}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># &#39;ca.crt&#39;のようなピリオドが含まれるキーの値を取得します</span>
</span></span><span style=display:flex><span>kubectl get configmap myconfig <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.data.ca\.crt}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのワーカーノードを取得します（セレクターを使用して、</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 「node-role.kubernetes.io/master」という名前のラベルを持つ結果を除外します）</span>
</span></span><span style=display:flex><span>kubectl get node --selector<span style=color:#666>=</span><span style=color:#b44>&#39;!node-role.kubernetes.io/master&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 現在の名前空間でrunning状態のPodのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods --field-selector<span style=color:#666>=</span>status.phase<span style=color:#666>=</span>Running
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのノードのExternal IPのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get nodes -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[*].status.addresses[?(@.type==&#34;ExternalIP&#34;)].address}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 特定のRCに属するPodの名前のリストを表示します</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># `jq`コマンドは複雑なjsonpathを変換する場合に便利であり、https://stedolan.github.io/jq/で見つけることが可能です</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>sel</span><span style=color:#666>=</span><span style=color:#b68;font-weight:700>${</span><span style=color:#a2f;font-weight:700>$(</span>kubectl get rc my-rc --output<span style=color:#666>=</span>json | jq -j <span style=color:#b44>&#39;.spec.selector | to_entries | .[] | &#34;\(.key)=\(.value),&#34;&#39;</span><span style=color:#a2f;font-weight:700>)</span>%?<span style=color:#b68;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#a2f;font-weight:700>$(</span>kubectl get pods --selector<span style=color:#666>=</span><span style=color:#b8860b>$sel</span> --output<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>={</span>.items..metadata.name<span style=color:#666>}</span><span style=color:#a2f;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのPod(またはラベル付けをサポートする他のKubernetesオブジェクト)のラベルのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get pods --show-labels
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># どのノードがready状態か確認します</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>JSONPATH</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{@.metadata.name}:{range @.status.conditions[*]}{@.type}={@.status};{end}{end}&#39;</span> <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span> <span style=color:#666>&amp;&amp;</span> kubectl get nodes -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;</span><span style=color:#b8860b>$JSONPATH</span><span style=color:#b44>&#34;</span> | grep <span style=color:#b44>&#34;Ready=True&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Podで現在使用中のSecretをすべて表示します</span>
</span></span><span style=display:flex><span>kubectl get pods -o json | jq <span style=color:#b44>&#39;.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name&#39;</span> | grep -v null | sort | uniq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># すべてのPodのInitContainerのコンテナIDのリストを表示します</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># initContainerの削除を回避しながら、停止したコンテナを削除するときに役立つでしょう</span>
</span></span><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*].status.initContainerStatuses[*]}{.containerID}{&#34;\n&#34;}{end}&#39;</span> | cut -d/ -f3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># タイムスタンプでソートされたEventのリストを表示します</span>
</span></span><span style=display:flex><span>kubectl get events --sort-by<span style=color:#666>=</span>.metadata.creationTimestamp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># クラスターの現在の状態を、マニフェストが適用された場合のクラスターの状態と比較します。</span>
</span></span><span style=display:flex><span>kubectl diff -f ./my-manifest.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Nodeから返されるすべてのキーをピリオド区切りの階層表記で生成します。</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 複雑にネストされたJSON構造をもつキーを指定したい時に便利です</span>
</span></span><span style=display:flex><span>kubectl get nodes -o json | jq -c <span style=color:#b44>&#39;paths|join(&#34;.&#34;)&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Pod等から返されるすべてのキーをピリオド区切り階層表記で生成します。</span>
</span></span><span style=display:flex><span>kubectl get pods -o json | jq -c <span style=color:#b44>&#39;paths|join(&#34;.&#34;)&#39;</span>
</span></span></code></pre></div><h2 id=リソースのアップデート>リソースのアップデート</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl <span style=color:#a2f>set</span> image deployment/frontend <span style=color:#b8860b>www</span><span style=color:#666>=</span>image:v2               <span style=color:#080;font-style:italic># frontend Deploymentのwwwコンテナイメージをv2にローリングアップデートします</span>
</span></span><span style=display:flex><span>kubectl rollout <span style=color:#a2f>history</span> deployment/frontend                      <span style=color:#080;font-style:italic># frontend Deploymentの改訂履歴を確認します</span>
</span></span><span style=display:flex><span>kubectl rollout undo deployment/frontend                         <span style=color:#080;font-style:italic># 1つ前のDeploymentにロールバックします</span>
</span></span><span style=display:flex><span>kubectl rollout undo deployment/frontend --to-revision<span style=color:#666>=</span><span style=color:#666>2</span>         <span style=color:#080;font-style:italic># 特定のバージョンにロールバックします</span>
</span></span><span style=display:flex><span>kubectl rollout status -w deployment/frontend                    <span style=color:#080;font-style:italic># frontend Deploymentのローリングアップデートを状態をwatchします</span>
</span></span><span style=display:flex><span>kubectl rollout restart deployment/frontend                      <span style=color:#080;font-style:italic># frontend Deployment を再起動します</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat pod.json | kubectl replace -f -                              <span style=color:#080;font-style:italic># 標準入力から渡されたJSONに基づいてPodを置き換えます</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># リソースを強制的に削除してから再生成し、置き換えます。サービスの停止が発生します</span>
</span></span><span style=display:flex><span>kubectl replace --force -f ./pod.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ReplicaSetリソースで作られたnginxについてServiceを作成します。これは、ポート80で提供され、コンテナへはポート8000で接続します</span>
</span></span><span style=display:flex><span>kubectl expose rc nginx --port<span style=color:#666>=</span><span style=color:#666>80</span> --target-port<span style=color:#666>=</span><span style=color:#666>8000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 単一コンテナのPodイメージのバージョン(タグ)をv4に更新します</span>
</span></span><span style=display:flex><span>kubectl get pod mypod -o yaml | sed <span style=color:#b44>&#39;s/\(image: myimage\):.*$/\1:v4/&#39;</span> | kubectl replace -f -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl label pods my-pod new-label<span style=color:#666>=</span>awesome                      <span style=color:#080;font-style:italic># ラベルを追加します</span>
</span></span><span style=display:flex><span>kubectl annotate pods my-pod icon-url<span style=color:#666>=</span>http://goo.gl/XXBTWq       <span style=color:#080;font-style:italic># アノテーションを追加します</span>
</span></span><span style=display:flex><span>kubectl autoscale deployment foo --min<span style=color:#666>=</span><span style=color:#666>2</span> --max<span style=color:#666>=</span><span style=color:#666>10</span>                <span style=color:#080;font-style:italic># &#34;foo&#34; Deploymentのオートスケーリングを行います</span>
</span></span></code></pre></div><h2 id=リソースへのパッチ適用>リソースへのパッチ適用</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># ノードを部分的に更新します</span>
</span></span><span style=display:flex><span>kubectl patch node k8s-node-1 -p <span style=color:#b44>&#39;{&#34;spec&#34;:{&#34;unschedulable&#34;:true}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># コンテナのイメージを更新します。spec.containers[*].nameはマージキーであるため必須です</span>
</span></span><span style=display:flex><span>kubectl patch pod valid-pod -p <span style=color:#b44>&#39;{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;kubernetes-serve-hostname&#34;,&#34;image&#34;:&#34;new image&#34;}]}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ポテンシャル配列を含むJSONパッチを使用して、コンテナのイメージを更新します</span>
</span></span><span style=display:flex><span>kubectl patch pod valid-pod --type<span style=color:#666>=</span><span style=color:#b44>&#39;json&#39;</span> -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;replace&#34;, &#34;path&#34;: &#34;/spec/containers/0/image&#34;, &#34;value&#34;:&#34;new image&#34;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ポテンシャル配列のJSONパッチを使用してDeploymentのlivenessProbeを無効にします</span>
</span></span><span style=display:flex><span>kubectl patch deployment valid-deployment  --type json   -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;remove&#34;, &#34;path&#34;: &#34;/spec/template/spec/containers/0/livenessProbe&#34;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ポテンシャル配列に新たな要素を追加します</span>
</span></span><span style=display:flex><span>kubectl patch sa default --type<span style=color:#666>=</span><span style=color:#b44>&#39;json&#39;</span> -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/secrets/1&#34;, &#34;value&#34;: {&#34;name&#34;: &#34;whatever&#34; } }]&#39;</span>
</span></span></code></pre></div><h2 id=リソースの編集>リソースの編集</h2><p>任意のエディターでAPIリソースを編集します。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl edit svc/docker-registry                      <span style=color:#080;font-style:italic># docker-registryという名前のサービスを編集します</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>KUBE_EDITOR</span><span style=color:#666>=</span><span style=color:#b44>&#34;nano&#34;</span> kubectl edit svc/docker-registry   <span style=color:#080;font-style:italic># エディターを指定します</span>
</span></span></code></pre></div><h2 id=リソースのスケーリング>リソースのスケーリング</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>3</span> rs/foo                                 <span style=color:#080;font-style:italic># 「foo」という名前のレプリカセットを3にスケーリングします</span>
</span></span><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>3</span> -f foo.yaml                            <span style=color:#080;font-style:italic># 「foo.yaml」で指定されたリソースを3にスケーリングします</span>
</span></span><span style=display:flex><span>kubectl scale --current-replicas<span style=color:#666>=</span><span style=color:#666>2</span> --replicas<span style=color:#666>=</span><span style=color:#666>3</span> deployment/mysql  <span style=color:#080;font-style:italic># mysqlと名付けられたdeploymentの現在のサイズが2であれば、mysqlを3にスケーリングします</span>
</span></span><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>5</span> rc/foo rc/bar rc/baz                   <span style=color:#080;font-style:italic># 複数のReplication controllerをスケーリングします</span>
</span></span></code></pre></div><h2 id=リソースの削除>リソースの削除</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f ./pod.json                                              <span style=color:#080;font-style:italic># pod.jsonで指定されたタイプと名前を使用してPodを削除します</span>
</span></span><span style=display:flex><span>kubectl delete pod,service baz foo                                        <span style=color:#080;font-style:italic># 「baz」と「foo」の名前を持つPodとServiceを削除します</span>
</span></span><span style=display:flex><span>kubectl delete pods,services -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel                              <span style=color:#080;font-style:italic># name=myLabelラベルを持つのPodとServiceを削除します</span>
</span></span><span style=display:flex><span>kubectl -n my-ns delete pod,svc --all                                     <span style=color:#080;font-style:italic># 名前空間my-ns内のすべてのPodとServiceを削除します</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># awkコマンドのpattern1またはpattern2に一致するすべてのPodを削除します。</span>
</span></span><span style=display:flex><span>kubectl get pods  -n mynamespace --no-headers<span style=color:#666>=</span><span style=color:#a2f>true</span> | awk <span style=color:#b44>&#39;/pattern1|pattern2/{print $1}&#39;</span> | xargs  kubectl delete -n mynamespace pod
</span></span></code></pre></div><h2 id=実行中のポッドとの対話処理>実行中のポッドとの対話処理</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs my-pod                                 <span style=color:#080;font-style:italic># Podのログをダンプします(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel                        <span style=color:#080;font-style:italic># name=myLabelラベルの持つPodのログをダンプします(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs my-pod --previous                      <span style=color:#080;font-style:italic># 以前に存在したコンテナのPodログをダンプします(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs my-pod -c my-container                 <span style=color:#080;font-style:italic># 複数コンテナがあるPodで、特定のコンテナのログをダンプします(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel -c my-container        <span style=color:#080;font-style:italic># name=mylabelラベルを持つPodのログをダンプします(標準出力) </span>
</span></span><span style=display:flex><span>kubectl logs my-pod -c my-container --previous      <span style=color:#080;font-style:italic># 複数コンテナがあるPodで、以前に作成した特定のコンテナのログをダンプします(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs -f my-pod                              <span style=color:#080;font-style:italic># Podのログをストリームで確認します(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs -f my-pod -c my-container              <span style=color:#080;font-style:italic># 複数のコンテナがあるPodで、特定のコンテナのログをストリームで確認します(標準出力)</span>
</span></span><span style=display:flex><span>kubectl logs -f -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel --all-containers    <span style=color:#080;font-style:italic># name-myLabelラベルを持つすべてのコンテナのログをストリームで確認します(標準出力)</span>
</span></span><span style=display:flex><span>kubectl run -i --tty busybox --image<span style=color:#666>=</span>busybox -- sh  <span style=color:#080;font-style:italic># Podをインタラクティブシェルとして実行します</span>
</span></span><span style=display:flex><span>kubectl run nginx --image<span style=color:#666>=</span>nginx -n 
</span></span><span style=display:flex><span>mynamespace                                         <span style=color:#080;font-style:italic># 特定の名前空間でnginx Podを実行します</span>
</span></span><span style=display:flex><span>kubectl run nginx --image<span style=color:#666>=</span>nginx                     <span style=color:#080;font-style:italic># nginx Podを実行し、マニフェストファイルをpod.yamlという名前で書き込みます</span>
</span></span><span style=display:flex><span>--dry-run<span style=color:#666>=</span>client -o yaml &gt; pod.yaml
</span></span><span style=display:flex><span>kubectl attach my-pod -i                            <span style=color:#080;font-style:italic># 実行中のコンテナに接続します</span>
</span></span><span style=display:flex><span>kubectl port-forward my-pod 5000:6000               <span style=color:#080;font-style:italic># ローカルマシンのポート5000を、my-podのポート6000に転送します</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> my-pod -- ls /                         <span style=color:#080;font-style:italic># 既存のPodでコマンドを実行(単一コンテナの場合)</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> my-pod -c my-container -- ls /         <span style=color:#080;font-style:italic># 既存のPodでコマンドを実行(複数コンテナがある場合)</span>
</span></span><span style=display:flex><span>kubectl top pod POD_NAME --containers               <span style=color:#080;font-style:italic># 特定のPodとそのコンテナのメトリクスを表示します</span>
</span></span></code></pre></div><h2 id=ノードおよびクラスターとの対話処理>ノードおよびクラスターとの対話処理</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl cordon my-node                                                <span style=color:#080;font-style:italic># my-nodeをスケジューリング不能に設定します</span>
</span></span><span style=display:flex><span>kubectl drain my-node                                                 <span style=color:#080;font-style:italic># メンテナンスの準備としてmy-nodeで動作中のPodを空にします</span>
</span></span><span style=display:flex><span>kubectl uncordon my-node                                              <span style=color:#080;font-style:italic># my-nodeをスケジューリング可能に設定します</span>
</span></span><span style=display:flex><span>kubectl top node my-node                                              <span style=color:#080;font-style:italic># 特定のノードのメトリクスを表示します</span>
</span></span><span style=display:flex><span>kubectl cluster-info                                                  <span style=color:#080;font-style:italic># Kubernetesクラスターのマスターとサービスのアドレスを表示します</span>
</span></span><span style=display:flex><span>kubectl cluster-info dump                                             <span style=color:#080;font-style:italic># 現在のクラスター状態を標準出力にダンプします</span>
</span></span><span style=display:flex><span>kubectl cluster-info dump --output-directory<span style=color:#666>=</span>/path/to/cluster-state   <span style=color:#080;font-style:italic># 現在のクラスター状態を/path/to/cluster-stateにダンプします</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># special-userキーとNoScheduleエフェクトを持つTaintがすでに存在する場合、その値は指定されたとおりに置き換えられます</span>
</span></span><span style=display:flex><span>kubectl taint nodes foo <span style=color:#b8860b>dedicated</span><span style=color:#666>=</span>special-user:NoSchedule
</span></span></code></pre></div><h3 id=リソースタイプ>リソースタイプ</h3><p>サポートされているすべてのリソースタイプを、それらが<a href=/ja/docs/concepts/overview/kubernetes-api/#api-groups>API group</a>か<a href=/ja/docs/concepts/overview/working-with-objects/namespaces>Namespaced</a>、<a href=/ja/docs/concepts/overview/working-with-objects/kubernetes-objects>Kind</a>に関わらずその短縮名をリストします。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl api-resources
</span></span></code></pre></div><p>APIリソースを探索するためのその他の操作:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl api-resources --namespaced<span style=color:#666>=</span><span style=color:#a2f>true</span>      <span style=color:#080;font-style:italic># 名前空間付きのすべてのリソースを表示します</span>
</span></span><span style=display:flex><span>kubectl api-resources --namespaced<span style=color:#666>=</span><span style=color:#a2f>false</span>     <span style=color:#080;font-style:italic># 名前空間のないすべてのリソースを表示します</span>
</span></span><span style=display:flex><span>kubectl api-resources -o name                <span style=color:#080;font-style:italic># すべてのリソースを単純な出力(リソース名のみ)で表示します</span>
</span></span><span style=display:flex><span>kubectl api-resources -o wide                <span style=color:#080;font-style:italic># すべてのリソースを拡張された形(別名 &#34;wide&#34;)で表示します</span>
</span></span><span style=display:flex><span>kubectl api-resources --verbs<span style=color:#666>=</span>list,get       <span style=color:#080;font-style:italic># &#34;list&#34;および&#34;get&#34;操作をサポートするすべてのリソースを表示します</span>
</span></span><span style=display:flex><span>kubectl api-resources --api-group<span style=color:#666>=</span>extensions <span style=color:#080;font-style:italic># &#34;extensions&#34; APIグループのすべてのリソースを表示します</span>
</span></span></code></pre></div><h3 id=出力のフォーマット>出力のフォーマット</h3><p>特定の形式で端末ウィンドウに詳細を出力するには、サポートされている<code>kubectl</code>コマンドに<code>-o</code>(または<code>--output</code>)フラグを追加します。</p><table><thead><tr><th>出力フォーマット</th><th>説明</th></tr></thead><tbody><tr><td><code>-o=custom-columns=&lt;spec></code></td><td>コンマ区切りされたカスタムカラムのリストを指定してテーブルを表示します</td></tr><tr><td><code>-o=custom-columns-file=&lt;filename></code></td><td><code>&lt;filename></code>ファイル内のカスタムカラムテンプレートを使用してテーブルを表示します</td></tr><tr><td><code>-o=json</code></td><td>JSON形式のAPIオブジェクトを出力します</td></tr><tr><td><code>-o=jsonpath=&lt;template></code></td><td><a href=/ja/docs/reference/kubectl/jsonpath>jsonpath</a>式で定義されたフィールドを出力します</td></tr><tr><td><code>-o=jsonpath-file=&lt;filename></code></td><td><code>&lt;filename></code>ファイル内の<a href=/docs/reference/kubectl/jsonpath>jsonpath</a>式で定義されたフィールドを出力します</td></tr><tr><td><code>-o=name</code></td><td>リソース名のみを出力し、それ以外は何も出力しません。</td></tr><tr><td><code>-o=wide</code></td><td>追加の情報を含むプレーンテキスト形式で出力します。Podの場合、Node名が含まれます。</td></tr><tr><td><code>-o=yaml</code></td><td>YAML形式のAPIオブジェクトを出力します</td></tr></tbody></table><p><code>-o=custom-columns</code>を使用したサンプル:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># クラスター内で実行中のすべてのイメージ名を表示する</span>
</span></span><span style=display:flex><span>kubectl get pods -A -o<span style=color:#666>=</span>custom-columns<span style=color:#666>=</span><span style=color:#b44>&#39;DATA:spec.containers[*].image&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># &#34;k8s.gcr.io/coredns:1.6.2&#34;を除いたすべてのイメージ名を表示する</span>
</span></span><span style=display:flex><span>kubectl get pods -A -o<span style=color:#666>=</span>custom-columns<span style=color:#666>=</span><span style=color:#b44>&#39;DATA:spec.containers[?(@.image!=&#34;k8s.gcr.io/coredns:1.6.2&#34;)].image&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># 名前に関係なくmetadata以下のすべてのフィールドを表示する</span>
</span></span><span style=display:flex><span>kubectl get pods -A -o<span style=color:#666>=</span>custom-columns<span style=color:#666>=</span><span style=color:#b44>&#39;DATA:metadata.*&#39;</span>
</span></span></code></pre></div><p>kubectlに関するより多くのサンプルは<a href=/ja/docs/reference/kubectl/overview/#custom-columns>カスタムカラムのリファレンス</a>を参照してください。</p><h3 id=kubectlのログレベルとデバッグ>Kubectlのログレベルとデバッグ</h3><p>kubectlのログレベルは、レベルを表す整数が後に続く<code>-v</code>または<code>--v</code>フラグで制御されます。一般的なKubernetesのログ記録規則と関連するログレベルについて、<a href=https://github.com/kubernetes/community/blob/master/contributors/devel/sig-instrumentation/logging.md>こちら</a>で説明します。</p><table><thead><tr><th>ログレベル</th><th>説明</th></tr></thead><tbody><tr><td><code>--v=0</code></td><td>これは、クラスターオペレーターにログレベルが0であることを"常に"見えるようにするために役立ちます</td></tr><tr><td><code>--v=1</code></td><td>ログレベルが必要ない場合に、妥当なデフォルトのログレベルです</td></tr><tr><td><code>--v=2</code></td><td>サービスに関する重要な定常状態情報と、システムの重要な変更に関連する可能性がある重要なログメッセージを表示します。 これは、ほとんどのシステムで推奨されるデフォルトのログレベルです。</td></tr><tr><td><code>--v=3</code></td><td>変更に関するより詳細なログレベルを表示します</td></tr><tr><td><code>--v=4</code></td><td>デバックにむいたログレベルで表示します</td></tr><tr><td><code>--v=6</code></td><td>要求されたリソースを表示します</td></tr><tr><td><code>--v=7</code></td><td>HTTPリクエストのヘッダを表示します</td></tr><tr><td><code>--v=8</code></td><td>HTTPリクエストのコンテンツを表示します</td></tr><tr><td><code>--v=9</code></td><td>HTTPリクエストのコンテンツをtruncationなしで表示します</td></tr></tbody></table><h2 id=次の項目>次の項目</h2><ul><li><p>kubectlについてより深く学びたい方は<a href=/ja/docs/reference/kubectl/overview/>kubectl概要</a>や<a href=/docs/reference/kubectl/jsonpath>JsonPath</a>をご覧ください。</p></li><li><p>オプションについては<a href=/docs/reference/kubectl/kubectl/>kubectl</a> optionsをご覧ください。</p></li><li><p>また<a href=/docs/reference/kubectl/conventions/>kubectlの利用パターン</a>では再利用可能なスクリプトでkubectlを利用する方法を学べます。</p></li><li><p>コミュニティ版<a href=https://github.com/dennyzhang/cheatsheet-kubernetes-A4>kubectlチートシート</a>もご覧ください。</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-8de6aceb8bf692c06cced446bac5bc92>4 - kubectlの使用規則</h1><p><code>kubectl</code>の推奨される使用規則です。</p><h2 id=再利用可能なスクリプトでの-kubectl-の使用>再利用可能なスクリプトでの<code>kubectl</code>の使用</h2><p>スクリプトでの安定した出力のために:</p><ul><li><code>-o name</code>, <code>-o json</code>, <code>-o yaml</code>, <code>-o go-template</code>, <code>-o jsonpath</code> などの機械指向の出力形式のいずれかを必要します。</li><li>バージョンを完全に指定します。例えば、<code>jobs.v1.batch/myjob</code>のようにします。これにより、kubectlが時間とともに変化する可能性のあるデフォルトのバージョンを使用しないようにします。</li><li>コンテキストや設定、その他の暗黙的な状態に頼ってはいけません。</li></ul><h2 id=ベストプラクティス>ベストプラクティス</h2><h3 id=kubectl-run><code>kubectl run</code></h3><p><code>kubectl run</code>がインフラのコード化を満たすために:</p><ul><li>イメージにバージョン固有のタグを付けて、そのタグを新しいバージョンに移さない。例えば、<code>:latest</code>ではなく、<code>:v1234</code>、<code>v1.2.3</code>、<code>r03062016-1-4</code>を使用してください(詳細は、<a href=/docs/concepts/configuration/overview/#container-images>Best Practices for Configuration</a>を参照してください)。</li><li>パラメーターが多用されているイメージをスクリプトでチェックします。</li><li><code>kubectl run</code> フラグでは表現できない機能を、ソースコントロールでチェックした設定ファイルに切り替えます。</li></ul><p><code>dry-run=client</code> フラグを使用すると、実際に送信することなく、クラスターに送信されるオブジェクトを確認することができます。</p><div class="alert alert-info note callout" role=alert><strong>備考:</strong> すべての<code>kubectl run</code>ジェネレーターは非推奨です。ジェネレーターの<a href=https://v1-17.docs.kubernetes.io/docs/reference/kubectl/conventions/#generators>リスト</a>とその使用方法については、Kubernetes v1.17のドキュメントを参照してください。</div><h4 id=generators>Generators</h4><p><code>kubectl create --dry-run=client -o yaml</code>というkubectlコマンドで以下のリソースを生成することができます。</p><ul><li><code>clusterrole</code>: ClusterRoleを作成します。</li><li><code>clusterrolebinding</code>: 特定のClusterRoleに対するClusterRoleBindingを作成します。</li><li><code>configmap</code>: ローカルファイル、ディレクトリ、またはリテラル値からConfigMapを作成します。</li><li><code>cronjob</code>: 指定された名前のCronJobを作成します。</li><li><code>deployment</code>: 指定された名前でDeploymentを作成します。</li><li><code>job</code>: 指定された名前でJobを作成します。</li><li><code>namespace</code>: 指定された名前でNamespaceを作成します。</li><li><code>poddisruptionbudget</code>: 指定された名前でPodDisruptionBudgetを作成します。</li><li><code>priorityclass</code>: 指定された名前でPriorityClassを作成します。</li><li><code>quota</code>: 指定された名前でQuotaを作成します。</li><li><code>role</code>: 1つのルールでRoleを作成します。</li><li><code>rolebinding</code>: 特定のロールやClusterRoleに対するRoleBindingを作成します。</li><li><code>secret</code>: 指定されたサブコマンドを使用してSecretを作成します。</li><li><code>service</code>: 指定されたサブコマンドを使用してServiceを作成します。</li><li><code>ServiceAccount</code>: 指定された名前でServiceAccountを作成します。</li></ul><h3 id=kubectl-apply><code>kubectl apply</code></h3><ul><li>リソースの作成や更新には <code>kubectl apply</code> を使用できます。kubectl applyを使ったリソースの更新については、<a href=https://kubectl.docs.kubernetes.io>Kubectl Book</a>を参照してください。</li></ul></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/ja/docs/home/>ホーム</a>
<a class=text-white href=/ja/blog/>Blogs</a>
<a class=text-white href=/ja/training/>トレーニング</a>
<a class=text-white href=/ja/partners/>パートナー</a>
<a class=text-white href=/ja/community/>コミュニティ</a>
<a class=text-white href=/ja/case-studies/>ケーススタディ</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Trademark Usage page</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>