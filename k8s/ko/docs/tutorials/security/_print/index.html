<!doctype html><html lang=ko class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/tutorials/security/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/docs/tutorials/security/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/ko/docs/tutorials/security/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>ë³´ì•ˆ | Kubernetes</title><meta property="og:title" content="ë³´ì•ˆ"><meta property="og:description" content="ìš´ì˜ ìˆ˜ì¤€ì˜ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/ko/docs/tutorials/security/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="ë³´ì•ˆ"><meta itemprop=description content="ìš´ì˜ ìˆ˜ì¤€ì˜ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜"><meta name=twitter:card content="summary"><meta name=twitter:title content="ë³´ì•ˆ"><meta name=twitter:description content="ìš´ì˜ ìˆ˜ì¤€ì˜ ì»¨í…Œì´ë„ˆ ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content><meta property="og:description" content><meta name=twitter:description content><meta property="og:url" content="https://kubernetes.io/ko/docs/tutorials/security/"><meta property="og:title" content="ë³´ì•ˆ"><meta name=twitter:title content="ë³´ì•ˆ"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/ko/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/ko/docs/>ë¬¸ì„œ</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/blog/>ì¿ ë²„ë„¤í‹°ìŠ¤ ë¸”ë¡œê·¸</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/training/>êµìœ¡</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/partners/>íŒŒíŠ¸ë„ˆ</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/community/>Community</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/case-studies/>ì‚¬ë¡€ ì—°êµ¬</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>ë²„ì „</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/ko/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/ko/docs/tutorials/security/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/ko/docs/tutorials/security/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/ko/docs/tutorials/security/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/ko/docs/tutorials/security/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/ko/docs/tutorials/security/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>í•œêµ­ì–´ (Korean)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/tutorials/security/>English</a>
<a class=dropdown-item href=/zh-cn/docs/tutorials/security/>ä¸­æ–‡ (Chinese)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>ì´ ì„¹ì…˜ì˜ ë‹¤ì¤‘ í˜ì´ì§€ ì¶œë ¥ í™”ë©´ì„.
<a href=# onclick="return print(),!1">ì—¬ê¸°ë¥¼ í´ë¦­í•˜ì—¬ í”„ë¦°íŠ¸</a>.</p><p><a href=/ko/docs/tutorials/security/>ì´ í˜ì´ì§€ì˜ ì¼ë°˜ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>.</p></div><h1 class=title>ë³´ì•ˆ</h1><ul><li>1: <a href=#pg-fca078b8ac6b82352ed52187a2da91b7>AppArmorë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì»¨í…Œì´ë„ˆì˜ ì ‘ê·¼ ì œí•œ</a></li><li>2: <a href=#pg-31a6c137cfc5bfea9d88f4b109109465>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</a></li><li>3: <a href=#pg-d5f847bcdb6f7efbfc9c8a180d73e29a>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-fca078b8ac6b82352ed52187a2da91b7>1 - AppArmorë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ì»¨í…Œì´ë„ˆì˜ ì ‘ê·¼ ì œí•œ</h1><div style=margin-top:10px;margin-bottom:10px><b>ê¸°ëŠ¥ ìƒíƒœ:</b> <code>Kubernetes v1.4 [beta]</code></div><p>AppArmorëŠ” í‘œì¤€ ë¦¬ëˆ…ìŠ¤ ì‚¬ìš©ìì™€ ê·¸ë£¹ ê¸°ë°˜ì˜ ê¶Œí•œì„ ë³´ì™„í•˜ì—¬, í•œì •ëœ ë¦¬ì†ŒìŠ¤ ì§‘í•©ìœ¼ë¡œ
í”„ë¡œê·¸ë¨ì„ ì œí•œí•˜ëŠ” ë¦¬ëˆ…ìŠ¤ ì»¤ë„ ë³´ì•ˆ ëª¨ë“ˆì´ë‹¤. AppArmorëŠ” ì„ì˜ì˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ëŒ€í•´ì„œ
ì ì¬ì ì¸ ê³µê²© ë²”ìœ„ë¥¼ ì¤„ì´ê³  ë”ìš± ì‹¬ì¸µì ì¸ ë°©ì–´ë¥¼ ì œê³µí•˜ë„ë¡ êµ¬ì„±í•  ìˆ˜ ìˆë‹¤.
ì´ ê¸°ëŠ¥ì€ íŠ¹ì • í”„ë¡œê·¸ë¨ì´ë‚˜ ì»¨í…Œì´ë„ˆì—ì„œ í•„ìš”í•œ ë¦¬ëˆ…ìŠ¤ ê¸°ëŠ¥, ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©, íŒŒì¼ ê¶Œí•œ ë“±ì— ëŒ€í•œ
ì ‘ê·¼ì„ í—ˆìš©í•˜ëŠ” í”„ë¡œíŒŒì¼ë¡œ êµ¬ì„±í•œë‹¤. ê° í”„ë¡œíŒŒì¼ì€
í—ˆìš©í•˜ì§€ ì•Šì€ ë¦¬ì†ŒìŠ¤ ì ‘ê·¼ì„ ì°¨ë‹¨í•˜ëŠ” <em>ê°•ì œ(enforcing)</em> ëª¨ë“œ ë˜ëŠ”
ìœ„ë°˜ë§Œì„ ë³´ê³ í•˜ëŠ” <em>ë¶ˆí‰(complain)</em> ëª¨ë“œë¡œ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.</p><p>AppArmorë¥¼ ì´ìš©í•˜ë©´ ì»¨í…Œì´ë„ˆê°€ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ” ì‘ì—…ì„ ì œí•œí•˜ê³  ë˜ëŠ”
ì‹œìŠ¤í…œ ë¡œê·¸ë¥¼ í†µí•´ ë” ë‚˜ì€ ê°ì‚¬ë¥¼ ì œê³µí•˜ì—¬ ë” ì•ˆì „í•œ ë°°í¬ë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.
ê·¸ëŸ¬ë‚˜ AppArmorê°€ ì€íƒ„í™˜(ì–¸ì œë‚˜ í†µí•˜ëŠ” ë¬´ì ì˜ ë°©ë²•)ì´ ì•„ë‹ˆë©°,
ì• í”Œë¦¬ì¼€ì´ì…˜ ì½”ë“œ ì·¨ì•½ì ì„ ë³´í˜¸í•˜ê¸° ìœ„í•œ ì—¬ëŸ¬ ì¡°ì¹˜ë¥¼ í•  ìˆ˜ ìˆëŠ” ê²ƒ ë¿ì„ì„ ìŠìœ¼ë©´ ì•ˆëœë‹¤.
ì–‘í˜¸í•˜ê³  ì œí•œì ì¸ í”„ë¡œíŒŒì¼ì„ ì œê³µí•˜ê³ , ì• í”Œë¦¬ì¼€ì´ì…˜ê³¼ í´ëŸ¬ìŠ¤í„°ë¥¼ ì—¬ëŸ¬ ì¸¡ë©´ì—ì„œ ê°•í™”í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</p><h2 id=ëª©ì >ëª©ì </h2><ul><li>ë…¸ë“œì— í”„ë¡œíŒŒì¼ì„ ì–´ë–»ê²Œ ì ì¬í•˜ëŠ”ì§€ ì˜ˆì‹œë¥¼ ë³¸ë‹¤.</li><li>íŒŒë“œì— í”„ë¡œíŒŒì¼ì„ ì–´ë–»ê²Œ ê°•ì œ ì ìš©í•˜ëŠ”ì§€ ë°°ìš´ë‹¤.</li><li>í”„ë¡œíŒŒì¼ì´ ì ì¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ë°°ìš´ë‹¤.</li><li>í”„ë¡œíŒŒì¼ì„ ìœ„ë°˜í•˜ëŠ” ê²½ìš°ë¥¼ ì‚´í´ë³¸ë‹¤.</li><li>í”„ë¡œíŒŒì¼ì„ ì ì¬í•  ìˆ˜ ì—†ì„ ê²½ìš°ë¥¼ ì‚´í´ë³¸ë‹¤.</li></ul><h2 id=ì‹œì‘í•˜ê¸°-ì „ì—>ì‹œì‘í•˜ê¸° ì „ì—</h2><p>ë‹¤ìŒì„ ë³´ì¥í•´ì•¼ í•œë‹¤.</p><ol><li><p>ì¿ ë²„ë„¤í‹°ìŠ¤ ë²„ì „ì€ ìµœì†Œ 1.4 ì´ë‹¤. -- ì¿ ë²„ë„¤í‹°ìŠ¤ v1.4ë¶€í„° AppArmor ì§€ì›ì„ ì¶”ê°€í–ˆë‹¤.
v1.4 ì´ì „ ì¿ ë²„ë„¤í‹°ìŠ¤ ì»´í¬ë„ŒíŠ¸ëŠ” ìƒˆë¡œìš´ AppArmor ì–´ë…¸í…Œì´ì…˜ì„ ì¸ì‹í•˜ì§€ ëª»í•˜ê³ 
ì œê³µë˜ëŠ” AppArmor ì„¤ì •ì„ <strong>ì¡°ìš©íˆ ë¬´ì‹œ</strong>í•  ê²ƒì´ë‹¤. íŒŒë“œì—ì„œ ì˜ˆìƒí•˜ëŠ” ë³´í˜¸ë¥¼ ë°›ê³  ìˆëŠ”ì§€ í™•ì¸í•˜ë ¤ë©´
í•´ë‹¹ ë…¸ë“œì˜ Kubelet ë²„ì „ì„ í™•ì¸í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•˜ë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl get nodes -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>$&#39;{range .items[*]}{@.metadata.name}: {@.status.nodeInfo.kubeletVersion}\n{end}&#39;</span>
</span></span></code></pre></div><pre tabindex=0><code>gke-test-default-pool-239f5d02-gyn2: v1.4.0
gke-test-default-pool-239f5d02-x1kf: v1.4.0
gke-test-default-pool-239f5d02-xwux: v1.4.0
</code></pre></li><li><p>AppArmor ì»¤ë„ ëª¨ë“ˆì„ ì‚¬ìš© ê°€ëŠ¥í•´ì•¼ í•œë‹¤. -- ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì— AppArmor í”„ë¡œíŒŒì¼ì„ ê°•ì œ ì ìš©í•˜ê¸° ìœ„í•´ AppArmor ì»¤ë„ ëª¨ë“ˆì€ ë°˜ë“œì‹œ ì„¤ì¹˜ë˜ì–´ ìˆê³ 
ì‚¬ìš© ê°€ëŠ¥í•´ì•¼ í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ Ubuntu ë° SUSE ê°™ì€ ë°°í¬íŒì€ ëª¨ë“ˆì„ ê¸°ë³¸ê°’ìœ¼ë¡œ ì§€ì›í•˜ê³ , ê·¸ ì™¸ ë§ì€ ë‹¤ë¥¸ ë°°í¬íŒë“¤ì€ ì„ íƒì ìœ¼ë¡œ ì§€ì›í•œë‹¤.
ëª¨ë“ˆì´ ì‚¬ìš© ê°€ëŠ¥í•œì§€ í™•ì¸í•˜ë ¤ë©´
<code>/sys/module/apparmor/parameters/enabled</code> íŒŒì¼ì„ í™•ì¸í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat /sys/module/apparmor/parameters/enabled
</span></span><span style=display:flex><span>Y
</span></span></code></pre></div><p>Kubelet(>=v1.4)ì´ AppArmor ê¸°ëŠ¥ ì§€ì›ì„ í¬í•¨í•˜ì§€ë§Œ, ì»¤ë„ ëª¨ë“ˆì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë©´
íŒŒë“œì—ì„œ AppArmor ì˜µì…˜ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ê±°ë¶€ëœë‹¤.</p></li></ol><div class="alert alert-info note callout" role=alert><strong>ì°¸ê³ :</strong> ìš°ë¶„íˆ¬ì—ëŠ” ì¶”ê°€ì ì¸ í›…(hook)ì´ë‚˜ ì¶”ê°€ ê¸°ëŠ¥ íŒ¨ì¹˜ë¥¼ í¬í•¨í•œ ë¦¬ëˆ…ìŠ¤ ì»¤ë„ì˜ ìƒìœ„ ìŠ¤íŠ¸ë¦¼ì— ë¨¸ì§€ë˜ì§€ ì•Šì€
ë§ì€ AppArmor íŒ¨ì¹˜ë¥¼ ê°€ì§€ê³  ìˆë‹¤. ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ”
ìƒìœ„ ìŠ¤íŠ¸ë¦¼ ë²„ì „ì—ì„œ í…ŒìŠ¤íŠ¸í•œ íŒ¨ì¹˜ë§Œì„ ê°€ì§€ê³  ìˆì–´ì„œ ë‹¤ë¥¸ ê¸°ëŠ¥ì€ ì§€ì›ì„ ë³´ì¥í•˜ì§€ ì•ŠëŠ”ë‹¤.</div><ol start=3><li><p>ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì´ AppArmorì„ ì§€ì›í•œë‹¤. -- í˜„ì¬ ëª¨ë“  ì¼ë°˜ì ì¸ ì¿ ë²„ë„¤í‹°ìŠ¤ë¥¼ ì§€ì›í•˜ëŠ”
<a class=glossary-tooltip title='DockerëŠ” ìš´ì˜ ì‹œìŠ¤í…œ ìˆ˜ì¤€ì˜ ê°€ìƒí™”ë¥¼ ì œê³µí•˜ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ ê¸°ìˆ ì´ë©°, ì»¨í…Œì´ë„ˆë¡œë„ ì•Œë ¤ì ¸ ìˆë‹¤.' data-toggle=tooltip data-placement=top href=https://docs.docker.com/engine/ target=_blank aria-label=ë„ì»¤(Docker)>ë„ì»¤(Docker)</a>, <a class=glossary-tooltip title='A lightweight container runtime specifically for Kubernetes' data-toggle=tooltip data-placement=top href=https://cri-o.io/#what-is-cri-o target=_blank aria-label=CRI-O>CRI-O</a> ë˜ëŠ”
<a class=glossary-tooltip title='A container runtime with an emphasis on simplicity, robustness and portability' data-toggle=tooltip data-placement=top href=https://containerd.io/docs/ target=_blank aria-label=containerd>containerd</a> ì™€ ê°™ì€ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ë“¤ì€ AppArmorë¥¼ ì§€ì›í•´ì•¼ í•œë‹¤.
ì´ ëŸ°íƒ€ì„ ì„¤ëª…ì„œë¥¼ ì°¸ì¡°í•´ì„œ í´ëŸ¬ìŠ¤í„°ê°€ AppArmorë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•œ
ìš”êµ¬ ì‚¬í•­ì„ ì¶©ì¡±í•˜ëŠ”ì§€ í™•ì¸í•´ì•¼ í•œë‹¤.</p></li><li><p>í”„ë¡œíŒŒì¼ì´ ì ì¬ë˜ì–´ ìˆë‹¤. -- AppArmorëŠ” ê° ì»¨í…Œì´ë„ˆì™€ í•¨ê»˜ ì‹¤í–‰í•´ì•¼ í•˜ëŠ” AppArmor í”„ë¡œíŒŒì¼ì„ ì§€ì •í•˜ì—¬ íŒŒë“œì— ì ìš©í•œë‹¤.
ì»¤ë„ì— ì§€ì •í•œ í”„ë¡œíŒŒì¼ì´ ì ì¬ë˜ì§€ ì•Šì•˜ë‹¤ë©´, Kubelet(>= v1.4)ì€ íŒŒë“œë¥¼ ê±°ë¶€í•œë‹¤. í•´ë‹¹ ë…¸ë“œì— ì–´ë–¤ í”„ë¡œíŒŒì¼ì´ ì ì¬ë˜ì—ˆëŠ”ì§€ëŠ”
<code>/sys/kernel/security/apparmor/profiles</code> íŒŒì¼ì„ í†µí•´ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
ì˜ˆë¥¼ ë“¤ì–´,</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ ssh gke-test-default-pool-239f5d02-gyn2 <span style=color:#b44>&#34;sudo cat /sys/kernel/security/apparmor/profiles | sort&#34;</span>
</span></span></code></pre></div><pre tabindex=0><code>apparmor-test-deny-write (enforce)
apparmor-test-audit-write (enforce)
docker-default (enforce)
k8s-nginx (enforce)
</code></pre><p>ë…¸ë“œì— í”„ë¡œíŒŒì¼ì„ ì ì¬í•˜ëŠ” ê²ƒì— ëŒ€í•´ ë” ìì„¸í•œ ë‚´ìš©ì€
<a href=#setting-up-nodes-with-profiles>í”„ë¡œíŒŒì¼ê³¼ í•¨ê»˜ ë…¸ë“œ ì„¤ì •í•˜ê¸°</a>.</p></li></ol><p>AppArmor ì§€ì›ì´ í¬í•¨ëœ Kubelet (>= v1.4)ì´ë©´
ì–´ë–¤ ì „ì œ ì¡°ê±´ì´ ì¶©ì¡±ë˜ì§€ ì•Šìœ¼ë©´ AppArmorì™€ í•¨ê»˜í•œ íŒŒë“œë¥¼ ê±°ë¶€í•œë‹¤.
ë…¸ë“œ ìƒì— AppArmor ì§€ì› ì—¬ë¶€ëŠ”
ë…¸ë“œ ì¤€ë¹„ ì¡°ê±´ ë©”ì‹œì§€ë¥¼ í™•ì¸í•˜ì—¬(ì´í›„ ë¦´ë¦¬ìŠ¤ì—ì„œëŠ” ì‚­ì œë  ê²ƒ ê°™ì§€ë§Œ) ê²€ì¦í•  ìˆ˜ ìˆë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get nodes -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{@.metadata.name}: {.status.conditions[?(@.reason==&#34;KubeletReady&#34;)].message}{&#34;\n&#34;}{end}&#39;</span>
</span></span></code></pre></div><pre tabindex=0><code>gke-test-default-pool-239f5d02-gyn2: kubelet is posting ready status. AppArmor enabled
gke-test-default-pool-239f5d02-x1kf: kubelet is posting ready status. AppArmor enabled
gke-test-default-pool-239f5d02-xwux: kubelet is posting ready status. AppArmor enabled
</code></pre><h2 id=íŒŒë“œ-ë³´ì•ˆ-ê°•í™”í•˜ê¸°>íŒŒë“œ ë³´ì•ˆ ê°•í™”í•˜ê¸°</h2><div class="alert alert-info note callout" role=alert><strong>ì°¸ê³ :</strong> AppArmorëŠ” í˜„ì¬ ë² íƒ€ì´ë©°, ì´ ë•Œë¬¸ì— ì˜µì…˜ì€ ì–´ë…¸í…Œì´ì…˜ í˜•ì‹ìœ¼ë¡œ ì§€ì •í•œë‹¤. ì¼ë°˜ ì‚¬ìš©ì ë²„ì „ì´ ë˜ë©´,
ì–´ë…¸í…Œì´ì…˜ì€ ìµœìƒìœ„ ì¢…ë¥˜ì˜ í•„ë“œë¡œ ëŒ€ì²´ë  ê²ƒì´ë‹¤(ìì„¸í•œ ë‚´ìš©ì€
<a href=#upgrade-path-to-general-availability>ì¼ë°˜ ì‚¬ìš©ì ë²„ì „ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œ ë°©ë²•</a> ì°¸ê³ )</div><p>AppArmor í”„ë¡œíŒŒì¼ì€ <em>ì»¨í…Œì´ë„ˆë§ˆë‹¤</em> ì§€ì •ëœë‹¤. í•¨ê»˜ ì‹¤í–‰í•  íŒŒë“œ ì»¨í…Œì´ë„ˆì— AppArmor í”„ë¡œíŒŒì¼ì„ ì§€ì •í•˜ë ¤ë©´
íŒŒë“œì˜ ë©”íƒ€ë°ì´í„°ì— ì–´ë…¸í…Œì´ì…˜ì„ ì¶”ê°€í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>container.apparmor.security.beta.kubernetes.io/&lt;container_name&gt;</span>:<span style=color:#bbb> </span>&lt;profile_ref&gt;<span style=color:#bbb>
</span></span></span></code></pre></div><p><code>&lt;container_name></code>ì€ í”„ë¡œíŒŒì¼ì„ ì ìš©í•˜ëŠ” ì»¨í…Œì´ë„ˆ ì´ë¦„ì´ê³ , <code>&lt;profile_ref></code>ëŠ”
ì ìš©í•  í”„ë¡œíŒŒì¼ì„ ì§€ì •í•œë‹¤. <code>profile_ref</code>ëŠ” ë‹¤ìŒ ì¤‘ì— í•˜ë‚˜ì´ë‹¤.</p><ul><li>ëŸ°íƒ€ì„ì˜ ê¸°ë³¸ í”„ë¡œíŒŒì¼ì„ ì ìš©í•˜ê¸° ìœ„í•œ <code>runtime/default</code></li><li><code>&lt;profile_name></code>ë¡œ ì´ë¦„í•œ í˜¸ìŠ¤íŠ¸ì— ì ì¬ë˜ëŠ” í”„ë¡œíŒŒì¼ì„ ì ìš©í•˜ê¸° ìœ„í•œ <code>localhost/&lt;profile_name></code></li><li>ì ì¬í•  í”„ë¡œíŒŒì¼ì´ ì—†ìŒì„ ë‚˜íƒ€ë‚´ëŠ” <code>unconfined</code></li></ul><p>ì–´ë…¸í…Œì´ì…˜ê³¼ í”„ë¡œíŒŒì¼ ì´ë¦„ í˜•ì‹ì˜ ìì„¸í•œ ë‚´ìš©ì€ <a href=#api-reference>API ì°¸ì¡°</a>ë¥¼ ì‚´í´ë³¸ë‹¤.</p><p>ì¿ ë²„ë„¤í‹°ìŠ¤ AppArmor ì˜ ì‘ë™ ìˆœì„œëŠ” ëª¨ë“  ì„ í–‰ ì¡°ê±´ì´ ì¶©ì¡±ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê³ ,
ì ìš©ì„ ìœ„í•´ ì„ íƒí•œ í”„ë¡œíŒŒì¼ì„ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ìœ¼ë¡œ ì „ë‹¬í•˜ì—¬ ì´ë£¨ì–´ì§„ë‹¤.
ë§Œì•½ ì„ í–‰ ì¡°ê±´ì´ ì¶©ì¡±ë˜ì§€ ì•Šìœ¼ë©´ íŒŒë“œëŠ” ê±°ë¶€ë˜ê³  ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.</p><p>í”„ë¡œíŒŒì¼ì´ ì ìš©ë˜ì—ˆëŠ”ì§€ í™•ì¸í•˜ê¸° ìœ„í•´, ì»¨í…Œì´ë„ˆ ìƒì„± ì´ë²¤íŠ¸ì— ë‚˜ì—´ëœ AppArmor ë³´ì•ˆ ì˜µì…˜ì„ ì°¾ì•„ ë³¼ ìˆ˜ ìˆë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get events | grep Created
</span></span></code></pre></div><pre tabindex=0><code>22s        22s         1         hello-apparmor     Pod       spec.containers{hello}   Normal    Created     {kubelet e2e-test-stclair-node-pool-31nt}   Created container with docker id 269a53b202d3; Security:[seccomp=unconfined apparmor=k8s-apparmor-example-deny-write]apparmor=k8s-apparmor-example-deny-write]
</code></pre><p>ì»¨í…Œì´ë„ˆì˜ ë£¨íŠ¸ í”„ë¡œì„¸ìŠ¤ê°€ ì˜¬ë°”ë¥¸ í”„ë¡œíŒŒì¼ë¡œ ì‹¤í–‰ë˜ëŠ”ì§€ëŠ” proc attrì„ í™•ì¸í•˜ì—¬ ì§ì ‘ ê²€ì¦í•  ìˆ˜ ìˆë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> &lt;pod_name&gt; cat /proc/1/attr/current
</span></span></code></pre></div><pre tabindex=0><code>k8s-apparmor-example-deny-write (enforce)
</code></pre><h2 id=ì˜ˆì‹œ>ì˜ˆì‹œ</h2><p><em>ì´ ì˜ˆì‹œëŠ” AppArmorë¥¼ ì§€ì›í•˜ëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ ì´ë¯¸ êµ¬ì„±í•˜ì˜€ë‹¤ê³  ê°€ì •í•œë‹¤.</em></p><p>ë¨¼ì € ë…¸ë“œì—ì„œ ì‚¬ìš©í•˜ë ¤ëŠ” í”„ë¡œíŒŒì¼ì„ ì ì¬í•´ì•¼ í•œë‹¤. ì‚¬ìš©í•  í”„ë¡œíŒŒì¼ì€ íŒŒì¼ ì“°ê¸°ë¥¼ ê±°ë¶€í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic>#include &lt;tunables/global&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>profile k8s-apparmor-example-deny-write <span style=color:#b8860b>flags</span><span style=color:#666>=(</span>attach_disconnected<span style=color:#666>)</span> <span style=color:#666>{</span>
</span></span><span style=display:flex><span>  <span style=color:#080;font-style:italic>#include &lt;abstractions/base&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  file,
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#080;font-style:italic># Deny all file writes.</span>
</span></span><span style=display:flex><span>  deny /** w,
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span></code></pre></div><p>íŒŒë“œë¥¼ ì–¸ì œ ìŠ¤ì¼€ì¤„í• ì§€ ì•Œì§€ ëª»í•˜ë¯€ë¡œ ëª¨ë“  ë…¸ë“œì— í”„ë¡œíŒŒì¼ì„ ì ì¬í•´ì•¼ í•œë‹¤.
ì´ ì˜ˆì‹œì—ì„œëŠ” SSHë¥¼ ì´ìš©í•˜ì—¬ í”„ë¡œíŒŒì¼ì„ ì„¤ì¹˜í•  ê²ƒì´ë‚˜ ë‹¤ë¥¸ ë°©ë²•ì€
<a href=#setting-up-nodes-with-profiles>í”„ë¡œíŒŒì¼ê³¼ í•¨ê»˜ ë…¸ë“œ ì„¤ì •í•˜ê¸°</a>ì—ì„œ ë…¼ì˜í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#b8860b>NODES</span><span style=color:#666>=(</span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># The SSH-accessible domain names of your nodes</span>
</span></span><span style=display:flex><span>    gke-test-default-pool-239f5d02-gyn2.us-central1-a.my-k8s
</span></span><span style=display:flex><span>    gke-test-default-pool-239f5d02-x1kf.us-central1-a.my-k8s
</span></span><span style=display:flex><span>    gke-test-default-pool-239f5d02-xwux.us-central1-a.my-k8s<span style=color:#666>)</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>for</span> NODE in <span style=color:#b68;font-weight:700>${</span><span style=color:#b8860b>NODES</span>[*]<span style=color:#b68;font-weight:700>}</span>; <span style=color:#a2f;font-weight:700>do</span> ssh <span style=color:#b8860b>$NODE</span> <span style=color:#b44>&#39;sudo apparmor_parser -q &lt;&lt;EOF
</span></span></span><span style=display:flex><span><span style=color:#b44>#include &lt;tunables/global&gt;
</span></span></span><span style=display:flex><span><span style=color:#b44>
</span></span></span><span style=display:flex><span><span style=color:#b44>profile k8s-apparmor-example-deny-write flags=(attach_disconnected) {
</span></span></span><span style=display:flex><span><span style=color:#b44>  #include &lt;abstractions/base&gt;
</span></span></span><span style=display:flex><span><span style=color:#b44>
</span></span></span><span style=display:flex><span><span style=color:#b44>  file,
</span></span></span><span style=display:flex><span><span style=color:#b44>
</span></span></span><span style=display:flex><span><span style=color:#b44>  # Deny all file writes.
</span></span></span><span style=display:flex><span><span style=color:#b44>  deny /** w,
</span></span></span><span style=display:flex><span><span style=color:#b44>}
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF&#39;</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>done</span>
</span></span></code></pre></div><p>ë‹¤ìŒìœ¼ë¡œ ì“°ê¸° ê¸ˆì§€ í”„ë¡œíŒŒì¼ëœ "Hello AppArmor" íŒŒë“œë¥¼ ì‹¤í–‰í•œë‹¤.</p><div class=highlight><div class=copy-code-icon style=text-align:right><a href=https://raw.githubusercontent.com/kubernetes/website/main/content/ko/examples/pods/security/hello-apparmor.yaml download=pods/security/hello-apparmor.yaml><code>pods/security/hello-apparmor.yaml</code></a>
<img src=/images/copycode.svg style=max-height:24px;cursor:pointer onclick='copyCode("pods-security-hello-apparmor-yaml")' title="Copy pods/security/hello-apparmor.yaml to clipboard"></img></div><div class=includecode id=pods-security-hello-apparmor-yaml><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>Pod<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>hello-apparmor<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>annotations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic># ì¿ ë²„ë„¤í‹°ìŠ¤ì— &#39;k8s-apparmor-example-deny-write&#39; AppArmor í”„ë¡œíŒŒì¼ì„ ì ìš©í•¨ì„ ì•Œë¦°ë‹¤.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:#080;font-style:italic># ìŠì§€ ë§ ê²ƒì€ ì¿ ë²„ë„¤í‹°ìŠ¤ ë…¸ë“œì—ì„œ ì‹¤í–‰ ì¤‘ì¸ ë²„ì „ì´ 1.4 ì´ìƒì´ ì•„ë‹Œ ê²½ìš°ì—ëŠ” ì´ ì„¤ì •ì€ ë¬´ì‹œëœë‹¤ëŠ” ê²ƒì´ë‹¤.</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>container.apparmor.security.beta.kubernetes.io/hello</span>:<span style=color:#bbb> </span>localhost/k8s-apparmor-example-deny-write<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>spec</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>containers</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>hello<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb> </span>busybox:1.28<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>command</span>:<span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#b44>&#34;sh&#34;</span>,<span style=color:#bbb> </span><span style=color:#b44>&#34;-c&#34;</span>,<span style=color:#bbb> </span><span style=color:#b44>&#34;echo &#39;Hello AppArmor!&#39; &amp;&amp; sleep 1h&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb>
</span></span></span></code></pre></div></div></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl create -f ./hello-apparmor.yaml
</span></span></code></pre></div><p>íŒŒë“œ ì´ë²¤íŠ¸ë¥¼ ì‚´í´ë³´ë©´, 'k8s-apparmor-example-deny-write' AppArmor í”„ë¡œíŒŒì¼ë¡œ ìƒì„±ëœ íŒŒë“œ ì»¨í…Œì´ë„ˆë¥¼
í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get events | grep hello-apparmor
</span></span></code></pre></div><pre tabindex=0><code>14s        14s         1         hello-apparmor   Pod                                Normal    Scheduled   {default-scheduler }                           Successfully assigned hello-apparmor to gke-test-default-pool-239f5d02-gyn2
14s        14s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Pulling     {kubelet gke-test-default-pool-239f5d02-gyn2}   pulling image &#34;busybox&#34;
13s        13s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Pulled      {kubelet gke-test-default-pool-239f5d02-gyn2}   Successfully pulled image &#34;busybox&#34;
13s        13s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Created     {kubelet gke-test-default-pool-239f5d02-gyn2}   Created container with docker id 06b6cd1c0989; Security:[seccomp=unconfined apparmor=k8s-apparmor-example-deny-write]
13s        13s         1         hello-apparmor   Pod       spec.containers{hello}   Normal    Started     {kubelet gke-test-default-pool-239f5d02-gyn2}   Started container with docker id 06b6cd1c0989
</code></pre><p>proc attrì„ í™•ì¸í•˜ì—¬ ì»¨í…Œì´ë„ˆê°€ ì‹¤ì œë¡œ í•´ë‹¹ í”„ë¡œíŒŒì¼ë¡œ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> hello-apparmor -- cat /proc/1/attr/current
</span></span></code></pre></div><pre tabindex=0><code>k8s-apparmor-example-deny-write (enforce)
</code></pre><p>ë§ˆì§€ë§‰ìœ¼ë¡œ íŒŒì¼ ì“°ê¸°ë¥¼ í†µí•´ í”„ë¡œíŒŒì¼ì„ ìœ„ë°˜í•˜ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ í™•ì¸í•  ìˆ˜ ìˆë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> hello-apparmor -- touch /tmp/test
</span></span></code></pre></div><pre tabindex=0><code>touch: /tmp/test: Permission denied
error: error executing remote command: command terminated with non-zero exit code: Error executing in Docker Container: 1
</code></pre><p>ì´ì œ ì •ë¦¬í•˜ë©´ì„œ, ì ì¬ë˜ì§€ ì•Šì€ í”„ë¡œíŒŒì¼ì„ ì§€ì •í•˜ë©´ ì–´ë–»ê²Œ ë˜ëŠ”ì§€ ì‚´í´ë³¸ë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl create -f /dev/stdin &lt;&lt;EOF
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>Pod<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>hello-apparmor-2<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>annotations</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>container.apparmor.security.beta.kubernetes.io/hello</span>:<span style=color:#bbb> </span>localhost/k8s-apparmor-example-allow-write<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>spec</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>containers</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>hello<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb> </span>busybox:1.28<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>command</span>:<span style=color:#bbb> </span>[<span style=color:#bbb> </span><span style=color:#b44>&#34;sh&#34;</span>,<span style=color:#bbb> </span><span style=color:#b44>&#34;-c&#34;</span>,<span style=color:#bbb> </span><span style=color:#b44>&#34;echo &#39;Hello AppArmor!&#39; &amp;&amp; sleep 1h&#34;</span><span style=color:#bbb> </span>]<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>EOF<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span>pod/hello-apparmor-2 created<span style=color:#bbb>
</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl describe pod hello-apparmor-2
</span></span></code></pre></div><pre tabindex=0><code>Name:          hello-apparmor-2
Namespace:     default
Node:          gke-test-default-pool-239f5d02-x1kf/
Start Time:    Tue, 30 Aug 2016 17:58:56 -0700
Labels:        &lt;none&gt;
Annotations:   container.apparmor.security.beta.kubernetes.io/hello=localhost/k8s-apparmor-example-allow-write
Status:        Pending
Reason:        AppArmor
Message:       Pod Cannot enforce AppArmor: profile &#34;k8s-apparmor-example-allow-write&#34; is not loaded
IP:
Controllers:   &lt;none&gt;
Containers:
  hello:
    Container ID:
    Image:     busybox
    Image ID:
    Port:
    Command:
      sh
      -c
      echo &#39;Hello AppArmor!&#39; &amp;&amp; sleep 1h
    State:              Waiting
      Reason:           Blocked
    Ready:              False
    Restart Count:      0
    Environment:        &lt;none&gt;
    Mounts:
      /var/run/secrets/kubernetes.io/serviceaccount from default-token-dnz7v (ro)
Conditions:
  Type          Status
  Initialized   True
  Ready         False
  PodScheduled  True
Volumes:
  default-token-dnz7v:
    Type:    Secret (a volume populated by a Secret)
    SecretName:    default-token-dnz7v
    Optional:   false
QoS Class:      BestEffort
Node-Selectors: &lt;none&gt;
Tolerations:    &lt;none&gt;
Events:
  FirstSeen    LastSeen    Count    From                        SubobjectPath    Type        Reason        Message
  ---------    --------    -----    ----                        -------------    --------    ------        -------
  23s          23s         1        {default-scheduler }                         Normal      Scheduled     Successfully assigned hello-apparmor-2 to e2e-test-stclair-minion-group-t1f5
  23s          23s         1        {kubelet e2e-test-stclair-node-pool-t1f5}             Warning        AppArmor    Cannot enforce AppArmor: profile &#34;k8s-apparmor-example-allow-write&#34; is not loaded
</code></pre><p>íŒŒë“œ ìƒíƒœëŠ” Pendingì´ë©°, ì˜¤ë¥˜ ë©”ì‹œì§€ëŠ” <code>Pod Cannot enforce AppArmor: profile "k8s-apparmor-example-allow-write" is not loaded</code>ì´ë‹¤. ì´ë²¤íŠ¸ë„ ë™ì¼í•œ ë©”ì‹œì§€ë¡œ ê¸°ë¡ë˜ì—ˆë‹¤.</p><h2 id=ê´€ë¦¬>ê´€ë¦¬</h2><h3 id=í”„ë¡œíŒŒì¼ê³¼-í•¨ê»˜-ë…¸ë“œ-ì„¤ì •í•˜ê¸°>í”„ë¡œíŒŒì¼ê³¼ í•¨ê»˜ ë…¸ë“œ ì„¤ì •í•˜ê¸°</h3><p>í˜„ì¬ ì¿ ë²„ë„¤í‹°ìŠ¤ëŠ” AppArmor í”„ë¡œíŒŒì¼ì„ ë…¸ë“œì— ì ì¬í•˜ê¸° ìœ„í•œ ë„¤ì´í‹°ë¸Œ ë©”ì»¤ë‹ˆì¦˜ì„ ì œê³µí•˜ì§€ ì•ŠëŠ”ë‹¤.
í”„ë¡œíŒŒì¼ì„ ì„¤ì •í•˜ëŠ” ì—¬ëŸ¬ ë°©ë²•ì´ ìˆë‹¤. ì˜ˆë¥¼ ë“¤ë©´ ë‹¤ìŒê³¼ ê°™ë‹¤.</p><ul><li>ê° ë…¸ë“œì—ì„œ íŒŒë“œë¥¼ ì‹¤í–‰í•˜ëŠ” <a href=/ko/docs/concepts/workloads/controllers/daemonset/>ë°ëª¬ì…‹</a>ì„ í†µí•´ì„œ
ì˜¬ë°”ë¥¸ í”„ë¡œíŒŒì¼ì´ ì ì¬ë˜ì—ˆëŠ”ì§€ í™•ì¸í•œë‹¤. ì˜ˆì‹œ êµ¬í˜„ì€
<a href=https://git.k8s.io/kubernetes/test/images/apparmor-loader>ì—¬ê¸°</a>ì—ì„œ ì°¾ì•„ë³¼ ìˆ˜ ìˆë‹¤.</li><li>ë…¸ë“œ ì´ˆê¸°í™” ì‹œê°„ì— ë…¸ë“œ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸(ì˜ˆë¥¼ ë“¤ì–´ Salt, Ansible ë“±)ë‚˜
ì´ë¯¸ì§€ë¥¼ ì´ìš©</li><li><a href=#example>ì˜ˆì‹œ</a>ì—ì„œ ë³´ì—¬ì¤€ ê²ƒì²˜ëŸ¼,
í”„ë¡œíŒŒì¼ì„ ê° ë…¸ë“œì— ë³µì‚¬í•˜ê³  SSHë¥¼ í†µí•´ ì ì¬í•œë‹¤.</li></ul><p>ìŠ¤ì¼€ì¤„ëŸ¬ëŠ” ì–´ë–¤ í”„ë¡œíŒŒì¼ì´ ì–´ë–¤ ë…¸ë“œì— ì ì¬ë˜ëŠ”ì§€ ê³ ë ¤í•˜ì§€ ì•Šìœ¼ë‹ˆ, í”„ë¡œíŒŒì¼ ì „ì²´ ì§‘í•©ì´
ëª¨ë“  ë…¸ë“œì— ì ì¬ë˜ì–´ì•¼ í•œë‹¤. ëŒ€ì•ˆì ì¸ ë°©ë²•ì€
ê° í”„ë¡œíŒŒì¼(í˜¹ì€ í”„ë¡œíŒŒì¼ì˜ í´ë˜ìŠ¤)ì„ ìœ„í•œ ë…¸ë“œ ë ˆì´ë¸”ì„ ë…¸ë“œì— ì¶”ê°€í•˜ê³ ,
<a href=/ko/docs/concepts/scheduling-eviction/assign-pod-node/>ë…¸ë“œ ì…€ë ‰í„°</a>ë¥¼ ì´ìš©í•˜ì—¬
íŒŒë“œê°€ í•„ìš”í•œ í”„ë¡œíŒŒì¼ì´ ìˆëŠ” ë…¸ë“œì—ì„œ ì‹¤í–‰ë˜ë„ë¡ í•œë‹¤.</p><h3 id=apparmor-ë¹„í™œì„±í™”>AppArmor ë¹„í™œì„±í™”</h3><p>í´ëŸ¬ìŠ¤í„°ì—ì„œ AppArmorë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šìœ¼ë ¤ë©´, ì»¤ë§¨ë“œë¼ì¸ í”Œë˜ê·¸ë¡œ ë¹„í™œì„±í™” í•  ìˆ˜ ìˆë‹¤.</p><pre tabindex=0><code>--feature-gates=AppArmor=false
</code></pre><p>ë¹„í™œì„±í™”ë˜ë©´, AppArmor í”„ë¡œíŒŒì¼ì„ í¬í•¨í•œ íŒŒë“œëŠ”
"Forbidden" ì˜¤ë¥˜ë¡œ ê²€ì¦ ì‹¤íŒ¨í•œë‹¤.</p><div class="alert alert-info note callout" role=alert><strong>ì°¸ê³ :</strong> ì¿ ë²„ë„¤í‹°ìŠ¤ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì–´ ìˆì–´ë„, ëŸ°íƒ€ì„ì´ ê³„ì† ê¸°ë³¸ í”„ë¡œíŒŒì¼ì„ ê°•ì œí•  ìˆ˜ë„ ìˆë‹¤.
AppArmorê°€ general availability (GA) ìƒíƒœë¡œ ë°”ë€Œë©´
AppArmor ê¸°ëŠ¥ì„ ë¹„í™œì„±í™”í•˜ëŠ” ì˜µì…˜ì€ ì œê±°ë  ê²ƒì´ë‹¤.</div><h2 id=í”„ë¡œíŒŒì¼-ì œì‘>í”„ë¡œíŒŒì¼ ì œì‘</h2><p>AppArmor í”„ë¡œíŒŒì¼ì„ ë§Œë“¤ê³  ì˜¬ë°”ë¥´ê²Œ ì§€ì •í•˜ëŠ” ê²ƒì€ ë§¤ìš° ê¹Œë‹¤ë¡œìš¸ ìˆ˜ ìˆë‹¤.
ë‹¤í–‰íˆ ì´ ì‘ì—…ì— ë„ì›€ ë˜ëŠ” ë„êµ¬ê°€ ìˆë‹¤.</p><ul><li><code>aa-genprof</code>ì™€ <code>aa-logprof</code>ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ í™œë™ê³¼ ë¡œê·¸ì™€ ìˆ˜í–‰ì— í•„ìš”í•œ í–‰ë™ì„ ëª¨ë‹ˆí„°ë§í•˜ì—¬
ì¼ë°˜ í”„ë¡œíŒŒì¼ ê·œì¹™ì„ ìƒì„±í•œë‹¤. ìì„¸í•œ ì‚¬ìš©ë°©ë²•ì€
<a href=https://gitlab.com/apparmor/apparmor/wikis/Profiling_with_tools>AppArmor ë¬¸ì„œ</a>ì—ì„œ ì œê³µí•œë‹¤.</li><li><a href=https://github.com/jfrazelle/bane>bane</a>ì€ ë‹¨ìˆœí™”ëœ í”„ë¡œíŒŒì¼ ì–¸ì–´ë¥¼ ì´ìš©í•˜ëŠ” ë„ì»¤ë¥¼ ìœ„í•œ
AppArmor í”„ë¡œíŒŒì¼ ìƒì„±ê¸°ì´ë‹¤.</li></ul><p>AppArmor ë¬¸ì œë¥¼ ë””ë²„ê¹…í•˜ê¸° ìœ„í•´ì„œ ê±°ë¶€ëœ ê²ƒìœ¼ë¡œ ë³´ì´ëŠ” ì‹œìŠ¤í…œ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
AppArmor ë¡œê·¸ëŠ” <code>dmesg</code>ì—ì„œ ë³´ì´ë©°, ì˜¤ë¥˜ëŠ” ë³´í†µ ì‹œìŠ¤í…œ ë¡œê·¸ë‚˜
<code>journalctl</code>ì—ì„œ ë³¼ ìˆ˜ ìˆë‹¤. ë” ë§ì€ ì •ë³´ëŠ”
<a href=https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Failures>AppArmor ì‹¤íŒ¨</a>ì—ì„œ ì œê³µí•œë‹¤.</p><h2 id=api-ì°¸ì¡°>API ì°¸ì¡°</h2><h3 id=íŒŒë“œ-ì–´ë…¸í…Œì´ì…˜>íŒŒë“œ ì–´ë…¸í…Œì´ì…˜</h3><p>ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•  í”„ë¡œíŒŒì¼ì„ ì§€ì •í•œë‹¤.</p><ul><li><strong>í‚¤</strong>: <code>container.apparmor.security.beta.kubernetes.io/&lt;container_name></code>
<code>&lt;container_name></code>ëŠ” íŒŒë“œ ë‚´ì— ì»¨í…Œì´ë„ˆ ì´ë¦„ê³¼ ì¼ì¹˜í•œë‹¤.
ë¶„ë¦¬ëœ í”„ë¡œíŒŒì¼ì€ íŒŒë“œ ë‚´ì— ê° ì»¨í…Œì´ë„ˆë¡œ ì§€ì •í•  ìˆ˜ ìˆë‹¤.</li><li><strong>ê°’</strong>: ì•„ë˜ ê¸°ìˆ ëœ í”„ë¡œíŒŒì¼ ì°¸ì¡°</li></ul><h3 id=í”„ë¡œíŒŒì¼-ì°¸ì¡°>í”„ë¡œíŒŒì¼ ì°¸ì¡°</h3><ul><li><code>runtime/default</code>: ê¸°ë³¸ ëŸ°íƒ€ì„ í”„ë¡œíŒŒì¼ì„ ì°¸ì¡°í•œë‹¤.<ul><li>(ê¸°ë³¸ íŒŒë“œì‹œíë¦¬í‹°í´ë¦¬ì‹œ ì—†ì´) í”„ë¡œíŒŒì¼ì„ ì§€ì •í•˜ì§€ ì•Šê³ 
AppArmorë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒê³¼ ë™ë“±í•˜ë‹¤.</li><li>ì‹¤ì œë¡œëŠ”, ë§ì€ ì»¨í…Œì´ë„ˆ ëŸ°íƒ€ì„ì€ ë™ì¼í•œ OCI ê¸°ë³¸ í”„ë¡œíŒŒì¼ì„ ì‚¬ìš©í•˜ë©°, ì´ëŠ”
<a href=https://github.com/containers/common/blob/main/pkg/apparmor/apparmor_linux_template.go>https://github.com/containers/common/blob/main/pkg/apparmor/apparmor_linux_template.go</a> ì— ì •ì˜ë˜ì–´ ìˆë‹¤.</li></ul></li><li><code>localhost/&lt;profile_name></code>: ë…¸ë“œ(localhost)ì— ì ì¬ëœ í”„ë¡œíŒŒì¼ì„ ì´ë¦„ìœ¼ë¡œ ì°¸ì¡°í•œë‹¤.<ul><li>ê°€ìš©í•œ í”„ë¡œíŒŒì¼ ì´ë¦„ì˜ ìƒì„¸ ë‚´ìš©ì€
<a href=https://gitlab.com/apparmor/apparmor/wikis/AppArmor_Core_Policy_Reference#profile-names-and-attachment-specifications>í•µì‹¬ ì •ì±… ì°¸ì¡°</a>ì— ì„¤ëª…ë˜ì–´ ìˆë‹¤.</li></ul></li><li><code>unconfined</code>: ì´ê²ƒì€ ì»¨í…Œì´ë„ˆì—ì„œ AppArmorë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ë¹„í™œì„±ì‹œí‚¨ë‹¤.</li></ul><p>ë‹¤ë¥¸ ì–´ë–¤ í”„ë¡œíŒŒì¼ ì°¸ì¡° í˜•ì‹ë„ ìœ íš¨í•˜ì§€ ì•Šë‹¤.</p><h2 id=ë‹¤ìŒ-ë‚´ìš©>ë‹¤ìŒ ë‚´ìš©</h2><p>ì°¸ê³  ìë£Œ</p><ul><li><a href=https://gitlab.com/apparmor/apparmor/wikis/QuickProfileLanguage>í€µ ê°€ì´ë“œ AppArmor í”„ë¡œíŒŒì¼ ì–¸ì–´</a></li><li><a href=https://gitlab.com/apparmor/apparmor/wikis/Policy_Layout>AppArmor ì½”ì–´ ì •ì±… ì°¸ê³ </a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-31a6c137cfc5bfea9d88f4b109109465>2 - íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</h1><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>ì´ íŠœí† ë¦¬ì–¼ì€ ìƒˆë¡œìš´ í´ëŸ¬ìŠ¤í„°ì—ë§Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.</div><p>íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜(PSA, Pod Security Admission)ì€
<a href=/blog/2021/12/09/pod-security-admission-beta/>ë² íƒ€ë¡œ ë³€ê²½</a>ë˜ì–´ v1.23 ì´ìƒì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆë‹¤.
íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜ì€ íŒŒë“œê°€ ìƒì„±ë  ë•Œ
<a href=/ko/docs/concepts/security/pod-security-standards/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ(Pod Security Standards)</a>ë¥¼ ì ìš©í•˜ëŠ” ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ì´ë‹¤.
ì´ íŠœí† ë¦¬ì–¼ì—ì„œëŠ”,
ê° ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë³„ë¡œ <code>baseline</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ê°•ì œ(enforce)í•  ê²ƒì´ë‹¤.</p><p>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ì—ì„œ ì—¬ëŸ¬ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— í•œ ë²ˆì— ì ìš©í•  ìˆ˜ë„ ìˆë‹¤.
ì´ì— ëŒ€í•œ ì•ˆë‚´ëŠ”
<a href=/ko/docs/tutorials/security/cluster-level-pss/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</a>ë¥¼ ì°¸ê³ í•œë‹¤.</p><h2 id=ì‹œì‘í•˜ê¸°-ì „ì—>ì‹œì‘í•˜ê¸° ì „ì—</h2><p>ì›Œí¬ìŠ¤í…Œì´ì…˜ì— ë‹¤ìŒì„ ì„¤ì¹˜í•œë‹¤.</p><ul><li><a href=https://kind.sigs.k8s.io/docs/user/quick-start/#installation>KinD</a></li><li><a href=/ko/docs/tasks/tools/>kubectl</a></li></ul><h2 id=í´ëŸ¬ìŠ¤í„°-ìƒì„±í•˜ê¸°>í´ëŸ¬ìŠ¤í„° ìƒì„±í•˜ê¸°</h2><ol><li><p>ë‹¤ìŒê³¼ ê°™ì´ <code>KinD</code> í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kind create cluster --name psa-ns-level --image kindest/node:v1.23.0
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>Creating cluster &#34;psa-ns-level&#34; ...
 âœ“ Ensuring node image (kindest/node:v1.23.0) ğŸ–¼ 
 âœ“ Preparing nodes ğŸ“¦  
 âœ“ Writing configuration ğŸ“œ 
 âœ“ Starting control-plane ğŸ•¹ï¸ 
 âœ“ Installing CNI ğŸ”Œ 
 âœ“ Installing StorageClass ğŸ’¾ 
Set kubectl context to &#34;kind-psa-ns-level&#34;
You can now use your cluster with:

kubectl cluster-info --context kind-psa-ns-level

Not sure what to do next? ğŸ˜…  Check out https://kind.sigs.k8s.io/docs/user/quick-start/
</code></pre></li><li><p>kubectl contextë¥¼ ìƒˆë¡œ ìƒì„±í•œ í´ëŸ¬ìŠ¤í„°ë¡œ ì„¤ì •í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl cluster-info --context kind-psa-ns-level
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>Kubernetes control plane is running at https://127.0.0.1:50996
CoreDNS is running at https://127.0.0.1:50996/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.
</code></pre></li></ol><h2 id=ë„¤ì„ìŠ¤í˜ì´ìŠ¤-ìƒì„±í•˜ê¸°>ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìƒì„±í•˜ê¸°</h2><p><code>example</code>ì´ë¼ëŠ” ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl create ns example
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>namespace/example created
</code></pre><h2 id=íŒŒë“œ-ì‹œíë¦¬í‹°-ìŠ¤íƒ ë‹¤ë“œ-ì ìš©í•˜ê¸°>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ ì ìš©í•˜ê¸°</h2><ol><li><p>ë‚´ì¥ íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜ì´ ì§€ì›í•˜ëŠ” ë ˆì´ë¸”ì„ ì‚¬ìš©í•˜ì—¬
ì´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í™œì„±í™”í•œë‹¤.
ì´ ë‹¨ê³„ì—ì„œëŠ” <code>latest</code> ë²„ì „(ê¸°ë³¸ê°’)ì— ë”°ë¼ <code>baseline(ê¸°ì¤€)</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œì— ëŒ€í•´ ê²½ê³ ë¥¼ ì„¤ì •í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl label --overwrite ns example <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>   pod-security.kubernetes.io/warn<span style=color:#666>=</span>baseline <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>   pod-security.kubernetes.io/warn-version<span style=color:#666>=</span>latest
</span></span></code></pre></div></li><li><p>ì–´ë– í•œ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ë„ ë³µìˆ˜ ê°œì˜ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í™œì„±í™”í•  ìˆ˜ ìˆìœ¼ë©°,
ì´ëŠ” ë ˆì´ë¸”ì„ ì´ìš©í•˜ì—¬ ê°€ëŠ¥í•˜ë‹¤.
ë‹¤ìŒ ëª…ë ¹ì–´ëŠ” ìµœì‹  ë²„ì „(ê¸°ë³¸ê°’)ì— ë”°ë¼, <code>baseline(ê¸°ì¤€)</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ” <code>enforce(ê°•ì œ)</code>í•˜ì§€ë§Œ
<code>restricted(ì œí•œëœ)</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œì— ëŒ€í•´ì„œëŠ” <code>warn(ê²½ê³ )</code> ë° <code>audit(ê°ì‚¬)</code>í•˜ë„ë¡ ì„¤ì •í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl label --overwrite ns example <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  pod-security.kubernetes.io/enforce<span style=color:#666>=</span>baseline <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  pod-security.kubernetes.io/enforce-version<span style=color:#666>=</span>latest <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  pod-security.kubernetes.io/warn<span style=color:#666>=</span>restricted <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  pod-security.kubernetes.io/warn-version<span style=color:#666>=</span>latest <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  pod-security.kubernetes.io/audit<span style=color:#666>=</span>restricted <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  pod-security.kubernetes.io/audit-version<span style=color:#666>=</span>latest
</span></span></code></pre></div></li></ol><h2 id=íŒŒë“œ-ì‹œíë¦¬í‹°-ìŠ¤íƒ ë‹¤ë“œ-ê²€ì¦í•˜ê¸°>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ ê²€ì¦í•˜ê¸°</h2><ol><li><p><code>example</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìµœì†Œí•œì˜ íŒŒë“œë¥¼ ìƒì„±í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF &gt; /tmp/pss/nginx-pod.yaml
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: nginx
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - image: nginx
</span></span></span><span style=display:flex><span><span style=color:#b44>      name: nginx
</span></span></span><span style=display:flex><span><span style=color:#b44>      ports:
</span></span></span><span style=display:flex><span><span style=color:#b44>        - containerPort: 80
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span></code></pre></div></li><li><p>í´ëŸ¬ìŠ¤í„°ì˜ <code>example</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— í•´ë‹¹ íŒŒë“œ ìŠ¤í™ì„ ì ìš©í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl apply -n example -f /tmp/pss/nginx-pod.yaml
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>Warning: would violate PodSecurity &#34;restricted:latest&#34;: allowPrivilegeEscalation != false (container &#34;nginx&#34; must set securityContext.allowPrivilegeEscalation=false), unrestricted capabilities (container &#34;nginx&#34; must set securityContext.capabilities.drop=[&#34;ALL&#34;]), runAsNonRoot != true (pod or container &#34;nginx&#34; must set securityContext.runAsNonRoot=true), seccompProfile (pod or container &#34;nginx&#34; must set securityContext.seccompProfile.type to &#34;RuntimeDefault&#34; or &#34;Localhost&#34;)
pod/nginx created
</code></pre></li><li><p>í´ëŸ¬ìŠ¤í„°ì˜ <code>default</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— í•´ë‹¹ íŒŒë“œ ìŠ¤í™ì„ ì ìš©í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl apply -n default -f /tmp/pss/nginx-pod.yaml
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>pod/nginx created
</code></pre></li></ol><p>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ” <code>example</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ë§Œ ì ìš©ë˜ì—ˆë‹¤.
ë™ì¼í•œ íŒŒë“œë¥¼ <code>default</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìƒì„±í•˜ë”ë¼ë„
ê²½ê³ ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤.</p><h2 id=ì •ë¦¬í•˜ê¸°>ì •ë¦¬í•˜ê¸°</h2><p><code>kind delete cluster -name psa-ns-level</code> ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬ ìƒì„±í–ˆë˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•œë‹¤.</p><h2 id=ë‹¤ìŒ-ë‚´ìš©>ë‹¤ìŒ ë‚´ìš©</h2><ul><li><p>ë‹¤ìŒì˜ ëª¨ë“  ë‹¨ê³„ë¥¼ í•œ ë²ˆì— ìˆ˜í–‰í•˜ë ¤ë©´
<a href=/examples/security/kind-with-namespace-level-baseline-pod-security.sh>ì…¸ ìŠ¤í¬ë¦½íŠ¸</a>ë¥¼
ì‹¤í–‰í•œë‹¤.</p><ol><li>KinD í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±</li><li>ìƒˆë¡œìš´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ìƒì„±</li><li><code>baseline</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ” <code>enforce</code> ëª¨ë“œë¡œ ì ìš©í•˜ê³ 
<code>restricted</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ” <code>warn</code> ë° <code>audit</code> ëª¨ë“œë¡œ ì ìš©</li><li>í•´ë‹¹ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œê°€ ì ìš©ëœ ìƒíƒœì—ì„œ ìƒˆë¡œìš´ íŒŒë“œë¥¼ ìƒì„±</li></ol></li><li><p><a href=/docs/concepts/security/pod-security-admission/>íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜</a></p></li><li><p><a href=/ko/docs/concepts/security/pod-security-standards/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ</a></p></li><li><p><a href=/ko/docs/tutorials/security/cluster-level-pss/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</a></p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d5f847bcdb6f7efbfc9c8a180d73e29a>3 - íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</h1><div class="alert alert-primary" role=alert><h4 class=alert-heading>Note</h4>ì´ íŠœí† ë¦¬ì–¼ì€ ìƒˆë¡œìš´ í´ëŸ¬ìŠ¤í„°ì—ë§Œ ì ìš©í•  ìˆ˜ ìˆë‹¤.</div><p>íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜(PSA, Pod Security Admission)ì€
<a href=/blog/2021/12/09/pod-security-admission-beta/>ë² íƒ€ë¡œ ë³€ê²½</a>ë˜ì–´ v1.23 ì´ìƒì—ì„œ ê¸°ë³¸ì ìœ¼ë¡œ í™œì„±í™”ë˜ì–´ ìˆë‹¤.
íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜ì€ íŒŒë“œê°€ ìƒì„±ë  ë•Œ
<a href=/ko/docs/concepts/security/pod-security-standards/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ(Pod Security Standards)</a>ë¥¼
ì ìš©í•˜ëŠ” ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ì´ë‹¤.
ì´ íŠœí† ë¦¬ì–¼ì€
<code>baseline</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€(level)ì— ì ìš©í•˜ì—¬
í‘œì¤€ êµ¬ì„±ì„ í´ëŸ¬ìŠ¤í„°ì˜ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì ìš©í•˜ëŠ” ë°©ë²•ì„ ë³´ì—¬ ì¤€ë‹¤.</p><p>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ íŠ¹ì • ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ì ìš©í•˜ë ¤ë©´,
<a href=/ko/docs/tutorials/security/ns-level-pss/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</a>ë¥¼ ì°¸ê³ í•œë‹¤.</p><p>ë§Œì•½ ì¿ ë²„ë„¤í‹°ìŠ¤ ë²„ì „ì´ v1.25ì´ ì•„ë‹ˆë¼ë©´,
í•´ë‹¹ ë²„ì „ì˜ ë¬¸ì„œë¥¼ í™•ì¸í•˜ì.</p><h2 id=ì‹œì‘í•˜ê¸°-ì „ì—>ì‹œì‘í•˜ê¸° ì „ì—</h2><p>ì›Œí¬ìŠ¤í…Œì´ì…˜ì— ë‹¤ìŒì„ ì„¤ì¹˜í•œë‹¤.</p><ul><li><a href=https://kind.sigs.k8s.io/docs/user/quick-start/#installation>KinD</a></li><li><a href=/ko/docs/tasks/tools/>kubectl</a></li></ul><h2 id=ì ìš©í• -ì•Œë§ì€-íŒŒë“œ-ì‹œíë¦¬í‹°-ìŠ¤íƒ ë‹¤ë“œ-ì„ íƒí•˜ê¸°>ì ìš©í•  ì•Œë§ì€ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ ì„ íƒí•˜ê¸°</h2><p><a href=/docs/concepts/security/pod-security-admission/>íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜</a>ì„ ì´ìš©í•˜ì—¬
<code>enforce</code>, <code>audit</code>, ë˜ëŠ” <code>warn</code> ëª¨ë“œ ì¤‘ í•˜ë‚˜ë¡œ
ë‚´ì¥ <a href=/ko/docs/concepts/security/pod-security-standards/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ</a>ë¥¼ ì ìš©í•  ìˆ˜ ìˆë‹¤.</p><p>í˜„ì¬ êµ¬ì„±ì— ê°€ì¥ ì í•©í•œ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ê³ ë¥´ëŠ” ë°
ë„ì›€ì´ ë˜ëŠ” ì •ë³´ë¥¼ ìˆ˜ì§‘í•˜ë ¤ë©´, ë‹¤ìŒì„ ìˆ˜í–‰í•œë‹¤.</p><ol><li><p>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œê°€ ì ìš©ë˜ì§€ ì•Šì€ í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kind create cluster --name psa-wo-cluster-pss --image kindest/node:v1.24.0
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>Creating cluster &#34;psa-wo-cluster-pss&#34; ...
âœ“ Ensuring node image (kindest/node:v1.24.0) ğŸ–¼
âœ“ Preparing nodes ğŸ“¦  
âœ“ Writing configuration ğŸ“œ
âœ“ Starting control-plane ğŸ•¹ï¸
âœ“ Installing CNI ğŸ”Œ
âœ“ Installing StorageClass ğŸ’¾
Set kubectl context to &#34;kind-psa-wo-cluster-pss&#34;
You can now use your cluster with:

kubectl cluster-info --context kind-psa-wo-cluster-pss

Thanks for using kind! ğŸ˜Š
</code></pre></li><li><p>kubectl contextë¥¼ ìƒˆë¡œ ìƒì„±í•œ í´ëŸ¬ìŠ¤í„°ë¡œ ì„¤ì •í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl cluster-info --context kind-psa-wo-cluster-pss
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code> Kubernetes control plane is running at https://127.0.0.1:61350

CoreDNS is running at https://127.0.0.1:61350/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.
</code></pre></li><li><p>í´ëŸ¬ìŠ¤í„°ì˜ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ëª©ë¡ì„ ì¡°íšŒí•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get ns
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>NAME                 STATUS   AGE
default              Active   9m30s
kube-node-lease      Active   9m32s
kube-public          Active   9m32s
kube-system          Active   9m32s
local-path-storage   Active   9m26s
</code></pre></li><li><p><code>--dry-run=server</code>ë¥¼ ì‚¬ìš©í•˜ì—¬ ë‹¤ë¥¸ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œê°€ ì ìš©ë˜ì—ˆì„ ë•Œ
ì–´ë–¤ ê²ƒì´ ë³€ê²½ë˜ëŠ”ì§€ í™•ì¸í•œë‹¤.</p><ol><li>Privileged<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl label --dry-run<span style=color:#666>=</span>server --overwrite ns --all <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>pod-security.kubernetes.io/enforce<span style=color:#666>=</span>privileged
</span></span></code></pre></div></li></ol><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>namespace/default labeled
namespace/kube-node-lease labeled
namespace/kube-public labeled
namespace/kube-system labeled
namespace/local-path-storage labeled
</code></pre><ol start=2><li>Baseline<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl label --dry-run<span style=color:#666>=</span>server --overwrite ns --all <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>pod-security.kubernetes.io/enforce<span style=color:#666>=</span>baseline
</span></span></code></pre></div></li></ol><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>namespace/default labeled
namespace/kube-node-lease labeled
namespace/kube-public labeled
Warning: existing pods in namespace &#34;kube-system&#34; violate the new PodSecurity enforce level &#34;baseline:latest&#34;
Warning: etcd-psa-wo-cluster-pss-control-plane (and 3 other pods): host namespaces, hostPath volumes
Warning: kindnet-vzj42: non-default capabilities, host namespaces, hostPath volumes
Warning: kube-proxy-m6hwf: host namespaces, hostPath volumes, privileged
namespace/kube-system labeled
namespace/local-path-storage labeled
</code></pre><ol start=3><li>Restricted</li></ol><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span> kubectl label --dry-run<span style=color:#666>=</span>server --overwrite ns --all <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span> pod-security.kubernetes.io/enforce<span style=color:#666>=</span>restricted
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code>namespace/default labeled
namespace/kube-node-lease labeled
namespace/kube-public labeled
Warning: existing pods in namespace &#34;kube-system&#34; violate the new PodSecurity enforce level &#34;restricted:latest&#34;
Warning: coredns-7bb9c7b568-hsptc (and 1 other pod): unrestricted capabilities, runAsNonRoot != true, seccompProfile
Warning: etcd-psa-wo-cluster-pss-control-plane (and 3 other pods): host namespaces, hostPath volumes, allowPrivilegeEscalation != false, unrestricted capabilities, restricted volume types, runAsNonRoot != true
Warning: kindnet-vzj42: non-default capabilities, host namespaces, hostPath volumes, allowPrivilegeEscalation != false, unrestricted capabilities, restricted volume types, runAsNonRoot != true, seccompProfile
Warning: kube-proxy-m6hwf: host namespaces, hostPath volumes, privileged, allowPrivilegeEscalation != false, unrestricted capabilities, restricted volume types, runAsNonRoot != true, seccompProfile
namespace/kube-system labeled
Warning: existing pods in namespace &#34;local-path-storage&#34; violate the new PodSecurity enforce level &#34;restricted:latest&#34;
Warning: local-path-provisioner-d6d9f7ffc-lw9lh: allowPrivilegeEscalation != false, unrestricted capabilities, runAsNonRoot != true, seccompProfile
namespace/local-path-storage labeled
</code></pre></li></ol><p>ìœ„ì˜ ì¶œë ¥ì—ì„œ, <code>privileged</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ì ìš©í•˜ë©´ ëª¨ë“  ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ ê²½ê³ ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.
ê·¸ëŸ¬ë‚˜ <code>baseline</code> ë° <code>restricted</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œì— ëŒ€í•´ì„œëŠ”
<code>kube-system</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì—ì„œ ê²½ê³ ê°€ ë°œìƒí•œë‹¤.</p><h2 id=ëª¨ë“œ-ë²„ì „-ë°-íŒŒë“œ-ì‹œíë¦¬í‹°-ìŠ¤íƒ ë‹¤ë“œ-ì„¤ì •>ëª¨ë“œ, ë²„ì „, ë° íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ ì„¤ì •</h2><p>ì´ ì„¹ì…˜ì—ì„œëŠ”, ë‹¤ìŒì˜ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ <code>latest</code> ë²„ì „ì— ì ìš©í•œë‹¤.</p><ul><li><code>baseline</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ” <code>enforce</code> ëª¨ë“œë¡œ ì ìš©</li><li><code>restricted</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ” <code>warn</code> ë° <code>audit</code> ëª¨ë“œë¡œ ì ìš©</li></ul><p><code>baseline</code> íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œëŠ”
ì˜ˆì™¸ ëª©ë¡ì„ ê°„ê²°í•˜ê²Œ ìœ ì§€í•˜ê³  ì•Œë ¤ì§„ ê¶Œí•œ ìƒìŠ¹(privilege escalations)ì„ ë°©ì§€í•  ìˆ˜ ìˆëŠ”
í¸ë¦¬í•œ ì ˆì¶©ì•ˆì„ ì œê³µí•œë‹¤.</p><p>ì¶”ê°€ì ìœ¼ë¡œ, <code>kube-system</code> ë‚´ì˜ íŒŒë“œê°€ ì‹¤íŒ¨í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´,
í•´ë‹¹ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ëŠ” íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œê°€ ì ìš©ë˜ì§€ ì•Šë„ë¡ ì œì™¸í•  ê²ƒì´ë‹¤.</p><p>ì‚¬ìš© ì¤‘ì¸ í™˜ê²½ì— íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜ì„ ì ìš©í•  ë•Œì—ëŠ”
ë‹¤ìŒì˜ ì‚¬í•­ì„ ê³ ë ¤í•œë‹¤.</p><ol><li><p>í´ëŸ¬ìŠ¤í„°ì— ì ìš©ëœ ìœ„í—˜ ìƒíƒœì— ë”°ë¼,
<code>restricted</code>ì™€ ê°™ì€ ë” ì—„ê²©í•œ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œê°€ ë” ì¢‹ì„ ìˆ˜ë„ ìˆë‹¤.</p></li><li><p><code>kube-system</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¥¼ ì ìš© ëŒ€ìƒì—ì„œ ì œì™¸í•˜ë©´
ì´ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì˜ íŒŒë“œê°€ <code>privileged</code>ë¡œ ì‹¤í–‰ë  ìˆ˜ ìˆë‹¤.
ì‹¤ì œ ì‚¬ìš© í™˜ê²½ì—ì„œëŠ”,
ìµœì†Œ ê¶Œí•œ ì›ì¹™ì„ ì¤€ìˆ˜í•˜ë„ë¡,
ì ‘ê·¼ì„ <code>kube-system</code> ë„¤ì„ìŠ¤í˜ì´ìŠ¤ë¡œ ì œí•œí•˜ëŠ”
ì—„ê²©í•œ RBAC ì •ì±…ì„ ì ìš©í•  ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•œë‹¤.</p></li><li><p>íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì´ëŸ¬í•œ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ êµ¬í˜„í•˜ëŠ” ë° ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”
êµ¬ì„± íŒŒì¼ì„ ìƒì„±í•œë‹¤.</p><pre tabindex=0><code>mkdir -p /tmp/pss
cat &lt;&lt;EOF &gt; /tmp/pss/cluster-level-pss.yaml 
apiVersion: apiserver.config.k8s.io/v1
kind: AdmissionConfiguration
plugins:
- name: PodSecurity
  configuration:
    apiVersion: pod-security.admission.config.k8s.io/v1beta1
    kind: PodSecurityConfiguration
    defaults:
      enforce: &#34;baseline&#34;
      enforce-version: &#34;latest&#34;
      audit: &#34;restricted&#34;
      audit-version: &#34;latest&#34;
      warn: &#34;restricted&#34;
      warn-version: &#34;latest&#34;
    exemptions:
      usernames: []
      runtimeClasses: []
      namespaces: [kube-system]
EOF
</code></pre></li><li><p>API ì„œë²„ê°€ í´ëŸ¬ìŠ¤í„° ìƒì„± ê³¼ì •ì—ì„œ ì´ íŒŒì¼ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆë„ë¡ êµ¬ì„±í•œë‹¤.</p><pre tabindex=0><code>cat &lt;&lt;EOF &gt; /tmp/pss/cluster-config.yaml 
kind: Cluster
apiVersion: kind.x-k8s.io/v1alpha4
nodes:
- role: control-plane
  kubeadmConfigPatches:
  - |
    kind: ClusterConfiguration
    apiServer:
        extraArgs:
          admission-control-config-file: /etc/config/cluster-level-pss.yaml
        extraVolumes:
          - name: accf
            hostPath: /etc/config
            mountPath: /etc/config
            readOnly: false
            pathType: &#34;DirectoryOrCreate&#34;
  extraMounts:
  - hostPath: /tmp/pss
    containerPath: /etc/config
    # optional: if set, the mount is read-only.
    # default false
    readOnly: false
    # optional: if set, the mount needs SELinux relabeling.
    # default false
    selinuxRelabel: false
    # optional: set propagation mode (None, HostToContainer or Bidirectional)
    # see https://kubernetes.io/ko/docs/concepts/storage/volumes/#ë§ˆìš´íŠ¸-ì „íŒŒ-propagation
    # default None
    propagation: None
EOF
</code></pre><div class="alert alert-info note callout" role=alert><strong>ì°¸ê³ :</strong> macOSì—ì„œ Docker Desktopê³¼ KinDë¥¼ ì‚¬ìš©í•˜ê³  ìˆë‹¤ë©´,
<strong>Preferences > Resources > File Sharing</strong> ë©”ë‰´ì—ì„œ
<code>/tmp</code>ë¥¼ Shared Directoryë¡œ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.</div></li><li><p>ì´ëŸ¬í•œ íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ì ìš©í•˜ê¸° ìœ„í•´
íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜ì„ ì‚¬ìš©í•˜ëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span> kind create cluster --name psa-with-cluster-pss --image kindest/node:v1.24.0 --config /tmp/pss/cluster-config.yaml
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code> Creating cluster &#34;psa-with-cluster-pss&#34; ...
  âœ“ Ensuring node image (kindest/node:v1.24.0) ğŸ–¼ 
  âœ“ Preparing nodes ğŸ“¦  
  âœ“ Writing configuration ğŸ“œ 
  âœ“ Starting control-plane ğŸ•¹ï¸ 
  âœ“ Installing CNI ğŸ”Œ 
  âœ“ Installing StorageClass ğŸ’¾ 
 Set kubectl context to &#34;kind-psa-with-cluster-pss&#34;
 You can now use your cluster with:

 kubectl cluster-info --context kind-psa-with-cluster-pss

 Have a question, bug, or feature request? Let us know! https://kind.sigs.k8s.io/#community ğŸ™‚
</code></pre></li><li><p>kubectl contextë¥¼ ìƒˆë¡œ ìƒì„±í•œ í´ëŸ¬ìŠ¤í„°ë¡œ ì„¤ì •í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span> kubectl cluster-info --context kind-psa-with-cluster-pss
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code> Kubernetes control plane is running at https://127.0.0.1:63855
 CoreDNS is running at https://127.0.0.1:63855/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy

 To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.
</code></pre></li><li><p>ê¸°ë³¸ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ì— ìƒì„±í•  ìµœì†Œí•œì˜ êµ¬ì„±ì— ëŒ€í•œ íŒŒë“œ ëª…ì„¸ë¥¼ ë‹¤ìŒê³¼ ê°™ì´ ìƒì„±í•œë‹¤.</p><pre tabindex=0><code>cat &lt;&lt;EOF &gt; /tmp/pss/nginx-pod.yaml
apiVersion: v1
kind: Pod
metadata:
  name: nginx
spec:
  containers:
    - image: nginx
      name: nginx
      ports:
        - containerPort: 80
EOF
</code></pre></li><li><p>í´ëŸ¬ìŠ¤í„°ì— í•´ë‹¹ íŒŒë“œë¥¼ ìƒì„±í•œë‹¤.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span> kubectl apply -f /tmp/pss/nginx-pod.yaml
</span></span></code></pre></div><p>ë‹¤ìŒê³¼ ë¹„ìŠ·í•˜ê²Œ ì¶œë ¥ë  ê²ƒì´ë‹¤.</p><pre tabindex=0><code> Warning: would violate PodSecurity &#34;restricted:latest&#34;: allowPrivilegeEscalation != false (container &#34;nginx&#34; must set securityContext.allowPrivilegeEscalation=false), unrestricted capabilities (container &#34;nginx&#34; must set securityContext.capabilities.drop=[&#34;ALL&#34;]), runAsNonRoot != true (pod or container &#34;nginx&#34; must set securityContext.runAsNonRoot=true), seccompProfile (pod or container &#34;nginx&#34; must set securityContext.seccompProfile.type to &#34;RuntimeDefault&#34; or &#34;Localhost&#34;)
 pod/nginx created
</code></pre></li></ol><h2 id=ì •ë¦¬í•˜ê¸°>ì •ë¦¬í•˜ê¸°</h2><p><code>kind delete cluster --name psa-with-cluster-pss</code> ë°
<code>kind delete cluster --name psa-wo-cluster-pss</code> ëª…ë ¹ì„ ì‹¤í–‰í•˜ì—¬
ìƒì„±í–ˆë˜ í´ëŸ¬ìŠ¤í„°ë¥¼ ì‚­ì œí•œë‹¤.</p><h2 id=ë‹¤ìŒ-ë‚´ìš©>ë‹¤ìŒ ë‚´ìš©</h2><ul><li>ë‹¤ìŒì˜ ëª¨ë“  ë‹¨ê³„ë¥¼ í•œ ë²ˆì— ìˆ˜í–‰í•˜ë ¤ë©´
<a href=/examples/security/kind-with-cluster-level-baseline-pod-security.sh>ì…¸ ìŠ¤í¬ë¦½íŠ¸</a>ë¥¼
ì‹¤í–‰í•œë‹¤.<ol><li>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ ê¸°ë°˜ì˜ í´ëŸ¬ìŠ¤í„° ìˆ˜ì¤€ êµ¬ì„±(configuration)ì„ ìƒì„±</li><li>API ì„œë²„ê°€ ì´ êµ¬ì„±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ íŒŒì¼ì„ ìƒì„±</li><li>ì´ êµ¬ì„±ì„ ì‚¬ìš©í•˜ëŠ” API ì„œë²„ë¥¼ í¬í•¨í•˜ëŠ” í´ëŸ¬ìŠ¤í„°ë¥¼ ìƒì„±</li><li>kubectl contextë¥¼ ìƒˆë¡œ ìƒì„±í•œ í´ëŸ¬ìŠ¤í„°ì— ì„¤ì •</li><li>ìµœì†Œí•œì˜ íŒŒë“œ êµ¬ì„±ì„ ìœ„í•œ yaml íŒŒì¼ì„ ìƒì„±</li><li>í•´ë‹¹ íŒŒì¼ì„ ì ìš©í•˜ì—¬ ìƒˆ í´ëŸ¬ìŠ¤í„°ì— íŒŒë“œë¥¼ ìƒì„±</li></ol></li><li><a href=/docs/concepts/security/pod-security-admission/>íŒŒë“œ ì‹œíë¦¬í‹° ì–´ë“œë¯¸ì…˜</a></li><li><a href=/ko/docs/concepts/security/pod-security-standards/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œ</a></li><li><a href=/ko/docs/tutorials/security/ns-level-pss/>íŒŒë“œ ì‹œíë¦¬í‹° ìŠ¤íƒ ë‹¤ë“œë¥¼ ë„¤ì„ìŠ¤í˜ì´ìŠ¤ ìˆ˜ì¤€ì— ì ìš©í•˜ê¸°</a></li></ul></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/ko/docs/home/>í™ˆ</a>
<a class=text-white href=/ko/blog/>ë¸”ë¡œê·¸</a>
<a class=text-white href=/ko/training/>êµìœ¡</a>
<a class=text-white href=/ko/partners/>íŒŒíŠ¸ë„ˆ</a>
<a class=text-white href=/ko/community/>Community</a>
<a class=text-white href=/ko/case-studies/>ì‚¬ë¡€ ì—°êµ¬</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Trademark Usage page</a></small><br><small class=text-white>ICP license: äº¬ICPå¤‡17074266å·-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>