<!doctype html><html lang=ko class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/blog/2022/05/13/grpc-probes-now-in-beta/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/blog/2022/05/13/grpc-probes-now-in-beta/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>쿠버네티스 1.24: gRPC 컨테이너 프로브 베타 | Kubernetes</title><meta property="og:title" content="쿠버네티스 1.24: gRPC 컨테이너 프로브 베타"><meta property="og:description" content="저자: Sergey Kanzhelev (Google)
번역: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)
쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다. 이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며, 실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.
약간의 히스토리 시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지, 트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다."><meta property="og:type" content="article"><meta property="og:url" content="https://kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-05-13T00:00:00+00:00"><meta property="article:modified_time" content="2022-07-23T21:11:29+09:00"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="쿠버네티스 1.24: gRPC 컨테이너 프로브 베타"><meta itemprop=description content="저자: Sergey Kanzhelev (Google)
번역: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)
쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다. 이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며, 실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.
약간의 히스토리 시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지, 트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다."><meta itemprop=datePublished content="2022-05-13T00:00:00+00:00"><meta itemprop=dateModified content="2022-07-23T21:11:29+09:00"><meta itemprop=wordCount content="844"><meta itemprop=keywords content><meta name=twitter:card content="summary"><meta name=twitter:title content="쿠버네티스 1.24: gRPC 컨테이너 프로브 베타"><meta name=twitter:description content="저자: Sergey Kanzhelev (Google)
번역: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)
쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다. 이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며, 실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.
약간의 히스토리 시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지, 트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다."><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content="저자: Sergey Kanzhelev (Google)
번역: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)
쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다. 이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며, 실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.
약간의 히스토리 시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지, 트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다."><meta property="og:description" content="저자: Sergey Kanzhelev (Google)
번역: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)
쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다. 이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며, 실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.
약간의 히스토리 시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지, 트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다."><meta name=twitter:description content="저자: Sergey Kanzhelev (Google)
번역: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)
쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다. 이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며, 실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.
약간의 히스토리 시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지, 트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다."><meta property="og:url" content="https://kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/"><meta property="og:title" content="쿠버네티스 1.24: gRPC 컨테이너 프로브 베타"><meta name=twitter:title content="쿠버네티스 1.24: gRPC 컨테이너 프로브 베타"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script><title>쿠버네티스 1.24: gRPC 컨테이너 프로브 베타 | Kubernetes</title><script defer src=https://use.fontawesome.com/releases/v5.0.6/js/all.js></script></head><body class="td-page td-blog"><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/ko/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/docs/>문서</a></li><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/ko/blog/>쿠버네티스 블로그</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/training/>교육</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/partners/>파트너</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/community/>Community</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/ko/case-studies/>사례 연구</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>버전</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/ko/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/ko/blog/2022/05/13/grpc-probes-now-in-beta/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>한국어 (Korean)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/blog/2022/05/13/grpc-probes-now-in-beta/>English</a>
<a class=dropdown-item href=/zh-cn/blog/2022/05/13/grpc-probes-now-in-beta/>中文 (Chinese)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav><section class="header-hero text-center text-white font-bold pb-4"><h1>쿠버네티스 블로그</h1></section></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><div class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" name=q placeholder="&#xf002 검색하기" aria-label=검색하기 autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav pt-2 pl-4" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/ko/blog/2022/05/13/grpc-probes-now-in-beta/ class="align-left pl-0 pr-2 active td-sidebar-link td-sidebar-link__section">2022</a></li><ul><li class="blog-post collapse show" data-year=2022><a class="td-sidebar-link td-sidebar-link__page active" id=m-ko-blog-2022-05-13-grpc-probes-now-in-beta href=/ko/blog/2022/05/13/grpc-probes-now-in-beta/>쿠버네티스 1.24: gRPC 컨테이너 프로브 베타</a></li><li class="more-posts collapse show" data-year=2022><a class=td-sidebar-link id=more-posts href>Show More Posts...</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/ko/blog/2021/08/04/kubernetes-1-22-release-announcement/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">2021</a></li><ul><li class="blog-post collapse" data-year=2021><a class="td-sidebar-link td-sidebar-link__page" id=m-ko-blog-2021-08-04-kubernetes-1-22-release-announcement href=/ko/blog/2021/08/04/kubernetes-1-22-release-announcement/>쿠버네티스 1.22: 새로운 정점에 도달(Reaching New Peaks)</a></li><li class="more-posts collapse" data-year=2021><a class=td-sidebar-link id=more-posts href>Show More Posts...</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/ko/blog/2020/12/02/dont-panic-kubernetes-and-docker/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">2020</a></li><ul><li class="blog-post collapse" data-year=2020><a class="td-sidebar-link td-sidebar-link__page" id=m-ko-blog-2020-12-02-dont-panic-kubernetes-and-docker href=/ko/blog/2020/12/02/dont-panic-kubernetes-and-docker/>당황하지 마세요. 쿠버네티스와 도커</a></li><li class="more-posts collapse" data-year=2020><a class=td-sidebar-link id=more-posts href>Show More Posts...</a></li></ul></ul><ul class="td-sidebar-nav__section pr-md-3"><li class=td-sidebar-nav__section-title><a href=/ko/blog/2018/11/07/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%97%90%EC%84%9C-%EC%96%B4%EB%A0%A4%EC%9B%80-%EC%97%86%EC%9D%B4-grpc-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1%ED%95%98%EA%B8%B0/ class="align-left pl-0 pr-2 collapsed td-sidebar-link td-sidebar-link__section">2018</a></li><ul><li class="blog-post collapse" data-year=2018><a class="td-sidebar-link td-sidebar-link__page" id=m-ko-blog-2018-11-07-ec-bf-a0-eb-b2-84-eb-84-a4-ed-8b-b0-ec-8a-a4-ec-97-90-ec-84-9c-ec-96-b4-eb-a0-a4-ec-9b-80-ec-97-86-ec-9d-b4-grpc-eb-a1-9c-eb-93-9c-eb-b0-b8-eb-9f-b0-ec-8b-b1-ed-95-98-ea-b8-b0 href=/ko/blog/2018/11/07/%EC%BF%A0%EB%B2%84%EB%84%A4%ED%8B%B0%EC%8A%A4%EC%97%90%EC%84%9C-%EC%96%B4%EB%A0%A4%EC%9B%80-%EC%97%86%EC%9D%B4-grpc-%EB%A1%9C%EB%93%9C%EB%B0%B8%EB%9F%B0%EC%8B%B1%ED%95%98%EA%B8%B0/>쿠버네티스에서 어려움 없이 gRPC 로드밸런싱하기</a></li><li class="more-posts collapse" data-year=2018><a class=td-sidebar-link id=more-posts href>Show More Posts...</a></li></ul></ul></nav></div><script>let morePosts=document.querySelectorAll(".more-posts"),year="";morePosts.forEach(e=>{e.onclick=t=>{t.preventDefault(),year=e.dataset.year,console.log(year);let n=document.querySelectorAll(`.blog-post.hidden[data-year="${year}"]`);console.log(n),n.forEach(e=>{e.classList.add("show"),e.classList.remove("hidden")}),e.style.display="none"}})</script></div><main class="col-12 col-md-9 col-xl-8 pl-md-5 pr-md-4" role=main><div class=td-content><h1>쿠버네티스 1.24: gRPC 컨테이너 프로브 베타</h1><div class="td-byline mb-4"><time datetime=2022-05-13 class=text-muted>2022.05.13</time></div><header class=article-meta></header><p><strong>저자</strong>: Sergey Kanzhelev (Google)</p><p><strong>번역</strong>: 송원석 (쏘카), 손석호 (ETRI), 김상홍 (국민대), 김보배 (11번가)</p><p>쿠버네티스 1.24에서 gRPC 프로브 기능이 베타에 진입했으며 기본적으로 사용 가능하다.
이제 HTTP 엔드포인트를 노출하지 않고, gRPC 앱에 대한 스타트업(startup), 활성(liveness) 및 준비성(readiness) 프로브를 구성할 수 있으며,
실행 파일도 필요하지 않는다. 쿠버네티스는 기본적으로 gRPC를 통해 워크로드에 자체적으로(natively) 연결 가능하며, 상태를 쿼리할 수 있다.</p><h2 id=약간의-히스토리>약간의 히스토리</h2><p>시스템이 워크로드의 앱이 정상인지, 정상적으로 시작되었는지,
트래픽을 수용할 수 있는지에 대해 관리하는 것은 유용하다.
gRPC 지원이 추가되기 전에도, 쿠버네티스는 이미 컨테이너 이미지
내부에서 실행 파일을 실행하거나, HTTP 요청을 하거나,
TCP 연결이 성공했는지 여부를 확인하여 상태를 확인할 수 있었다.</p><p>대부분의 앱은, 이러한 검사로 충분하다. 앱이 상태(또는 준비성) 확인을
위한 gRPC 엔드포인트를 제공하는 경우 <code>exec</code> 프로브를
gRPC 상태 확인에 사용하도록 쉽게 용도를 변경할 수 있다.
블로그 기사 <a href=/blog/2018/10/01/health-checking-grpc-servers-on-kubernetes/>쿠버네티스의 gRPC 서버 상태 확인</a>에서, Ahmet Alp Balkan은 이를 수행하는 방법을 설명하였으며, 이는 지금도 여전히 작동하는 메커니즘이다.</p><p>이것을 활성화하기 위해 일반적으로 사용하는 도구는 2018년 8월 21일에 <a href=https://github.com/grpc-ecosystem/grpc-health-probe/commit/2df4478982e95c9a57d5fe3f555667f4365c025d>생성</a>되었으며, 이 도구의 첫 릴리즈는 <a href=https://github.com/grpc-ecosystem/grpc-health-probe/releases/tag/v0.1.0-alpha.1>2018년 9월 19일</a>에 나왔다.</p><p>gRPC 앱 상태 확인을 위한 이 접근 방식은 매우 인기있다. <code>grpc_health_probe</code>를 포함하고 있는 <a href="https://github.com/search?l=Dockerfile&q=grpc_health_probe&type=code">Dockerfile은 3,626개</a>이며, (문서 작성 시점에)GitHub의 기본 검색으로 발견된 <a href="https://github.com/search?l=YAML&q=grpc_health_probe&type=Code">yaml 파일은 6,621개</a>가 있다. 이것은 도구의 인기와 이를 기본적으로 지원해야 할 필요성을 잘 나타낸다.</p><p>쿠버네티스 v1.23은 gRPC를 사용하여 워크로드 상태를 쿼리하는 기본(native) 지원을 알파 수준의 구현으로 기본 지원으로 도입 및 소개했다. 알파 기능이었기 때문에 v1.23 릴리스에서는 기본적으로 비활성화되었다.</p><h2 id=기능-사용>기능 사용</h2><p>우리는 다른 프로브와 유사한 방식으로 gRPC 상태를 확인할 수 있도록 구축했으며, 쿠버네티스의 다른 프로브에 익숙하다면 <a href=/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-a-grpc-liveness-probe>사용하기 쉬울 것</a>이라 믿는다.
자체적으로 지원되는 상태 프로브는 <code>grpc_health_probe</code> 실행 파일과 관련되어 있던 차선책에 비해 많은 이점이 있다.</p><p>기본 gRPC 지원을 사용하면 이미지에 <code>10MB</code>의 추가 실행 파일을 다운로드하여 저장할 필요가 없다.
Exec 프로브는 실행 파일을 실행하기 위해 새 프로세스를 인스턴스화해야 하므로 일반적으로 gRPC 호출보다 느리다.
또한 파드가 리소스 최대치로 실행 중이고 새 프로세스를 인스턴스화하는데 문제가 있는 경우에는 검사의 분별성을 낮추게 만든다.</p><p>그러나 여기에는 몇 가지 제약이 있다. 프로브용 클라이언트 인증서(certificate)를 구성하는 것이 어렵기 때문에, 클라이언트 인증(authentication)이 필요한 서비스는 지원하지 않는다. 기본 제공(built-in) 프로브도 서버 인증서를 확인하지 않고 관련 문제를 무시한다.</p><p>또한 기본 제공 검사는 특정 유형의 오류를 무시하도록 구성할 수 없으며 (<code>grpc_health_probe</code>는 다른 오류에 대해 다른 종료 코드를 반환함), 단일 프로브에서 여러 서비스 상태 검사를 실행하도록 "연계(chained)"할 수 없다.</p><p>그러나 이러한 모든 제한 사항은 gRPC에서 꽤 일반적이며 이에 대한 쉬운 해결 방법이 있다.</p><h2 id=직접-해-보기>직접 해 보기</h2><h3 id=클러스터-수준의-설정>클러스터 수준의 설정</h3><p>오늘 이 기능을 사용해 볼 수 있다. 기본 gRPC 프로브 사용을 시도하려면, <code>GRPCContainerProbe</code> 기능 게이트를 활성화하여 쿠버네티스 클러스터를 직접 가동한다. <a href=/ko/docs/tasks/tools/>가용한 도구</a>가 많이 있다.</p><p>기능 게이트 <code>GRPCContainerProbe</code>는 1.24에서 기본적으로 활성화되어 있으므로, 많은 공급업체가 이 기능을 즉시 사용 가능하도록 제공할 것이다.
따라서 선택한 플랫폼에서 1.24 클러스터를 그냥 생성하면 된다. 일부 공급업체는 1.23 클러스터에서 알파 기능을 사용 할 수 있도록 허용한다.</p><p>예를 들어, 빠른 테스트를 위해 GKE에서 테스트 클러스터를 가동할 수 있다. (해당 문서 작성 시점 기준)
다른 공급업체도 유사한 기능을 가지고 있을 수 있다. 특히 쿠버네티스 1.24 릴리스 이후 이 블로그 게시물을 읽고 있는 경우에는 더욱 그렇다.</p><p>GKE에서 다음 명령어를 사용한다. (참고로 버전은 <code>1.23</code>이고 <code>enable-kubernetes-alpha</code>가 지정됨).</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gcloud container clusters create test-grpc <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>    --enable-kubernetes-alpha <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>    --no-enable-autorepair <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>    --no-enable-autoupgrade <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>    --release-channel<span style=color:#666>=</span>rapid <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>    --cluster-version<span style=color:#666>=</span>1.23
</span></span></code></pre></div><p>또한 클러스터에 접근하기 위해서 <code>kubectl</code>을 구성할 필요가 있다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>gcloud container clusters get-credentials test-grpc
</span></span></code></pre></div><h3 id=기능-사용해-보기>기능 사용해 보기</h3><p>gRPC 프로브가 작동하는 방식을 테스트하기 위해 파드를 생성해 보겠다. 이 테스트에서는 <code>agnhost</code> 이미지를 사용한다.
이것은 모든 종류의 워크로드 테스트에 사용할 수 있도록, k8s가 유지 관리하는 이미지다.
예를 들어, 두 개의 포트를 노출하는 유용한 <a href=https://github.com/kubernetes/kubernetes/blob/b2c5bd2a278288b5ef19e25bf7413ecb872577a4/test/images/agnhost/README.md#grpc-health-checking>grpc-health-checking</a> 모듈을 가지고 있다. 하나는 상태 확인 서비스를 제공하고 다른 하나는 <code>make-serving</code> 및 <code>make-not-serving</code> 명령에 반응하는 http 포트다.</p><p>다음은 파드 정의의 예시이다. 이 예시는 <code>grpc-health-checking</code> 모듈을 시작하고, 포트 <code>5000</code> 및 <code>8080</code>을 노출하며, gRPC 준비성 프로브를 구성한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#00f;font-weight:700>---</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>apiVersion</span>:<span style=color:#bbb> </span>v1<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>kind</span>:<span style=color:#bbb> </span>Pod<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>metadata</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>test-grpc<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb></span><span style=color:green;font-weight:700>spec</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span><span style=color:green;font-weight:700>containers</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>  </span>- <span style=color:green;font-weight:700>name</span>:<span style=color:#bbb> </span>agnhost<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>image</span>:<span style=color:#bbb> </span>k8s.gcr.io/e2e-test-images/agnhost:2.35<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>command</span>:<span style=color:#bbb> </span>[<span style=color:#b44>&#34;/agnhost&#34;</span>,<span style=color:#bbb> </span><span style=color:#b44>&#34;grpc-health-checking&#34;</span>]<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>ports</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>containerPort</span>:<span style=color:#bbb> </span><span style=color:#666>5000</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span>- <span style=color:green;font-weight:700>containerPort</span>:<span style=color:#bbb> </span><span style=color:#666>8080</span><span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>    </span><span style=color:green;font-weight:700>readinessProbe</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>      </span><span style=color:green;font-weight:700>grpc</span>:<span style=color:#bbb>
</span></span></span><span style=display:flex><span><span style=color:#bbb>        </span><span style=color:green;font-weight:700>port</span>:<span style=color:#bbb> </span><span style=color:#666>5000</span><span style=color:#bbb>
</span></span></span></code></pre></div><p><code>test.yaml</code>이라는 파일이 있으면, 파드를 생성하고 상태를 확인할 수 있다. 파드는 아래 출력 스니펫(snippet)에 표시된 대로 준비(ready) 상태가 된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl apply -f test.yaml
</span></span><span style=display:flex><span>kubectl describe test-grpc
</span></span></code></pre></div><p>출력에는 다음과 같은 내용이 포함된다.</p><pre tabindex=0><code>Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
</code></pre><p>이제 상태 확인 엔드포인트 상태를 NOT_SERVING으로 변경해 보겠다.
파드의 http 포트를 호출하기 위해 포트 포워드를 생성한다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl port-forward test-grpc 8080:8080
</span></span></code></pre></div><p>명령을 호출하기 위해 <code>curl</code>을 사용할 수 있다 ...</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>curl http://localhost:8080/make-not-serving
</span></span></code></pre></div><p>... 그리고 몇 초 후에 포트 상태가 준비되지 않음으로 전환된다.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl describe pod test-grpc
</span></span></code></pre></div><p>이제 다음과 같은 출력을 확인할 수 있을 것이다.</p><pre tabindex=0><code>Conditions:
  Type              Status
  Initialized       True
  Ready             False
  ContainersReady   False
  PodScheduled      True
...
  Warning  Unhealthy  2s (x6 over 42s)  kubelet            Readiness probe failed: service unhealthy (responded with &#34;NOT_SERVING&#34;)
</code></pre><p>다시 전환되면, 약 1초 후에 파드가 준비(ready) 상태로 돌아간다.</p><pre tabindex=0><code class=language-bsh data-lang=bsh>curl http://localhost:8080/make-serving
kubectl describe test-grpc
</code></pre><p>아래 출력은 파드가 다시 <code>Ready</code> 상태로 돌아갔다는 것을 나타낸다.</p><pre tabindex=0><code>Conditions:
  Type              Status
  Initialized       True
  Ready             True
  ContainersReady   True
  PodScheduled      True
</code></pre><p>쿠버네티스에 내장된 이 새로운 gRPC 상태 프로브를 사용하면 별도의 <code>exec</code> 프로브를 사용하는 이전 접근 방식보다 gRPC를 통한 상태 확인을 훨씬 쉽게 구현할 수 있다. 더 자세한 내용 파악을 위해 공식 <a href=/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/#define-a-grpc-liveness-probe>문서</a>를 자세히 살펴보고, 기능이 GA로 승격되기 전에 피드백을 제공하길 바란다.</p><h2 id=요약>요약</h2><p>쿠버네티스는 인기 있는 워크로드 오케스트레이션 플랫폼이며 피드백과 수요를 기반으로 기능을 추가한다.
gRPC 프로브 지원과 같은 기능은 많은 앱 개발자의 삶을 더 쉽게 만들고 앱을 더 탄력적으로 만들 수 있는 마이너한 개선이다. 오늘 기능을 사용해보고 기능이 GA로 전환되기 전에 오늘 사용해 보고 피드백을 제공해보자.</p><ul class="list-unstyled d-flex justify-content-between align-items-center mb-0 pt-5"><li><a href=/ko/blog/2021/08/04/kubernetes-1-22-release-announcement/ aria-label="이전 - 쿠버네티스 1.22: 새로운 정점에 도달(Reaching New Peaks)" class="btn btn-primary"><span class=mr-1>←</span>이전</a></li><a class="btn btn-primary disabled">다음<span class=ml-1>→</span></a></li></ul></div></main><div class="d-none d-xl-block col-xl-2 td-toc d-print-none"><div class="td-page-blog-meta ml-2 pb-1 pt-2 mb-4"><link rel=alternate type=application/rss+xml href=https://kubernetes.io/ko/feed.xml title=Kubernetes><a class=widget-link href=https://kubernetes.io/ko/feed.xml><div><i class="fas fa-rss fab-icon"></i><span class=widget-link-text>RSS Feed</span></div></a><a class=widget-link href=https://kubernetes.io/docs/contribute/new-content/blogs-case-studies/><div><i class="fa fa-edit fab-icon"></i> <span class=widget-link-text>Submit a Post</span></div></a><a class=widget-link href=https://twitter.com/kubernetesio><div><i class="fab fa-twitter-square fab-icon"></i><span class=widget-link-text>@Kubernetesio</span></div></a><a class=widget-link href=https://github.com/kubernetes/kubernetes><div><i class="fab fa-github-square fab-icon"></i> <span class=widget-link-text>on GitHub</span></div></a><a class=widget-link href=http://slack.k8s.io><div><i class="fab fa-slack fab-icon"></i><span class=widget-link-text>#kubernetes-users</span></div></a><a class=widget-link href=https://stackoverflow.com/questions/tagged/kubernetes><div><i class="fab fa-stack-overflow fab-icon"></i> <span class=widget-link-text>Overflow</span></div></a><a class=widget-link href=https://discuss.kubernetes.io><div><i class="fab fa-discourse fab-icon"></i><span class=widget-link-text> Forum</span></div></a><a class=widget-link href=https://kubernetes.io/docs/setup><div><i class="fa fa-download fab-icon"></i> <span class=widget-link-text>Kubernetes</span></div></a></div></div></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/ko/docs/home/>홈</a>
<a class=text-white href=/ko/blog/>블로그</a>
<a class=text-white href=/ko/training/>교육</a>
<a class=text-white href=/ko/partners/>파트너</a>
<a class=text-white href=/ko/community/>Community</a>
<a class=text-white href=/ko/case-studies/>사례 연구</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Trademark Usage page</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>