<!doctype html><html lang=fr class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/tasks/access-application-cluster/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/docs/tasks/access-application-cluster/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/tasks/access-application-cluster/><link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/tasks/access-application-cluster/><link rel=alternate hreflang=de href=https://kubernetes.io/de/docs/tasks/access-application-cluster/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/tasks/access-application-cluster/><link rel=alternate hreflang=id href=https://kubernetes.io/id/docs/tasks/access-application-cluster/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/fr/docs/tasks/access-application-cluster/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>Accès aux applications dans un cluster | Kubernetes</title><meta property="og:title" content="Accès aux applications dans un cluster"><meta property="og:description" content="Solution professionnelle d’orchestration de conteneurs"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/fr/docs/tasks/access-application-cluster/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="Accès aux applications dans un cluster"><meta itemprop=description content="Solution professionnelle d’orchestration de conteneurs"><meta name=twitter:card content="summary"><meta name=twitter:title content="Accès aux applications dans un cluster"><meta name=twitter:description content="Solution professionnelle d’orchestration de conteneurs"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content><meta property="og:description" content><meta name=twitter:description content><meta property="og:url" content="https://kubernetes.io/fr/docs/tasks/access-application-cluster/"><meta property="og:title" content="Accès aux applications dans un cluster"><meta name=twitter:title content="Accès aux applications dans un cluster"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/fr/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/fr/docs/>Documentation</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/blog/>Blog de Kubernetes</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/partners/>Partenaires</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/community/>Communauté</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/case-studies/>Études de cas</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/fr/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/fr/docs/tasks/access-application-cluster/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/fr/docs/tasks/access-application-cluster/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/fr/docs/tasks/access-application-cluster/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/fr/docs/tasks/access-application-cluster/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/fr/docs/tasks/access-application-cluster/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Français (French)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/tasks/access-application-cluster/>English</a>
<a class=dropdown-item href=/zh-cn/docs/tasks/access-application-cluster/>中文 (Chinese)</a>
<a class=dropdown-item href=/ko/docs/tasks/access-application-cluster/>한국어 (Korean)</a>
<a class=dropdown-item href=/ja/docs/tasks/access-application-cluster/>日本語 (Japanese)</a>
<a class=dropdown-item href=/de/docs/tasks/access-application-cluster/>Deutsch (German)</a>
<a class=dropdown-item href=/es/docs/tasks/access-application-cluster/>Español (Spanish)</a>
<a class=dropdown-item href=/id/docs/tasks/access-application-cluster/>Bahasa Indonesia</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>Version imprimable multipages.
<a href=# onclick="return print(),!1">Cliquer ici pour imprimer</a>.</p><p><a href=/fr/docs/tasks/access-application-cluster/>Retour à la version par défaut</a>.</p></div><h1 class=title>Accès aux applications dans un cluster</h1><ul><li>1: <a href=#pg-777447042cd4e81df3fa5beb3357a485>Tableau de bord (Dashboard)</a></li><li>2: <a href=#pg-5a233e14205d77fe1294917d2da6f876>Configurer l'accès à plusieurs clusters</a></li><li>3: <a href=#pg-48e8f306f919c5b81265e265a2b76ab4>Lister toutes les images de conteneur exécutées dans un cluster</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-777447042cd4e81df3fa5beb3357a485>1 - Tableau de bord (Dashboard)</h1><p>Le tableau de bord (Dashboard) est une interface web pour Kubernetes.
Vous pouvez utiliser ce tableau de bord pour déployer des applications conteneurisées dans un cluster Kubernetes, dépanner votre application conteneurisée et gérer les ressources du cluster.
Vous pouvez utiliser le tableau de bord pour obtenir une vue d'ensemble des applications en cours d'exécution dans votre cluster, ainsi que pour créer ou modifier des ressources Kubernetes individuelles. (comme des Deployments, Jobs, DaemonSets, etc).
Par exemple, vous pouvez redimensionner un Deployment, lancer une mise à jour progressive, recréer un pod ou déployez de nouvelles applications à l'aide d'un assistant de déploiement.</p><p>Le tableau de bord fournit également des informations sur l'état des ressources Kubernetes de votre cluster et sur les erreurs éventuelles.</p><p><img src=/images/docs/ui-dashboard.png alt="Tableau de bord Kubernetes"></p><h2 id=déploiement-du-tableau-de-bord>Déploiement du tableau de bord</h2><p>L'interface utilisateur du tableau de bord n'est pas déployée par défaut.
Pour le déployer, exécutez la commande suivante:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>kubectl apply -f https://raw.githubusercontent.com/kubernetes/dashboard/master/aio/deploy/recommended.yaml
</span></span></code></pre></div><h2 id=accès-à-l-interface-utilisateur-du-tableau-de-bord>Accès à l'interface utilisateur du tableau de bord</h2><p>Pour protéger vos données dans le cluster, le tableau de bord se déploie avec une configuration RBAC minimale par défaut.
Actuellement, le tableau de bord prend uniquement en charge la connexion avec un jeton de support.
Pour créer un jeton pour cette démo, vous pouvez suivre notre guide sur <a href=https://github.com/kubernetes/dashboard/blob/master/docs/user/access-control/creating-sample-user.md>créer un exemple d'utilisateur</a>.</p><div class="alert alert-danger warning callout" role=alert><strong>Attention:</strong> L’exemple d’utilisateur créé dans le didacticiel disposera de privilèges d’administrateur et servira uniquement à des fins pédagogiques.</div><h3 id=proxy-en-ligne-de-commande>Proxy en ligne de commande</h3><p>Vous pouvez accéder au tableau de bord à l'aide de l'outil en ligne de commande kubectl en exécutant la commande suivante:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>kubectl proxy
</span></span></code></pre></div><p>Kubectl mettra le tableau de bord à disposition à l'adresse suivante: <a href=http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/>http://localhost:8001/api/v1/namespaces/kubernetes-dashboard/services/https:kubernetes-dashboard:/proxy/</a>.</p><p>Vous ne pouvez accéder à l'interface utilisateur <em>que</em> depuis la machine sur laquelle la commande est exécutée.
Voir <code>kubectl proxy --help</code> pour plus d'options.</p><div class="alert alert-info note callout" role=alert><strong>Note:</strong> La méthode d'authentification Kubeconfig ne prend pas en charge les fournisseurs d'identité externes ni l'authentification basée sur un certificat x509.</div><h2 id=page-de-bienvenue>Page de bienvenue</h2><p>Lorsque vous accédez au tableau de bord sur un cluster vide, la page d'accueil s'affiche.
Cette page contient un lien vers ce document ainsi qu'un bouton pour déployer votre première application.
De plus, vous pouvez voir quelles applications système sont exécutées par défaut dans le <a href=/docs/tasks/administer-cluster/namespaces/>namespace</a> <code>kubernetes-dashboard</code> de votre cluster, par exemple le tableau de bord lui-même.</p><p><img src=/images/docs/ui-dashboard-zerostate.png alt="Page d'accueil du tableau de bord Kubernetes"></p><h2 id=déploiement-d-applications-conteneurisées>Déploiement d'applications conteneurisées</h2><p>Le tableau de bord vous permet de créer et de déployer une application conteneurisée en tant que Deployment et optionnellement un Service avec un simple assistant.
Vous pouvez spécifier manuellement les détails de l'application ou charger un fichier YAML ou JSON contenant la configuration de l'application.</p><p>Cliquez sur le bouton <strong>CREATE</strong> dans le coin supérieur droit de n’importe quelle page pour commencer.</p><h3 id=spécifier-les-détails-de-l-application>Spécifier les détails de l'application</h3><p>L'assistant de déploiement s'attend à ce que vous fournissiez les informations suivantes:</p><ul><li><p><strong>App name</strong> (obligatoire): Nom de votre application.
Un <a href=/docs/concepts/overview/working-with-objects/labels/>label</a> avec le nom sera ajouté au Deployment et Service, le cas échéant, qui sera déployé.</p><p>Le nom de l'application doit être unique dans son <a href=/docs/tasks/administer-cluster/namespaces/>namespace</a> Kubernetes.
Il doit commencer par une lettre minuscule et se terminer par une lettre minuscule ou un chiffre et ne contenir que des lettres minuscules, des chiffres et des tirets (-).
Il est limité à 24 caractères.
Les espaces de début et de fin sont ignorés.</p></li><li><p><strong>Container image</strong> (obligatoire): L'URL d'une <a href=/docs/concepts/containers/images/>image de conteneur</a> sur n'importe quel registre, ou une image privée (généralement hébergée sur le registre de conteneurs Google ou le hub Docker).
La spécification d'image de conteneur doit se terminer par un deux-points.</p></li><li><p><strong>Number of pods</strong> (obligatoire): Nombre cible de pods dans lesquels vous souhaitez déployer votre application.
La valeur doit être un entier positif.</p><p>Un objet <a href=/docs/concepts/workloads/controllers/deployment/>Deployment</a> sera créé pour maintenir le nombre souhaité de pods dans votre cluster.</p></li><li><p><strong>Service</strong> (optionnel): Pour certaines parties de votre application (par exemple les serveurs frontaux), vous souhaiterez peut-être exposer un <a href=/docs/concepts/services-networking/service/>Service</a> sur une adresse IP externe, peut-être publique, en dehors de votre cluster (Service externe).
Pour les Services externes, vous devrez peut-être ouvrir un ou plusieurs ports pour le faire.
Trouvez plus de détails <a href=/docs/tasks/access-application-cluster/configure-cloud-provider-firewall/>ici</a>.</p><p>Les autres services visibles uniquement de l'intérieur du cluster sont appelés Services internes.</p><p>Quel que soit le type de service, si vous choisissez de créer un service et que votre conteneur écoute sur un port (entrant), vous devez spécifier deux ports.
Le Service sera créé en mappant le port (entrant) sur le port cible vu par le conteneur.
Ce Service acheminera le trafic vers vos pods déployés.
Les protocoles pris en charge sont TCP et UDP.
Le nom DNS interne de ce service sera la valeur que vous avez spécifiée comme nom d'application ci-dessus.</p></li></ul><p>Si nécessaire, vous pouvez développer la section <strong>Options avancées</strong> dans laquelle vous pouvez spécifier davantage de paramètres:</p><ul><li><p><strong>Description</strong>: Le texte que vous entrez ici sera ajouté en tant qu'<a href=/docs/concepts/overview/working-with-objects/annotations/>annotation</a> au Deployment et affiché dans les détails de l'application.</p></li><li><p><strong>Labels</strong>: Les <a href=/docs/concepts/overview/working-with-objects/labels/>labels</a> par défaut à utiliser pour votre application sont le nom et la version de l’application.
Vous pouvez spécifier des labels supplémentaires à appliquer au Deployment, Service (le cas échéant), et Pods, tels que la release, l'environnement, le niveau, la partition et la piste d'édition.</p><p>Exemple:</p><pre tabindex=0><code class=language-conf data-lang=conf>release=1.0
tier=frontend
environment=pod
track=stable
</code></pre></li><li><p><strong>Namespace</strong>: Kubernetes prend en charge plusieurs clusters virtuels s'exécutant sur le même cluster physique.
Ces clusters virtuels sont appelés <a href=/docs/tasks/administer-cluster/namespaces/>namespaces</a>.
Ils vous permettent de partitionner les ressources en groupes nommés de manière logique.</p><p>Le tableau de bord propose tous les namespaces disponibles dans une liste déroulante et vous permet de créer un nouveau namespace.
Le nom du namespace peut contenir au maximum 63 caractères alphanumériques et des tirets (-), mais ne peut pas contenir de lettres majuscules.
Les noms de Namespace ne devraient pas être composés uniquement de chiffres.
Si le nom est défini sous la forme d’un nombre, tel que 10, le pod sera placé dans le namespace par défaut.</p><p>Si la création du namespace réussit, celle-ci est sélectionnée par défaut.
Si la création échoue, le premier namespace est sélectionné.</p></li><li><p><strong>Image Pull Secret</strong>: Si l'image de conteneur spécifiée est privée, il peut être nécessaire de configurer des identifiants de <a href=/docs/concepts/configuration/secret/>pull secret</a>.</p><p>Le tableau de bord propose tous les secrets disponibles dans une liste déroulante et vous permet de créer un nouveau secret.
Le nom de secret doit respecter la syntaxe du nom de domaine DNS, par exemple. <code>new.image-pull.secret</code>.
Le contenu d'un secret doit être codé en base64 et spécifié dans un fichier <a href=/docs/concepts/containers/images/#specifying-imagepullsecrets-on-a-pod><code>.dockercfg</code></a>.
Le nom du secret peut contenir 253 caractères maximum.</p><p>Si la création du secret d’extraction d’image est réussie, celle-ci est sélectionnée par défaut.
Si la création échoue, aucun secret n'est appliqué.</p></li><li><p><strong>CPU requirement (cores)</strong> et <strong>Memory requirement (MiB)</strong>: Vous pouvez spécifier les <a href=/docs/tasks/configure-pod-container/limit-range/>limites de ressource</a> minimales pour le conteneur.
Par défaut, les pods fonctionnent avec des limites de CPU et de mémoire illimitées.</p></li><li><p><strong>Run command</strong> et <strong>Run command arguments</strong>: Par défaut, vos conteneurs exécutent les valeurs par défaut de la <a href=/docs/user-guide/containers/#containers-and-commands>commande d'entrée</a> de l'image spécifiée.
Vous pouvez utiliser les options de commande et les arguments pour remplacer la valeur par défaut.</p></li><li><p><strong>Run as privileged</strong>: Ce paramètre détermine si les processus dans <a href=/docs/user-guide/pods/#privileged-mode-for-pod-containers>conteneurs privilégiés</a> sont équivalents aux processus s'exécutant en tant que root sur l'hôte.
Les conteneurs privilégiés peuvent utiliser des fonctionnalités telles que la manipulation de la pile réseau et l'accès aux périphériques.</p></li><li><p><strong>Environment variables</strong>: Kubernetes expose ses Services via des <a href=/docs/tasks/inject-data-application/environment-variable-expose-pod-information/>variables d'environnement</a>.
Vous pouvez composer une variable d'environnement ou transmettre des arguments à vos commandes en utilisant les valeurs des variables d'environnement.<br>Ils peuvent être utilisés dans les applications pour trouver un Service.
Les valeurs peuvent référencer d'autres variables à l'aide de la syntaxe <code>$(VAR_NAME)</code>.</p></li></ul><h3 id=téléchargement-d-un-fichier-yaml-ou-json>Téléchargement d'un fichier YAML ou JSON</h3><p>Kubernetes supporte la configuration déclarative.
Dans ce style, toute la configuration est stockée dans des fichiers de configuration YAML ou JSON à l'aide des schémas de ressources de l'<a href=/docs/concepts/overview/kubernetes-api/>API</a> de Kubernetes.</p><p>Au lieu de spécifier les détails de l'application dans l'assistant de déploiement, vous pouvez définir votre application dans des fichiers YAML ou JSON et télécharger les fichiers à l'aide du tableau de bord.</p><h2 id=utilisation-du-tableau-de-bord>Utilisation du tableau de bord</h2><p>Les sections suivantes décrivent des vues du tableau de bord de Kubernetes; ce qu'elles fournissent et comment peuvent-elles être utilisées.</p><h3 id=navigation>Navigation</h3><p>Lorsque des objets Kubernetes sont définis dans le cluster, le tableau de bord les affiche dans la vue initiale.
Par défaut, seuls les objets du namespace <em>default</em> sont affichés, ce qui peut être modifié à l'aide du sélecteur d'espace de nom situé dans le menu de navigation.</p><p>Le tableau de bord montre la plupart des types d'objets Kubernetes et les regroupe dans quelques catégories de menus.</p><h4 id=vue-d-ensemble-de-l-administrateur>Vue d'ensemble de l'administrateur</h4><p>Pour les administrateurs de cluster et de namespace, le tableau de bord répertorie les noeuds, les namespaces et les volumes persistants et propose des vues de détail pour ceux-ci.
La vue Liste de nœuds contient les mesures d'utilisation de CPU et de la mémoire agrégées sur tous les nœuds.
La vue détaillée affiche les métriques d'un nœud, ses spécifications, son statut, les ressources allouées, les événements et les pods s'exécutant sur le nœud.</p><h4 id=charges-de-travail>Charges de travail</h4><p>Affiche toutes les applications en cours d'exécution dans le namespace selectionné.
La vue répertorie les applications par type de charge de travail. (e.g., Deployments, Replica Sets, Stateful Sets, etc.) et chaque type de charge de travail peut être visualisé séparément.
Les listes récapitulent les informations exploitables sur les charges de travail, telles que le nombre de Pods prêts pour un Replica Set ou l'utilisation actuelle de la mémoire pour un Pod.</p><p>Les vues détaillées des charges de travail affichent des informations sur l'état et les spécifications, ainsi que les relations de surface entre les objets.
Par exemple, les Pods qu'un Replica Set controle ou bien les nouveaux Replica Sets et Horizontal Pod Autoscalers pour les Deployments.</p><h4 id=services>Services</h4><p>Affiche les ressources Kubernetes permettant d’exposer les services au monde externe et de les découvrir au sein d’un cluster.
Pour cette raison, les vues Service et Ingress montrent les Pods ciblés par eux, les points de terminaison internes pour les connexions au cluster et les points de terminaison externes pour les utilisateurs externes.</p><h4 id=stockage>Stockage</h4><p>La vue de stockage montre les ressources Persistent Volume Claim qui sont utilisées par les applications pour stocker des données.</p><h4 id=config-maps-et-secrets>Config Maps et Secrets</h4><p>Affiche toutes les ressources Kubernetes utilisées pour la configuration en temps réel d'applications s'exécutant dans des clusters.
La vue permet d’éditer et de gérer des objets de configuration et d’afficher les secrets cachés par défaut.</p><h4 id=visualisation-de-journaux>Visualisation de journaux</h4><p>Les listes de Pod et les pages de détail renvoient à une visionneuse de journaux intégrée au tableau de bord.
Le visualiseur permet d’exploiter les logs des conteneurs appartenant à un seul Pod.</p><p><img src=/images/docs/ui-dashboard-logs-view.png alt="Visualisation de journaux"></p><h2 id=a-suivre>A suivre</h2><p>Pour plus d'informations, voir la page du projet <a href=https://github.com/kubernetes/dashboard>Kubernetes Dashboard</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-5a233e14205d77fe1294917d2da6f876>2 - Configurer l'accès à plusieurs clusters</h1><p>Cette page montre comment configurer l'accès à plusieurs clusters à l'aide de fichiers de configuration.
Une fois vos clusters, utilisateurs et contextes définis dans un ou plusieurs fichiers de configuration, vous pouvez basculer rapidement entre les clusters en utilisant la commande <code>kubectl config use-context</code>.</p><div class="alert alert-info note callout" role=alert><strong>Note:</strong> Un fichier utilisé pour configurer l'accès à un cluster est parfois appelé <em>fichier kubeconfig</em>.
C'est une manière générique de se référer aux fichiers de configuration.
Cela ne signifie pas qu'il existe un fichier nommé <code>kubeconfig</code>.</div><h2 id=pré-requis>Pré-requis</h2><p>Vous devez disposer d'un cluster Kubernetes et l'outil de ligne de commande kubectl doit être configuré pour communiquer avec votre cluster.
Si vous ne possédez pas déjà de cluster, vous pouvez en créer un en utilisant <a href=/docs/setup/minikube>Minikube</a>, ou vous pouvez utiliser l'un de ces environnements Kubernetes:</p><ul><li><a href=https://killercoda.com/playgrounds/scenario/kubernetes>Killercoda</a></li><li><a href=http://labs.play-with-k8s.com/>Play with Kubernetes</a></li></ul><p>Pour vérifier que <a class=glossary-tooltip title='A command line tool for communicating with a Kubernetes cluster.' data-toggle=tooltip data-placement=top href=/docs/user-guide/kubectl-overview/ target=_blank aria-label=kubectl>kubectl</a> est installé, executez <code>kubectl version --client</code>.
La version kubectl doit être <a href=/docs/setup/release/version-skew-policy/#kubectl>dans une version mineure</a> de votre
serveur API du cluster.</p><h2 id=définir-des-clusters-des-utilisateurs-et-des-contextes>Définir des clusters, des utilisateurs et des contextes</h2><p>Supposons que vous ayez deux clusters, un pour le développement et un pour le travail <code>scratch</code>.
Dans le cluster <code>development</code>, vos développeurs frontend travaillent dans un espace de noms appelé <code>frontend</code>, et vos développeurs de stockage travaillent dans un espace de noms appelé <code>storage</code>.
Dans votre cluster <code>scratch</code>, les développeurs travaillent dans le namespace par défaut ou créent des namespaces auxiliaires comme bon leur semble.
L'accès au cluster <code>development</code> nécessite une authentification par certificat.
L'accès au cluster <code>scratch</code> nécessite une authentification par nom d'utilisateur et mot de passe.</p><p>Créez un répertoire nommé <code>config-exercice</code>.
Dans votre répertoire <code>config-exercice</code>, créez un fichier nommé <code>config-demo</code> avec ce contenu:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>kind: Config
</span></span><span style=display:flex><span>preferences: <span style=color:#666>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>clusters:
</span></span><span style=display:flex><span>- cluster:
</span></span><span style=display:flex><span>  name: development
</span></span><span style=display:flex><span>- cluster:
</span></span><span style=display:flex><span>  name: scratch
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>users:
</span></span><span style=display:flex><span>- name: developer
</span></span><span style=display:flex><span>- name: experimenter
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>contexts:
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>  name: dev-frontend
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>  name: dev-storage
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>  name: exp-scratch
</span></span></code></pre></div><p>Un fichier de configuration décrit les clusters, les utilisateurs et les contextes.
Votre fichier <code>config-demo</code> a le cadre pour décrire deux clusters, deux utilisateurs et trois contextes.</p><p>Allez dans votre répertoire <code>config-exercice</code>.
Entrez ces commandes pour ajouter les détails du cluster à votre fichier de configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-cluster development --server<span style=color:#666>=</span>https://1.2.3.4 --certificate-authority<span style=color:#666>=</span>fake-ca-file
</span></span><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-cluster scratch --server<span style=color:#666>=</span>https://5.6.7.8 --insecure-skip-tls-verify
</span></span></code></pre></div><p>Ajoutez les détails de l'utilisateur à votre fichier de configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-credentials developer --client-certificate<span style=color:#666>=</span>fake-cert-file --client-key<span style=color:#666>=</span>fake-key-seefile
</span></span><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-credentials experimenter --username<span style=color:#666>=</span>exp --password<span style=color:#666>=</span>some-password
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Note:</strong><ul><li>Pour supprimer un utilisateur, vous pouvez exécuter <code>kubectl --kubeconfig=config-demo config unset users.&lt;name></code></li><li>Pour supprimer un cluster, vous pouvez exécuter <code>kubectl --kubeconfig=config-demo config unset clusters.&lt;name></code></li><li>Pour supprimer un contexte, vous pouvez exécuter <code>kubectl --kubeconfig=config-demo config unset contexts.&lt;name></code></li></ul></div><p>Ajoutez des détails de contexte à votre fichier de configuration:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-context dev-frontend --cluster<span style=color:#666>=</span>development --namespace<span style=color:#666>=</span>frontend --user<span style=color:#666>=</span>developer
</span></span><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-context dev-storage --cluster<span style=color:#666>=</span>development --namespace<span style=color:#666>=</span>storage --user<span style=color:#666>=</span>developer
</span></span><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo set-context exp-scratch --cluster<span style=color:#666>=</span>scratch --namespace<span style=color:#666>=</span>default --user<span style=color:#666>=</span>experimenter
</span></span></code></pre></div><p>Ouvrez votre fichier <code>config-demo</code> pour voir les détails ajoutés.
Au lieu d'ouvrir le fichier <code>config-demo</code>, vous pouvez utiliser la commande <code>kubectl config view</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo view
</span></span></code></pre></div><p>La sortie montre les deux clusters, deux utilisateurs et trois contextes:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>clusters:
</span></span><span style=display:flex><span>- cluster:
</span></span><span style=display:flex><span>    certificate-authority: fake-ca-file
</span></span><span style=display:flex><span>    server: https://1.2.3.4
</span></span><span style=display:flex><span>  name: development
</span></span><span style=display:flex><span>- cluster:
</span></span><span style=display:flex><span>    insecure-skip-tls-verify: <span style=color:#a2f>true</span>
</span></span><span style=display:flex><span>    server: https://5.6.7.8
</span></span><span style=display:flex><span>  name: scratch
</span></span><span style=display:flex><span>contexts:
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: frontend
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-frontend
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: storage
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-storage
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: scratch
</span></span><span style=display:flex><span>    namespace: default
</span></span><span style=display:flex><span>    user: experimenter
</span></span><span style=display:flex><span>  name: exp-scratch
</span></span><span style=display:flex><span>current-context: <span style=color:#b44>&#34;&#34;</span>
</span></span><span style=display:flex><span>kind: Config
</span></span><span style=display:flex><span>preferences: <span style=color:#666>{}</span>
</span></span><span style=display:flex><span>users:
</span></span><span style=display:flex><span>- name: developer
</span></span><span style=display:flex><span>  user:
</span></span><span style=display:flex><span>    client-certificate: fake-cert-file
</span></span><span style=display:flex><span>    client-key: fake-key-file
</span></span><span style=display:flex><span>- name: experimenter
</span></span><span style=display:flex><span>  user:
</span></span><span style=display:flex><span>    password: some-password
</span></span><span style=display:flex><span>    username: exp
</span></span></code></pre></div><p>Le <code>fake-ca-file</code>, <code>fake-cert-file</code> et <code>fake-key-file</code> ci-dessus sont les espaces réservés pour les noms de chemin des fichiers de certificat.
Vous devez les remplacer par les noms de chemin réels des fichiers de certificat dans votre environnement.</p><p>Parfois, vous souhaiterez peut-être utiliser des données encodées en Base64 incorporées ici au lieu de fichiers de certificat séparés; dans ce cas, vous devez ajouter le suffixe <code>-data</code> aux clés, par exemple, <code>certificate-Authority-data</code>, <code>client-certificate-data</code>, <code>client-key-data</code>.</p><p>Chaque contexte est un triplet (cluster, utilisateur, namespace).
Par exemple, le contexte <code>dev-frontend</code> dit, "Utilisez les informations d'identification de l'utilisateur <code>developer</code> pour accéder au namespace <code>frontend</code> du cluster <code>development</code>".</p><p>Définissez le contexte actuel:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo use-context dev-frontend
</span></span></code></pre></div><p>Maintenant, chaque fois que vous entrez une commande <code>kubectl</code>, l'action s'appliquera au cluster et au namespace répertorié dans le contexte <code>dev-frontend</code>.
Et la commande utilisera les informations d'identification de l'utilisateur répertoriées dans le contexte <code>dev-frontend</code>.</p><p>Pour voir uniquement les informations de configuration associées au contexte actuel, utilisez l'indicateur <code>--minify</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo view --minify
</span></span></code></pre></div><p>La sortie affiche les informations de configuration associées au contexte <code>dev-frontend</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>clusters:
</span></span><span style=display:flex><span>- cluster:
</span></span><span style=display:flex><span>    certificate-authority: fake-ca-file
</span></span><span style=display:flex><span>    server: https://1.2.3.4
</span></span><span style=display:flex><span>  name: development
</span></span><span style=display:flex><span>contexts:
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: frontend
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-frontend
</span></span><span style=display:flex><span>current-context: dev-frontend
</span></span><span style=display:flex><span>kind: Config
</span></span><span style=display:flex><span>preferences: <span style=color:#666>{}</span>
</span></span><span style=display:flex><span>users:
</span></span><span style=display:flex><span>- name: developer
</span></span><span style=display:flex><span>  user:
</span></span><span style=display:flex><span>    client-certificate: fake-cert-file
</span></span><span style=display:flex><span>    client-key: fake-key-file
</span></span></code></pre></div><p>Supposons maintenant que vous souhaitiez travailler pendant un certain temps dans le cluster scratch.</p><p>Changez le contexte actuel en <code>exp-scratch</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo use-context exp-scratch
</span></span></code></pre></div><p>Maintenant, toute commande <code>kubectl</code> que vous donnez s'appliquera au namespace par défaut du cluster <code>scratch</code>.
Et la commande utilisera les informations d'identification de l'utilisateur répertoriées dans le contexte <code>exp-scratch</code>.</p><p>Afficher la configuration associée au nouveau contexte actuel, <code>exp-scratch</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo view --minify
</span></span></code></pre></div><p>Enfin, supposons que vous vouliez travailler pendant un certain temps dans le namespace <code>storage</code> du cluster <code>development</code>.</p><p>Changez le contexte actuel en <code>dev-storage</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo use-context dev-storage
</span></span></code></pre></div><p>Afficher la configuration associée au nouveau contexte actuel, <code>dev-storage</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config --kubeconfig<span style=color:#666>=</span>config-demo view --minify
</span></span></code></pre></div><h2 id=créer-un-deuxième-fichier-de-configuration>Créer un deuxième fichier de configuration</h2><p>Dans votre répertoire <code>config-exercice</code>, créez un fichier nommé <code>config-demo-2</code> avec ce contenu:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>apiVersion: v1
</span></span><span style=display:flex><span>kind: Config
</span></span><span style=display:flex><span>preferences: <span style=color:#666>{}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>contexts:
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: ramp
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-ramp-up
</span></span></code></pre></div><p>Le fichier de configuration précédent définit un nouveau contexte nommé <code>dev-ramp-up</code>.</p><h2 id=définissez-la-variable-d-environnement-kubeconfig>Définissez la variable d'environnement KUBECONFIG</h2><p>Vérifiez si vous avez une variable d'environnement nommée <code>KUBECONFIG</code>.
Si tel est le cas, enregistrez la valeur actuelle de votre variable d'environnement <code>KUBECONFIG</code>, afin de pouvoir la restaurer ultérieurement.
Par exemple:</p><h3 id=linux>Linux</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f>export</span> <span style=color:#b8860b>KUBECONFIG_SAVED</span><span style=color:#666>=</span><span style=color:#b8860b>$KUBECONFIG</span>
</span></span></code></pre></div><h3 id=windows-powershell>Windows PowerShell</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#b8860b>$Env</span>:KUBECONFIG_SAVED<span style=color:#666>=</span><span style=color:#b8860b>$ENV</span>:KUBECONFIG
</span></span></code></pre></div><p>La variable d'environnement <code>KUBECONFIG</code> est une liste de chemins vers les fichiers de configuration.
La liste est délimitée par deux-points pour Linux et Mac et par des points-virgules pour Windows.
Si vous avez une variable d'environnement <code>KUBECONFIG</code>, familiarisez-vous avec les fichiers de configuration de la liste.</p><p>Ajoutez temporairement deux chemins à votre variable d'environnement <code>KUBECONFIG</code>.
Par exemple:</p><h3 id=linux-1>Linux</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f>export</span> <span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span><span style=color:#b8860b>$KUBECONFIG</span>:config-demo:config-demo-2
</span></span></code></pre></div><h3 id=windows-powershell-1>Windows PowerShell</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#b8860b>$Env</span>:KUBECONFIG<span style=color:#666>=(</span><span style=color:#b44>&#34;config-demo;config-demo-2&#34;</span><span style=color:#666>)</span>
</span></span></code></pre></div><p>Dans votre répertoire <code>config-exercice</code>, entrez cette commande:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config view
</span></span></code></pre></div><p>La sortie affiche les informations fusionnées de tous les fichiers répertoriés dans votre variable d'environnement <code>KUBECONFIG</code>.
En particulier, notez que les informations fusionnées ont le contexte <code>dev-ramp-up</code> du fichier <code>config-demo-2</code> et les trois contextes du fichier <code>config-demo</code>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>contexts:
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: frontend
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-frontend
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: ramp
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-ramp-up
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: development
</span></span><span style=display:flex><span>    namespace: storage
</span></span><span style=display:flex><span>    user: developer
</span></span><span style=display:flex><span>  name: dev-storage
</span></span><span style=display:flex><span>- context:
</span></span><span style=display:flex><span>    cluster: scratch
</span></span><span style=display:flex><span>    namespace: default
</span></span><span style=display:flex><span>    user: experimenter
</span></span><span style=display:flex><span>  name: exp-scratch
</span></span></code></pre></div><p>Pour plus d'informations sur la manière dont les fichiers kubeconfig sont fusionnés, consultez <a href=/docs/concepts/configuration/organize-cluster-access-kubeconfig/>Organisation de l'accès au cluster à l'aide des fichiers kubeconfig</a></p><h2 id=explorez-le-répertoire-home-kube>Explorez le répertoire $HOME/.kube</h2><p>Si vous avez déjà un cluster, et vous pouvez utiliser <code>kubectl</code> pour interagir avec le cluster, alors vous avez probablement un fichier nommé <code>config</code> dans le repertoire <code>$HOME/.kube</code>.</p><p>Allez dans <code>$ HOME/.kube</code>, et voyez quels fichiers sont là.
En règle générale, il existe un fichier nommé <code>config</code>.
Il peut également y avoir d'autres fichiers de configuration dans ce répertoire.
Familiarisez-vous brièvement avec le contenu de ces fichiers.</p><h2 id=ajoutez-home-kube-config-à-votre-variable-d-environnement-kubeconfig>Ajoutez $HOME/.kube/config à votre variable d'environnement KUBECONFIG</h2><p>Si vous avez un fichier <code>$ HOME/.kube/config</code>, et qu'il n'est pas déjà répertorié dans votre variable d'environnement <code>KUBECONFIG</code>, ajoutez-le maintenant à votre variable d'environnement <code>KUBECONFIG</code>.
Par exemple:</p><h3 id=linux-2>Linux</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f>export</span> <span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span><span style=color:#b8860b>$KUBECONFIG</span>:<span style=color:#b8860b>$HOME</span>/.kube/config
</span></span></code></pre></div><h3 id=windows-powershell-2>Windows Powershell</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#b8860b>$Env</span>:KUBECONFIG<span style=color:#666>=</span><span style=color:#b44>&#34;</span><span style=color:#b8860b>$Env</span><span style=color:#b44>:KUBECONFIG;</span><span style=color:#b8860b>$HOME</span><span style=color:#b44>\.kube\config&#34;</span>
</span></span></code></pre></div><p>Affichez les informations de configuration fusionnées à partir de tous les fichiers qui sont maintenant répertoriés dans votre variable d'environnement <code>KUBECONFIG</code>.
Dans votre répertoire config-exercice, entrez:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl config view
</span></span></code></pre></div><h2 id=nettoyage>Nettoyage</h2><p>Remettez votre variable d'environnement <code>KUBECONFIG</code> à sa valeur d'origine.</p><p>Par exemple:</p><h3 id=linux-3>Linux</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#a2f>export</span> <span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span><span style=color:#b8860b>$KUBECONFIG_SAVED</span>
</span></span></code></pre></div><h3 id=windows-powershell-3>Windows PowerShell</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#b8860b>$Env</span>:KUBECONFIG<span style=color:#666>=</span><span style=color:#b8860b>$ENV</span>:KUBECONFIG_SAVED
</span></span></code></pre></div><h2 id=a-suivre>A suivre</h2><ul><li><a href=/docs/concepts/configuration/organize-cluster-access-kubeconfig/>Organisation de l'accès au cluster à l'aide des fichiers kubeconfig</a></li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#config>kubectl config</a></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-48e8f306f919c5b81265e265a2b76ab4>3 - Lister toutes les images de conteneur exécutées dans un cluster</h1><p>Cette page montre comment utiliser kubectl pour répertorier toutes les images de conteneur pour les pods s'exécutant dans un cluster.</p><h2 id=pré-requis>Pré-requis</h2><p><p>Vous devez disposer d'un cluster Kubernetes et l'outil de ligne de commande kubectl doit être configuré pour communiquer avec votre cluster.
Si vous ne possédez pas déjà de cluster, vous pouvez en créer un en utilisant <a href=/docs/setup/minikube>Minikube</a>, ou vous pouvez utiliser l'un de ces environnements Kubernetes:</p><ul><li><a href=https://killercoda.com/playgrounds/scenario/kubernetes>Killercoda</a></li><li><a href=http://labs.play-with-k8s.com/>Play with Kubernetes</a></li></ul>Pour consulter la version, entrez <code>kubectl version</code>.</p><p>Dans cet exercice, vous allez utiliser kubectl pour récupérer tous les pods exécutés dans un cluster et formater la sortie pour extraire la liste des conteneurs pour chacun.</p><h2 id=répertorier-toutes-les-images-de-conteneurs-dans-tous-les-namespaces>Répertorier toutes les images de conteneurs dans tous les namespaces</h2><ul><li>Récupérez tous les pods dans tous les namespace à l'aide de <code>kubectl get pods --all-namespaces</code></li><li>Formatez la sortie pour inclure uniquement la liste des noms d'image de conteneur à l'aide de <code>-o jsonpath={.items[*].spec.containers[*].image}</code>.
Cela analysera récursivement le champ <code>image</code> du json retourné.<ul><li>Voir la <a href=/docs/reference/kubectl/jsonpath/>reference jsonpath</a> pour plus d'informations sur l'utilisation de jsonpath.</li></ul></li><li>Formatez la sortie à l'aide des outils standard: <code>tr</code>, <code>sort</code>, <code>uniq</code><ul><li>Utilisez <code>tr</code> pour remplacer les espaces par des nouvelles lignes</li><li>Utilisez <code>sort</code> pour trier les résultats</li><li>Utilisez <code>uniq</code> pour agréger le nombre d'images</li></ul></li></ul><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*].spec.containers[*].image}&#34;</span> |<span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>tr -s <span style=color:#b44>&#39;[[:space:]]&#39;</span> <span style=color:#b44>&#39;\n&#39;</span> |<span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>sort |<span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>uniq -c
</span></span></code></pre></div><p>La commande ci-dessus renverra récursivement tous les champs nommés <code>image</code> pour tous les éléments retournés.</p><p>Comme alternative, il est possible d'utiliser le chemin absolu vers le champ d'image dans le Pod.
Cela garantit que le champ correct est récupéré même lorsque le nom du champ est répété, par ex. de nombreux champs sont appelés <code>name</code> dans un élément donné:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*].spec.containers[*].image}&#34;</span>
</span></span></code></pre></div><p>Le jsonpath est interprété comme suit:</p><ul><li><code>.items[*]</code>: pour chaque valeur renvoyée</li><li><code>.spec</code>: obtenir les spécifications</li><li><code>.containers[*]</code>: pour chaque conteneur</li><li><code>.image</code>: obtenir l'image</li></ul><div class="alert alert-info note callout" role=alert><strong>Note:</strong> Lors de la récupération d'un seul pod par son nom, par exemple <code>kubectl get pod nginx</code>, la portion <code>.items[*]</code> du chemin doit être omis car un seul pod est renvoyé au lieu d'une liste d'éléments.</div><h2 id=liste-des-images-de-conteneurs-par-pod>Liste des images de conteneurs par pod</h2><p>Le formatage peut être contrôlé davantage en utilisant l'opération <code>range</code> pour parcourir les éléments individuellement.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{&#34;\n&#34;}{.metadata.name}{&#34;:\t&#34;}{range .spec.containers[*]}{.image}{&#34;, &#34;}{end}{end}&#39;</span> |<span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>sort
</span></span></code></pre></div><h2 id=filtrage-des-images-de-conteneur-de-liste-par-label-de-pod>Filtrage des images de conteneur de liste par label de pod</h2><p>Pour cibler uniquement les pods correspondant à un label spécifique, utilisez l'indicateur -l.
Les éléments suivants correspondent uniquement aux pods avec les labels <code>app=nginx</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*].spec.containers[*].image}&#34;</span> -l <span style=color:#b8860b>app</span><span style=color:#666>=</span>nginx
</span></span></code></pre></div><h2 id=filtrage-des-images-de-conteneur-de-liste-par-namespace-de-pod>Filtrage des images de conteneur de liste par namespace de pod</h2><p>Pour cibler uniquement les pods dans un namespace spécifique, utilisez l'indicateur de namespace.
Ce qui suit correspond uniquement aux pods du namespace <code>kube-system</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --namespace kube-system -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*].spec.containers[*].image}&#34;</span>
</span></span></code></pre></div><h2 id=répertorier-les-images-de-conteneurs-en-utilisant-un-go-template-au-lieu-de-jsonpath>Répertorier les images de conteneurs en utilisant un go-template au lieu de jsonpath</h2><p>Comme alternative à jsonpath, Kubectl peut aussi utiliser les <a href=https://golang.org/pkg/text/template/>go-templates</a> pour formater la sortie:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods --all-namespaces -o go-template --template<span style=color:#666>=</span><span style=color:#b44>&#34;{{range .items}}{{range .spec.containers}}{{.image}} {{end}}{{end}}&#34;</span>
</span></span></code></pre></div><h2 id=a-suivre>A suivre</h2><h3 id=reference>Reference</h3><ul><li>Guide de référence pour <a href=/docs/reference/kubectl/jsonpath/>Jsonpath</a></li><li>Guide de référence pour les <a href=https://golang.org/pkg/text/template/>Go template</a></li></ul></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/fr/docs/home/>Accueil</a>
<a class=text-white href=/fr/blog/>Blog</a>
<a class=text-white href=/fr/partners/>Partenaires</a>
<a class=text-white href=/fr/community/>Communauté</a>
<a class=text-white href=/fr/case-studies/>Études de cas</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Trademark Usage page</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>