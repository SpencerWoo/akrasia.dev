<!doctype html><html lang=fr class=no-js><head><meta name=robots content="noindex, nofollow"><link rel=alternate hreflang=en href=https://kubernetes.io/docs/reference/kubectl/><link rel=alternate hreflang=zh-cn href=https://kubernetes.io/zh-cn/docs/reference/kubectl/><link rel=alternate hreflang=ko href=https://kubernetes.io/ko/docs/reference/kubectl/><link rel=alternate hreflang=ja href=https://kubernetes.io/ja/docs/reference/kubectl/><link rel=alternate hreflang=de href=https://kubernetes.io/de/docs/reference/kubectl/><link rel=alternate hreflang=es href=https://kubernetes.io/es/docs/reference/kubectl/><link rel=alternate hreflang=pt-br href=https://kubernetes.io/pt-br/docs/reference/kubectl/><link rel=alternate hreflang=id href=https://kubernetes.io/id/docs/reference/kubectl/><link rel=alternate hreflang=ru href=https://kubernetes.io/ru/docs/reference/kubectl/><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://kubernetes.io/fr/docs/reference/kubectl/><link rel="shortcut icon" type=image/png href=/images/favicon.png><link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=manifest href=/manifest.webmanifest><link rel=apple-touch-icon href=/images/kubernetes-192x192.png><title>CLI kubectl | Kubernetes</title><meta property="og:title" content="CLI kubectl"><meta property="og:description" content="kubectl CLI description"><meta property="og:type" content="website"><meta property="og:url" content="https://kubernetes.io/fr/docs/reference/kubectl/"><meta property="og:site_name" content="Kubernetes"><meta itemprop=name content="CLI kubectl"><meta itemprop=description content="kubectl CLI description"><meta name=twitter:card content="summary"><meta name=twitter:title content="CLI kubectl"><meta name=twitter:description content="kubectl CLI description"><link href=/scss/main.css rel=stylesheet><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","url":"https://kubernetes.io","logo":"https://kubernetes.io/images/favicon.png","potentialAction":{"@type":"SearchAction","target":"https://kubernetes.io/search/?q={search_term_string}","query-input":"required name=search_term_string"}}</script><meta name=theme-color content="#326ce5"><link rel=stylesheet href=/css/feature-states.css><meta name=description content="kubectl CLI description"><meta property="og:description" content="kubectl CLI description"><meta name=twitter:description content="kubectl CLI description"><meta property="og:url" content="https://kubernetes.io/fr/docs/reference/kubectl/"><meta property="og:title" content="CLI kubectl"><meta name=twitter:title content="CLI kubectl"><meta name=twitter:image content="https://kubernetes.io/images/favicon.png"><meta name=twitter:image:alt content="Kubernetes"><meta property="og:image" content="/images/kubernetes-horizontal-color.png"><meta property="og:type" content="article"><script src=/js/jquery-3.6.0.min.js intregrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar" data-auto-burger=primary><a class=navbar-brand href=/fr/></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-2 mb-lg-0"><a class="nav-link active" href=/fr/docs/>Documentation</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/blog/>Blog de Kubernetes</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/partners/>Partenaires</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/community/>Communauté</a></li><li class="nav-item mr-2 mb-lg-0"><a class=nav-link href=/fr/case-studies/>Études de cas</a></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdown role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Versions</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/fr/releases>Release Information</a>
<a class=dropdown-item href=https://kubernetes.io/fr/docs/reference/kubectl/>v1.25</a>
<a class=dropdown-item href=https://v1-24.docs.kubernetes.io/fr/docs/reference/kubectl/>v1.24</a>
<a class=dropdown-item href=https://v1-23.docs.kubernetes.io/fr/docs/reference/kubectl/>v1.23</a>
<a class=dropdown-item href=https://v1-22.docs.kubernetes.io/fr/docs/reference/kubectl/>v1.22</a>
<a class=dropdown-item href=https://v1-21.docs.kubernetes.io/fr/docs/reference/kubectl/>v1.21</a></div></li><li class="nav-item dropdown"><a class="nav-link dropdown-toggle" href=# id=navbarDropdownMenuLink role=button data-toggle=dropdown aria-haspopup=true aria-expanded=false>Français (French)</a><div class="dropdown-menu dropdown-menu-right" aria-labelledby=navbarDropdownMenuLink><a class=dropdown-item href=/docs/reference/kubectl/>English</a>
<a class=dropdown-item href=/zh-cn/docs/reference/kubectl/>中文 (Chinese)</a>
<a class=dropdown-item href=/ko/docs/reference/kubectl/>한국어 (Korean)</a>
<a class=dropdown-item href=/ja/docs/reference/kubectl/>日本語 (Japanese)</a>
<a class=dropdown-item href=/de/docs/reference/kubectl/>Deutsch (German)</a>
<a class=dropdown-item href=/es/docs/reference/kubectl/>Español (Spanish)</a>
<a class=dropdown-item href=/pt-br/docs/reference/kubectl/>Português (Portuguese)</a>
<a class=dropdown-item href=/id/docs/reference/kubectl/>Bahasa Indonesia</a>
<a class=dropdown-item href=/ru/docs/reference/kubectl/>Русский (Russian)</a></div></li></ul></div><button id=hamburger onclick=kub.toggleMenu() data-auto-burger-exclude><div></div></button></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>Version imprimable multipages.
<a href=# onclick="return print(),!1">Cliquer ici pour imprimer</a>.</p><p><a href=/fr/docs/reference/kubectl/>Retour à la version par défaut</a>.</p></div><h1 class=title>CLI kubectl</h1><div class=lead>kubectl CLI description</div><ul><li>1: <a href=#pg-f14fe15ecc2d41b5e901ef5e872ca657>Aperçu de kubectl</a></li><li>2: <a href=#pg-a938176c695852fe70362c29cf615f1c>Support de JSONPath</a></li><li>3: <a href=#pg-8aba901ac13f124e5782b90ddb166ee2>Aide-mémoire kubectl</a></li><li>4: <a href=#pg-d7ffbf04ffbefb241fd0722423b80f5a>Commandes kubectl</a></li><li>5: <a href=#pg-8de6aceb8bf692c06cced446bac5bc92>Conventions d'utilisation de kubectl</a></li><li>6: <a href=#pg-4d3e62632c189fcc3c1357cd8fb8799c>kubectl</a></li></ul><div class=content></div></div><div class=td-content><h1 id=pg-f14fe15ecc2d41b5e901ef5e872ca657>1 - Aperçu de kubectl</h1><div class=lead>kubectl référence</div><p>Kubectl est un outil en ligne de commande pour contrôler des clusters Kubernetes. <code>kubectl</code> recherche un fichier appelé config dans le répertoire $HOME/.kube. Vous pouvez spécifier d'autres fichiers [kubeconfig](https://kube
rnetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/) en définissant la variable d'environnement KUBECONFIG ou en utilisant le paramètre <a href=https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/><code>--kubeconfig</code></a>.</p><p>Cet aperçu couvre la syntaxe <code>kubectl</code>, décrit les opérations et fournit des exemples classiques. Pour des détails sur chaque commande, incluant toutes les options et sous-commandes autorisées, voir la documentation de référence de <a href=/docs/reference/generated/kubectl/kubectl-commands/>kubectl</a>. Pour des instructions d'installation, voir <a href=/docs/tasks/kubectl/install/>installer kubectl</a>.</p><h2 id=syntaxe>Syntaxe</h2><p>Utilisez la syntaxe suivante pour exécuter des commandes <code>kubectl</code> depuis votre fenêtre de terminal :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>commande<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NOM<span style=color:#666>]</span> <span style=color:#666>[</span>flags<span style=color:#666>]</span>
</span></span></code></pre></div><p>où <code>commande</code>, <code>TYPE</code>, <code>NOM</code> et <code>flags</code> sont :</p><ul><li><p><code>commande</code>: Indique l'opération que vous désirez exécuter sur une ou plusieurs ressources, par exemple <code>create</code>, <code>get</code>, <code>describe</code>, <code>delete</code>.</p></li><li><p><code>TYPE</code>: Indique le <a href=#resource-types>type de ressource</a>. Les types de ressources sont insensibles à la casse et vous pouvez utiliser les formes singulier, pluriel ou abrégé. Par exemple, les commandes suivantes produisent le même résultat :</p><pre><code>```shell
$ kubectl get pod pod1
$ kubectl get pods pod1
$ kubectl get po pod1
```
</code></pre></li><li><p><code>NOM</code>: Indique le nom de la ressource. Les noms sont sensibles à la casse. Si le nom est omis, des détails pour toutes les ressources sont affichés, par exemple <code>$ kubectl get pods</code>.</p><p>En effectuant une opération sur plusieurs ressources, vous pouvez soit indiquer chaque ressource par leur type et nom soit indiquer un ou plusieurs fichiers :</p><ul><li><p>Pour indiquer des ressources par leur type et nom :</p><ul><li><p>Pour regrouper des ressources si elles ont toutes le même type : <code>TYPE1 nom1 nom2 nom&lt;#></code>.<br>Example: <code>$ kubectl get pod exemple-pod1 exemple-pod2</code></p></li><li><p>Pour indiquer plusieurs types de ressources individuellement : <code>TYPE1/nom1 TYPE1/nom2 TYPE2/nom3 TYPE&lt;#>/nom&lt;#></code>.<br>Exemple: <code>$ kubectl get pod/exemple-pod1 replicationcontroller/exemple-rc1</code></p></li></ul></li><li><p>Pour indiquer des ressources avec un ou plusieurs fichiers : <code>-f fichier1 -f fichier2 -f fichier&lt;#></code></p><ul><li><a href=/docs/concepts/configuration/overview/#general-configuration-tips>Utilisez YAML plutôt que JSON</a>, YAML tendant à être plus facile à utiliser, particulièrement pour des fichiers de configuration.<br>Exemple: <code>$ kubectl get pod -f ./pod.yaml</code></li></ul></li></ul></li><li><p><code>flags</code>: Indique des flags optionnels. Par exemple, vous pouvez utiliser les flags <code>-s</code> ou <code>--server</code> pour indiquer l'adresse et le port de l'API server Kubernetes.<br></p></li></ul><div class="alert alert-warning caution callout" role=alert><strong>Avertissement:</strong> Les flags indiqués en ligne de commande écrasent les valeurs par défaut et les variables d'environnement correspondantes.</div><p>Si vous avez besoin d'aide, exécutez <code>kubectl help</code> depuis la fenêtre de terminal.</p><h2 id=opérations>Opérations</h2><p>Le tableau suivant inclut une courte description et la syntaxe générale pour chaque opération <code>kubectl</code> :</p><table><thead><tr><th>Opération</th><th>Syntaxe</th><th>Description</th></tr></thead><tbody><tr><td><code>alpha</code></td><td><code>kubectl alpha SOUS-COMMANDE [flags]</code></td><td>Liste les commandes disponibles qui correspondent à des fonctionnalités alpha, qui ne sont pas activées par défaut dans les clusters Kubernetes.</td></tr><tr><td><code>annotate</code></td><td><code>kubectl annotate (-f FICHIER | TYPE NOM | TYPE/NOM) CLE_1=VAL_1 ... CLE_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]</code></td><td>Ajoute ou modifie les annotations d'une ou plusieurs ressources.</td></tr><tr><td><code>api-resources</code></td><td><code>kubectl api-resources [flags]</code></td><td>Liste les ressources d'API disponibles.</td></tr><tr><td><code>api-versions</code></td><td><code>kubectl api-versions [flags]</code></td><td>Liste les versions d'API disponibles.</td></tr><tr><td><code>apply</code></td><td><code>kubectl apply -f FICHIER [flags]</code></td><td>Applique un changement de configuration à une ressource depuis un fichier ou stdin.</td></tr><tr><td><code>attach</code></td><td><code>kubectl attach POD -c CONTENEUR [-i] [-t] [flags]</code></td><td>Attache à un conteneur en cours d'exécution soit pour voir la sortie standard soit pour interagir avec le conteneur (stdin).</td></tr><tr><td><code>auth</code></td><td><code>kubectl auth [flags] [options]</code></td><td>Inspecte les autorisations.</td></tr><tr><td><code>autoscale</code></td><td><code>kubectl autoscale (-f FICHIER | TYPE NOM | TYPE/NOM) [--min=MINPODS] --max=MAXPODS [--cpu-percent=CPU] [flags]</code></td><td>Scale automatiquement l'ensemble des pods gérés par un replication controller.</td></tr><tr><td><code>certificate</code></td><td><code>kubectl certificate SOUS-COMMANDE [options]</code></td><td>Modifie les ressources de type certificat.</td></tr><tr><td><code>cluster-info</code></td><td><code>kubectl cluster-info [flags]</code></td><td>Affiche les informations des endpoints du master et des services du cluster.</td></tr><tr><td><code>completion</code></td><td><code>kubectl completion SHELL [options]</code></td><td>Affiche le code de complétion pour le shell spécifié (bash ou zsh).</td></tr><tr><td><code>config</code></td><td><code>kubectl config SOUS-COMMANDE [flags]</code></td><td>Modifie les fichiers kubeconfig. Voir les sous-commandes individuelles pour plus de détails.</td></tr><tr><td><code>convert</code></td><td><code>kubectl convert -f FICHIER [options]</code></td><td>Convertit des fichiers de configuration entre différentes versions d'API. Les formats YAML et JSON sont acceptés.</td></tr><tr><td><code>cordon</code></td><td><code>kubectl cordon NOEUD [options]</code></td><td>Marque un nœud comme non programmable.</td></tr><tr><td><code>cp</code></td><td><code>kubectl cp &lt;ficher-src> &lt;fichier-dest> [options]</code></td><td>Copie des fichiers et des répertoires vers et depuis des conteneurs.</td></tr><tr><td><code>create</code></td><td><code>kubectl create -f FICHIER [flags]</code></td><td>Crée une ou plusieurs ressources depuis un fichier ou stdin.</td></tr><tr><td><code>delete</code></td><td><code>kubectl delete (-f FICHIER | TYPE [NOM | /NOM | -l label | --all]) [flags]</code></td><td>Supprime des ressources soit depuis un fichier ou stdin, ou en indiquant des sélecteurs de label, des noms, des sélecteurs de ressources ou des ressources.</td></tr><tr><td><code>describe</code></td><td><code>kubectl describe (-f FICHIER | TYPE [PREFIXE_NOM | /NOM | -l label]) [flags]</code></td><td>Affiche l'état détaillé d'une ou plusieurs ressources.</td></tr><tr><td><code>diff</code></td><td><code>kubectl diff -f FICHIER [flags]</code></td><td>Diff un fichier ou stdin par rapport à la configuration en cours</td></tr><tr><td><code>drain</code></td><td><code>kubectl drain NOEUD [options]</code></td><td>Vide un nœud en préparation de sa mise en maintenance.</td></tr><tr><td><code>edit</code></td><td><code>kubectl edit (-f FICHIER | TYPE NOM | TYPE/NOM) [flags]</code></td><td>Édite et met à jour la définition d'une ou plusieurs ressources sur le serveur en utilisant l'éditeur par défaut.</td></tr><tr><td><code>exec</code></td><td><code>kubectl exec POD [-c CONTENEUR] [-i] [-t] [flags] [-- COMMANDE [args...]]</code></td><td>Exécute une commande à l'intérieur d'un conteneur dans un pod.</td></tr><tr><td><code>explain</code></td><td><code>kubectl explain [--recursive=false] [flags]</code></td><td>Obtient des informations sur différentes ressources. Par exemple pods, nœuds, services, etc.</td></tr><tr><td><code>expose</code></td><td><code>kubectl expose (-f FICHIER | TYPE NOM | TYPE/NOM) [--port=port] [--protocol=TCP|UDP] [--target-port=nombre-ou-nom] [--name=nom] [--external-ip=ip-externe-ou-service] [--type=type] [flags]</code></td><td>Expose un replication controller, service ou pod comme un nouveau service Kubernetes.</td></tr><tr><td><code>get</code></td><td><code>kubectl get (-f FICHIER | TYPE [NOM | /NOM | -l label]) [--watch] [--sort-by=CHAMP] [[-o | --output]=FORMAT_AFFICHAGE] [flags]</code></td><td>Liste une ou plusieurs ressources.</td></tr><tr><td><code>kustomize</code></td><td><code>kubectl kustomize &lt;répertoire> [flags] [options]</code></td><td>Liste un ensemble de ressources d'API généré à partir d'instructions d'un fichier kustomization.yaml. Le paramètre doit être le chemin d'un répertoire contenant ce fichier, ou l'URL d'un dépôt git incluant un suffixe de chemin par rapport à la racine du dépôt.</td></tr><tr><td><code>label</code></td><td><code>kubectl label (-f FICHIER | TYPE NOM | TYPE/NOM) CLE_1=VAL_1 ... CLE_N=VAL_N [--overwrite] [--all] [--resource-version=version] [flags]</code></td><td>Ajoute ou met à jour les labels d'une ou plusieurs ressources.</td></tr><tr><td><code>logs</code></td><td><code>kubectl logs POD [-c CONTENEUR] [--follow] [flags]</code></td><td>Affiche les logs d'un conteneur dans un pod.</td></tr><tr><td><code>options</code></td><td><code>kubectl options</code></td><td>Liste des options globales, s'appliquant à toutes commandes.</td></tr><tr><td><code>patch</code></td><td><code>kubectl patch (-f FICHIER | TYPE NOM | TYPE/NOM) --patch PATCH [flags]</code></td><td>Met à jour un ou plusieurs champs d'une resource en utilisant le processus de merge patch stratégique.</td></tr><tr><td><code>plugin</code></td><td><code>kubectl plugin [flags] [options]</code></td><td>Fournit des utilitaires pour interagir avec des plugins.</td></tr><tr><td><code>port-forward</code></td><td><code>kubectl port-forward POD [PORT_LOCAL:]PORT_DISTANT [...[PORT_LOCAL_N:]PORT_DISTANT_N] [flags]</code></td><td>Transfère un ou plusieurs ports locaux vers un pod.</td></tr><tr><td><code>proxy</code></td><td><code>kubectl proxy [--port=PORT] [--www=static-dir] [--www-prefix=prefix] [--api-prefix=prefix] [flags]</code></td><td>Exécute un proxy vers un API server Kubernetes.</td></tr><tr><td><code>replace</code></td><td><code>kubectl replace -f FICHIER</code></td><td>Remplace une ressource depuis un fichier ou stdin.</td></tr><tr><td><code>rollout</code></td><td><code>kubectl rollout SOUS-COMMANDE [options]</code></td><td>Gère le rollout d'une ressource. Les types de ressources valides sont : deployments, daemonsets et statefulsets.</td></tr><tr><td><code>run</code></td><td><code>kubectl run NOM --image=image [--env="cle=valeur"] [--port=port] [--replicas=replicas] [--dry-run=server&amp;#124;client&amp;#124;none] [--overrides=inline-json] [flags]</code></td><td>Exécute dans le cluster l'image indiquée.</td></tr><tr><td><code>scale</code></td><td><code>kubectl scale (-f FICHIER | TYPE NOM | TYPE/NOM) --replicas=QUANTITE [--resource-version=version] [--current-replicas=quantité] [flags]</code></td><td>Met à jour la taille du replication controller indiqué.</td></tr><tr><td><code>set</code></td><td><code>kubectl set SOUS-COMMANDE [options]</code></td><td>Configure les ressources de l'application.</td></tr><tr><td><code>taint</code></td><td><code>kubectl taint NOEUD NNOM CLE_1=VAL_1:EFFET_TAINT_1 ... CLE_N=VAL_N:EFFET_TAINT_N [options]</code></td><td>Met à jour les marques (taints) d'un ou plusieurs nœuds.</td></tr><tr><td><code>top</code></td><td><code>kubectl top [flags] [options]</code></td><td>Affiche l'utilisation des ressources (CPU/Mémoire/Stockage).</td></tr><tr><td><code>uncordon</code></td><td><code>kubectl uncordon NOEUD [options]</code></td><td>Marque un noeud comme programmable.</td></tr><tr><td><code>version</code></td><td><code>kubectl version [--client] [flags]</code></td><td>Affiche la version de Kubernetes du serveur et du client.</td></tr><tr><td><code>wait</code></td><td><code>kubectl wait ([-f FICHIER] | ressource.groupe/ressource.nom | ressource.groupe [(-l label | --all)]) [--for=delete|--for condition=available] [options]</code></td><td>Expérimental : Attend un condition spécifique sur une ou plusieurs ressources.</td></tr></tbody></table><p>Rappelez-vous : Pour tout savoir sur les opérations, voir la documentation de référence de <a href=/docs/user-guide/kubectl/>kubectl</a>.</p><h2 id=types-de-ressources>Types de ressources</h2><p>Le tableau suivant inclut la liste de tous les types de ressources pris en charge et leurs alias abrégés.</p><p>(cette sortie peut être obtenue depuis <code>kubectl api-resources</code>, et correspond à Kubernetes 1.13.3.)</p><table><thead><tr><th>Nom de la ressource</th><th>Noms abrégés</th><th>Groupe API</th><th>Par namespace</th><th>Genre de la ressource</th></tr></thead><tbody><tr><td><code>bindings</code></td><td></td><td></td><td>true</td><td>Binding</td></tr><tr><td><code>componentstatuses</code></td><td><code>cs</code></td><td></td><td>false</td><td>ComponentStatus</td></tr><tr><td><code>configmaps</code></td><td><code>cm</code></td><td></td><td>true</td><td>ConfigMap</td></tr><tr><td><code>endpoints</code></td><td><code>ep</code></td><td></td><td>true</td><td>Endpoints</td></tr><tr><td><code>limitranges</code></td><td><code>limits</code></td><td></td><td>true</td><td>LimitRange</td></tr><tr><td><code>namespaces</code></td><td><code>ns</code></td><td></td><td>false</td><td>Namespace</td></tr><tr><td><code>nodes</code></td><td><code>no</code></td><td></td><td>false</td><td>Node</td></tr><tr><td><code>persistentvolumeclaims</code></td><td><code>pvc</code></td><td></td><td>true</td><td>PersistentVolumeClaim</td></tr><tr><td><code>persistentvolumes</code></td><td><code>pv</code></td><td></td><td>false</td><td>PersistentVolume</td></tr><tr><td><code>pods</code></td><td><code>po</code></td><td></td><td>true</td><td>Pod</td></tr><tr><td><code>podtemplates</code></td><td></td><td></td><td>true</td><td>PodTemplate</td></tr><tr><td><code>replicationcontrollers</code></td><td><code>rc</code></td><td></td><td>true</td><td>ReplicationController</td></tr><tr><td><code>resourcequotas</code></td><td><code>quota</code></td><td></td><td>true</td><td>ResourceQuota</td></tr><tr><td><code>secrets</code></td><td></td><td></td><td>true</td><td>Secret</td></tr><tr><td><code>serviceaccounts</code></td><td><code>sa</code></td><td></td><td>true</td><td>ServiceAccount</td></tr><tr><td><code>services</code></td><td><code>svc</code></td><td></td><td>true</td><td>Service</td></tr><tr><td><code>mutatingwebhookconfigurations</code></td><td></td><td>admissionregistration.k8s.io</td><td>false</td><td>MutatingWebhookConfiguration</td></tr><tr><td><code>validatingwebhookconfigurations</code></td><td></td><td>admissionregistration.k8s.io</td><td>false</td><td>ValidatingWebhookConfiguration</td></tr><tr><td><code>customresourcedefinitions</code></td><td><code>crd</code>, <code>crds</code></td><td>apiextensions.k8s.io</td><td>false</td><td>CustomResourceDefinition</td></tr><tr><td><code>apiservices</code></td><td></td><td>apiregistration.k8s.io</td><td>false</td><td>APIService</td></tr><tr><td><code>controllerrevisions</code></td><td></td><td>apps</td><td>true</td><td>ControllerRevision</td></tr><tr><td><code>daemonsets</code></td><td><code>ds</code></td><td>apps</td><td>true</td><td>DaemonSet</td></tr><tr><td><code>deployments</code></td><td><code>deploy</code></td><td>apps</td><td>true</td><td>Deployment</td></tr><tr><td><code>replicasets</code></td><td><code>rs</code></td><td>apps</td><td>true</td><td>ReplicaSet</td></tr><tr><td><code>statefulsets</code></td><td><code>sts</code></td><td>apps</td><td>true</td><td>StatefulSet</td></tr><tr><td><code>tokenreviews</code></td><td></td><td>authentication.k8s.io</td><td>false</td><td>TokenReview</td></tr><tr><td><code>localsubjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>true</td><td>LocalSubjectAccessReview</td></tr><tr><td><code>selfsubjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SelfSubjectAccessReview</td></tr><tr><td><code>selfsubjectrulesreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SelfSubjectRulesReview</td></tr><tr><td><code>subjectaccessreviews</code></td><td></td><td>authorization.k8s.io</td><td>false</td><td>SubjectAccessReview</td></tr><tr><td><code>horizontalpodautoscalers</code></td><td><code>hpa</code></td><td>autoscaling</td><td>true</td><td>HorizontalPodAutoscaler</td></tr><tr><td><code>cronjobs</code></td><td><code>cj</code></td><td>batch</td><td>true</td><td>CronJob</td></tr><tr><td><code>jobs</code></td><td></td><td>batch</td><td>true</td><td>Job</td></tr><tr><td><code>certificatesigningrequests</code></td><td><code>csr</code></td><td>certificates.k8s.io</td><td>false</td><td>CertificateSigningRequest</td></tr><tr><td><code>leases</code></td><td></td><td>coordination.k8s.io</td><td>true</td><td>Lease</td></tr><tr><td><code>events</code></td><td><code>ev</code></td><td>events.k8s.io</td><td>true</td><td>Event</td></tr><tr><td><code>ingresses</code></td><td><code>ing</code></td><td>extensions</td><td>true</td><td>Ingress</td></tr><tr><td><code>networkpolicies</code></td><td><code>netpol</code></td><td>networking.k8s.io</td><td>true</td><td>NetworkPolicy</td></tr><tr><td><code>poddisruptionbudgets</code></td><td><code>pdb</code></td><td>policy</td><td>true</td><td>PodDisruptionBudget</td></tr><tr><td><code>podsecuritypolicies</code></td><td><code>psp</code></td><td>policy</td><td>false</td><td>PodSecurityPolicy</td></tr><tr><td><code>clusterrolebindings</code></td><td></td><td>rbac.authorization.k8s.io</td><td>false</td><td>ClusterRoleBinding</td></tr><tr><td><code>clusterroles</code></td><td></td><td>rbac.authorization.k8s.io</td><td>false</td><td>ClusterRole</td></tr><tr><td><code>rolebindings</code></td><td></td><td>rbac.authorization.k8s.io</td><td>true</td><td>RoleBinding</td></tr><tr><td><code>roles</code></td><td></td><td>rbac.authorization.k8s.io</td><td>true</td><td>Role</td></tr><tr><td><code>priorityclasses</code></td><td><code>pc</code></td><td>scheduling.k8s.io</td><td>false</td><td>PriorityClass</td></tr><tr><td><code>csidrivers</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>CSIDriver</td></tr><tr><td><code>csinodes</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>CSINode</td></tr><tr><td><code>storageclasses</code></td><td><code>sc</code></td><td>storage.k8s.io</td><td>false</td><td>StorageClass</td></tr><tr><td><code>volumeattachments</code></td><td></td><td>storage.k8s.io</td><td>false</td><td>VolumeAttachment</td></tr></tbody></table><h2 id=options-de-sortie>Options de sortie</h2><p>Utilisez les sections suivantes pour savoir comment vous pouvez formater ou ordonner les sorties de certaines commandes.
Pour savoir exactgement quelles commandes prennent en charge quelles options de sortie, voir la documentation de référence de <a href=/docs/user-guide/kubectl/>kubectl</a>.</p><h3 id=formater-la-sortie>Formater la sortie</h3><p>Le format de sortie par défaut pour toutes les commandes <code>kubectl</code> est le format texte lisible par l'utilisateur. Pour afficher des détails dans votre fenêtre de terminal dans un format spécifique, vous pouvez ajouter une des options <code>-o</code> ou <code>--output</code> à une des commandes <code>kubectl</code> les prenant en charge.</p><h4 id=syntaxe-1>Syntaxe</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>commande<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NOM<span style=color:#666>]</span> -o &lt;format_sortie&gt;
</span></span></code></pre></div><p>Selon l'opération <code>kubectl</code>, les formats de sortie suivants sont pris en charge :</p><table><thead><tr><th>Format de sortie</th><th>Description</th></tr></thead><tbody><tr><td><code>-o custom-columns=&lt;spec></code></td><td>Affiche un tableau en utilisant une liste de <a href=#custom-columns>colonnes personnalisées</a> séparées par des virgules.</td></tr><tr><td><code>-o custom-columns-file=&lt;fichier></code></td><td>Affiche un tableau en utilisant un modèle de <a href=#custom-columns>colonnes personnalisées</a> dans le fichier <code>&lt;fichier></code>.</td></tr><tr><td><code>-o json</code></td><td>Affiche un objet de l'API formaté en JSON.</td></tr><tr><td><code>-o jsonpath=&lt;modèle></code></td><td>Affiche les champs définis par une expression <a href=/docs/reference/kubectl/jsonpath/>jsonpath</a>.</td></tr><tr><td><code>-o jsonpath-file=&lt;ffichier></code></td><td>Affiche les champs définis par une expression <a href=/docs/reference/kubectl/jsonpath/>jsonpath</a> dans le fichier <code>&lt;fichier></code>.</td></tr><tr><td><code>-o name</code></td><td>Affiche uniquement le nom de la ressource et rien de plus.</td></tr><tr><td><code>-o wide</code></td><td>Affiche dans le format texte avec toute information supplémentaire. Pour les pods, le nom du nœud est inclus.</td></tr><tr><td><code>-o yaml</code></td><td>Affiche un objet de l'API formaté en YAML.</td></tr></tbody></table><h5 id=exemple>Exemple</h5><p>Dans cet exemple, la commande suivante affiche les détails d'un unique pod sous forme d'un objet formaté en YAML :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl get pod web-pod-13je7 -o yaml
</span></span></code></pre></div><p>Souvenez-vous : Voir la documentation de référence de <a href=/docs/user-guide/kubectl/>kubectl</a> pour voir quels formats de sortie sont pris en charge par chaque commande.</p><h4 id=colonnes-personnalisées>Colonnes personnalisées</h4><p>Pour définir des colonnes personnalisées et afficher uniquement les détails voulus dans un tableau, vous pouvez utiliser l'option <code>custom-columns</code>. Vous pouvez choisir de définir les colonnes personnalisées soit en ligne soit dans un fichier modèle : <code>-o custom-columns=&lt;spec></code> ou <code>-o custom-columns-file=&lt;fichier></code>.</p><h5 id=exemples>Exemples</h5><p>En ligne :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl get pods &lt;nom-pod&gt; -o custom-columns<span style=color:#666>=</span>NOM:.metadata.name,RSRC:.metadata.resourceVersion
</span></span></code></pre></div><p>Fichier modèle :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl get pods &lt;nom-pod&gt; -o custom-columns-file<span style=color:#666>=</span>modele.txt
</span></span></code></pre></div><p>où le fichier <code>modele.txt</code> contient :</p><pre tabindex=0><code>NOM           RSRC
metadata.name metadata.resourceVersion
</code></pre><p>Le résultat de ces commandes est :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>NOM            RSRC
</span></span><span style=display:flex><span>submit-queue   <span style=color:#666>610995</span>
</span></span></code></pre></div><h4 id=colonnes-côté-serveur>Colonnes côté serveur</h4><p><code>kubectl</code> est capable de recevoir des informations de colonnes spécifiques d'objets depuis le serveur.
Cela veut dire que pour toute ressource donnée, le serveur va retourner les colonnes et lignes pour cette ressource, que le client pourra afficher.
Cela permet un affichage de sortie lisible par l'utilisateur cohérent entre les clients utilisés sur le même cluster, le serveur encapsulant les détails d'affichage.</p><p>Cette fonctionnalité est activée par défaut dans <code>kubectl</code> version 1.11 et suivantes. Pour la désactiver, ajoutez l'option
<code>--server-print=false</code> à la commande <code>kubectl get</code>.</p><h5 id=exemples-1>Exemples</h5><p>Pour afficher les informations sur le status d'un pod, utilisez une commande similaire à :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods &lt;nom-pod&gt; --server-print<span style=color:#666>=</span><span style=color:#a2f>false</span>
</span></span></code></pre></div><p>La sortie ressemble à :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>NAME       AGE
</span></span><span style=display:flex><span>nom-pod    1m
</span></span></code></pre></div><h3 id=ordonner-les-listes-d-objets>Ordonner les listes d'objets</h3><p>Pour afficher les objets dans une liste ordonnée dans une fenêtre de terminal, vous pouvez ajouter l'option <code>--sort-by</code> à une commande <code>kubectl</code> qui la prend en charge. Ordonnez vos objets en spécifiant n'importe quel champ numérique ou textuel avec l'option <code>--sort-by</code>. Pour spécifier un champ, utilisez une expression <a href=/docs/reference/kubectl/jsonpath/>jsonpath</a>.</p><h4 id=syntaxe-2>Syntaxe</h4><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl <span style=color:#666>[</span>commande<span style=color:#666>]</span> <span style=color:#666>[</span>TYPE<span style=color:#666>]</span> <span style=color:#666>[</span>NOM<span style=color:#666>]</span> --sort-by<span style=color:#666>=</span>&lt;exp_jsonpath&gt;
</span></span></code></pre></div><h5 id=exemple-1>Exemple</h5><p>Pour afficher une liste de pods ordonnés par nom, exécutez :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl get pods --sort-by<span style=color:#666>=</span>.metadata.name
</span></span></code></pre></div><h2 id=exemples-opérations-courantes>Exemples : Opérations courantes</h2><p>Utilisez les exemples suivants pour vous familiariser avec les opérations de <code>kubectl</code> fréquemment utilisées :</p><p><code>kubectl apply</code> - Créer une ressource depuis un fichier ou stdin.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Crée un service en utilisant la définition dans exemple-service.yaml.</span>
</span></span><span style=display:flex><span>$ kubectl apply -f exemple-service.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Crée un replication controller en utilisant la définition dans exemple-controller.yaml.</span>
</span></span><span style=display:flex><span>$ kubectl apply -f exemple-controller.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Crée les objets qui sont définis dans les fichiers .yaml, .yml ou .json du répertoire &lt;répertoire&gt;.</span>
</span></span><span style=display:flex><span>$ kubectl apply -f &lt;répertoire&gt;
</span></span></code></pre></div><p><code>kubectl get</code> - Liste une ou plusieurs ressources.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Liste tous les pods dans le format de sortie texte.</span>
</span></span><span style=display:flex><span>$ kubectl get pods
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste tous les pods dans le format de sortie texte et inclut des informations additionnelles (comme le nom du nœud).</span>
</span></span><span style=display:flex><span>$ kubectl get pods -o wide
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste le replication controller ayant le nom donné dans le format de sortie texte.</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Astuce : Vous pouvez raccourcir et remplacer le type de ressource &#39;replicationcontroller&#39; avec l&#39;alias &#39;rc&#39;.</span>
</span></span><span style=display:flex><span>$ kubectl get replicationcontroller &lt;nom-rc&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste ensemble tous les replication controller et les services dans le format de sortie texte.</span>
</span></span><span style=display:flex><span>$ kubectl get rc,services
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste tous les daemon sets dans le format de sortie texte.</span>
</span></span><span style=display:flex><span>kubectl get ds
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste tous les pods s&#39;exécutant sur le nœud serveur01</span>
</span></span><span style=display:flex><span>$ kubectl get pods --field-selector<span style=color:#666>=</span>spec.nodeName<span style=color:#666>=</span>serveur01
</span></span></code></pre></div><p><code>kubectl describe</code> - Affiche l'état détaillé d'une ou plusieurs ressources, en incluant par défaut les ressources non initialisées.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche les détails du nœud ayant le nom &lt;nom-nœud&gt;.</span>
</span></span><span style=display:flex><span>$ kubectl describe nodes &lt;nom-nœud&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche les détails du pod ayant le nom &lt;nom-pod&gt;.</span>
</span></span><span style=display:flex><span>$ kubectl describe pods/&lt;nom-pod&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche les détails de tous les pods gérés par le replication controller dont le nom est &lt;nom-rc&gt;.</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Rappelez-vous : les noms des pods étant créés par un replication controller sont préfixés par le nom du replication controller.</span>
</span></span><span style=display:flex><span>$ kubectl describe pods &lt;nom-rc&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Décrit tous les pods</span>
</span></span><span style=display:flex><span>$ kubectl describe pods
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Note:</strong> La commande <code>kubectl get</code> est habituellement utilisée pour afficher une ou plusieurs ressources d'un même type. Elle propose un ensemble complet d'options permettant de personnaliser le format de sortie avec les options <code>-o</code> ou <code>--output</code>, par exemple.
Vous pouvez utiliser les options <code>-w</code> ou <code>--watch</code> pour initier l'écoute des modifications d'un objet particulier. La commande <code>kubectl describe</code> est elle plutôt utilisée pour décrire les divers aspects d'une ressource voulue. Elle peut invoquer plusieurs appels d'API à l'API server pour construire une vue complète pour l'utilisateur. Par exemple, la commande <code>kubectl describe node</code> retourne non seulement les informations sur les nœuds, mais aussi un résumé des pods s'exécutant dessus, les événements générés pour chaque nœud, etc.nœud</div><p><code>kubectl delete</code> - Supprime des ressources soit depuis un fichier, stdin, ou en spécifiant des sélecteurs de labels, des noms, des sélecteurs de ressource ou des ressources.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Supprime un pod en utilisant le type et le nom spécifiés dans le fichier pod.yaml.</span>
</span></span><span style=display:flex><span>$ kubectl delete -f pod.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Supprime tous les pods et services ayant le label &lt;clé-label&gt;=&lt;valeur-label&gt;</span>
</span></span><span style=display:flex><span>$ kubectl delete pods,services -l &lt;clé-label&gt;<span style=color:#666>=</span>&lt;valeur-label&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Supprime tous les pods, en incluant les non initialisés.</span>
</span></span><span style=display:flex><span>$ kubectl delete pods --all
</span></span></code></pre></div><p><code>kubectl exec</code> - Exécute une commande depuis un conteneur d'un pod.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche la sortie de la commande &#39;date&#39; depuis le pod &lt;nom-pod&gt;. Par défaut, la sortie se fait depuis le premier conteneur.</span>
</span></span><span style=display:flex><span>$ kubectl <span style=color:#a2f>exec</span> &lt;nom-pod&gt; -- date
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche la sortie de la commande &#39;date&#39; depuis le conteneur &lt;nom-conteneur&gt; du pod &lt;nom-pod&gt;.</span>
</span></span><span style=display:flex><span>$ kubectl <span style=color:#a2f>exec</span> &lt;nom-pod&gt; -c &lt;nom-conteneur&gt; -- date
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Obtient un TTY interactif et exécute /bin/bash depuis le pod &lt;nom-pod&gt;. Par défaut, la sortie se fait depuis le premier conteneur.</span>
</span></span><span style=display:flex><span>$ kubectl <span style=color:#a2f>exec</span> -ti &lt;nom-pod&gt; -- /bin/bash
</span></span></code></pre></div><p><code>kubectl logs</code> - Affiche les logs d'un conteneur dans un pod.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Retourne un instantané des logs du pod &lt;nom-pod&gt;.</span>
</span></span><span style=display:flex><span>$ kubectl logs &lt;nom-pod&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Commence à streamer les logs du pod &lt;nom-pod&gt;. Ceci est similaire à la commande Linux &#39;tail -f&#39;.</span>
</span></span><span style=display:flex><span>$ kubectl logs -f &lt;nom-pod&gt;
</span></span></code></pre></div><p><code>kubectl diff</code> - Affiche un diff des mises à jour proposées au cluster.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># Diff les ressources présentes dans &#34;pod.json&#34;.</span>
</span></span><span style=display:flex><span>kubectl diff -f pod.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Diff les ressources présentes dans le fichier lu sur l&#39;entrée standard.</span>
</span></span><span style=display:flex><span>cat service.yaml | kubectl diff -f -
</span></span></code></pre></div><h2 id=exemples-créer-et-utiliser-des-plugins>Exemples : Créer et utiliser des plugins</h2><p>Utilisez les exemples suivants pour vous familiariser avec l'écriture et l'utilisation de plugins <code>kubectl</code> :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># créez un plugin simple dans n&#39;importe quel langage et nommez</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># l&#39;exécutable de telle sorte qu&#39;il commence par &#34;kubectl-&#34;</span>
</span></span><span style=display:flex><span>$ cat ./kubectl-hello
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ce plugin affiche les mots &#34;hello world&#34;</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;hello world&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># une fois votre plugin écrit, rendez-le exécutable</span>
</span></span><span style=display:flex><span>$ sudo chmod +x ./kubectl-hello
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># et déplacez-le dans un répertoire de votre PATH</span>
</span></span><span style=display:flex><span>$ sudo mv ./kubectl-hello /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># vous avez maintenant créé et &#34;installé&#34; un plugin kubectl.</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># vous pouvez commencer à l&#39;utiliser en l&#39;invoquant depuis kubectl</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># comme s&#39;il s&#39;agissait d&#39;une commande ordinaire</span>
</span></span><span style=display:flex><span>$ kubectl hello
</span></span><span style=display:flex><span>hello world
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># vous pouvez &#34;désinstaller&#34; un plugin,</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># simplement en le supprimant de votre PATH</span>
</span></span><span style=display:flex><span>$ sudo rm /usr/local/bin/kubectl-hello
</span></span></code></pre></div><p>Pour voir tous les plugins disponibles pour <code>kubectl</code>, vous pouvez utiliser la sous-commande <code>kubectl plugin list</code> :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ kubectl plugin list
</span></span><span style=display:flex><span>The following kubectl-compatible plugins are available:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/usr/local/bin/kubectl-hello
</span></span><span style=display:flex><span>/usr/local/bin/kubectl-foo
</span></span><span style=display:flex><span>/usr/local/bin/kubectl-bar
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># cette commande peut aussi vous avertir de plugins qui ne sont pas exécutables,</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ou qui sont cachés par d&#39;autres plugins, par exemple :</span>
</span></span><span style=display:flex><span>$ sudo chmod -x /usr/local/bin/kubectl-foo
</span></span><span style=display:flex><span>$ kubectl plugin list
</span></span><span style=display:flex><span>The following kubectl-compatible plugins are available:
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/usr/local/bin/kubectl-hello
</span></span><span style=display:flex><span>/usr/local/bin/kubectl-foo
</span></span><span style=display:flex><span>  - warning: /usr/local/bin/kubectl-foo identified as a plugin, but it is not executable
</span></span><span style=display:flex><span>/usr/local/bin/kubectl-bar
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>error: one plugin warning was found
</span></span></code></pre></div><p>Vous pouvez voir les plugins comme un moyen de construire des fonctionnalités plus complexes au dessus des commandes kubectl existantes :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>$ cat ./kubectl-whoami
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># ce plugin utilise la commande `kubectl config` pour afficher</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># l&#39;information sur l&#39;utilisateur courant, en se basant sur</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># le contexte couramment sélectionné</span>
</span></span><span style=display:flex><span>kubectl config view --template<span style=color:#666>=</span><span style=color:#b44>&#39;{{ range .contexts }}{{ if eq .name &#34;&#39;</span><span style=color:#a2f;font-weight:700>$(</span>kubectl config current-context<span style=color:#a2f;font-weight:700>)</span><span style=color:#b44>&#39;&#34; }}Current user: {{ printf &#34;%s\n&#34; .context.user }}{{ end }}{{ end }}&#39;</span>
</span></span></code></pre></div><p>Exécuter le plugin ci-dessus vous donne une sortie contenant l'utilisateur du contexte couramment sélectionné dans votre fichier KUBECONFIG :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#080;font-style:italic># rendre le fichier exécutable executable</span>
</span></span><span style=display:flex><span>$ sudo chmod +x ./kubectl-whoami
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># et le déplacer dans le PATH</span>
</span></span><span style=display:flex><span>$ sudo mv ./kubectl-whoami /usr/local/bin
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ kubectl whoami
</span></span><span style=display:flex><span>Current user: plugins-user
</span></span></code></pre></div><p>Pour en savoir plus sur les plugins, examinez <a href=https://github.com/kubernetes/sample-cli-plugin>l'exemple de plugin CLI</a>.</p><h2 id=a-suivre>A suivre</h2><p>Commencez à utiliser les commandes <a href=/docs/reference/generated/kubectl/kubectl-commands/>kubectl</a>.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-a938176c695852fe70362c29cf615f1c>2 - Support de JSONPath</h1><div class=lead>JSONPath kubectl Kubernetes</div><p>Kubectl prend en charge les modèles JSONPath.</p><p>Un modèle JSONPath est composé d'expressions JSONPath entourées par des accolades {}.
Kubectl utilise les expressions JSONPath pour filtrer sur des champs spécifiques de l'objet JSON et formater la sortie.
En plus de la syntaxe de modèle JSONPath originale, les fonctions et syntaxes suivantes sont valides :</p><ol><li>Utilisez des guillemets doubles pour marquer du texte dans les expressions JSONPath.</li><li>Utilisez les opérateurs <code>range</code> et <code>end</code> pour itérer sur des listes.</li><li>Utilisez des indices négatifs pour parcourir une liste à reculons. Les indices négatifs ne "bouclent pas" sur une liste et sont valides tant que <code>-index + longeurListe >= 0</code>.</li></ol><div class="alert alert-info note callout" role=alert><strong>Note:</strong><ul><li><p>L'opérateur <code>$</code> est optionnel, l'expression commençant toujours, par défaut, à la racine de l'objet.</p></li><li><p>L'objet résultant est affiché via sa fonction String().</p></li></ul></div><p>Étant donné l'entrée JSON :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;kind&#34;</span>: <span style=color:#b44>&#34;List&#34;</span>,
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;items&#34;</span>:[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;kind&#34;</span>:<span style=color:#b44>&#34;None&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;metadata&#34;</span>:{<span style=color:green;font-weight:700>&#34;name&#34;</span>:<span style=color:#b44>&#34;127.0.0.1&#34;</span>},
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;status&#34;</span>:{
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;capacity&#34;</span>:{<span style=color:green;font-weight:700>&#34;cpu&#34;</span>:<span style=color:#b44>&#34;4&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;addresses&#34;</span>:[{<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;LegacyHostIP&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.1&#34;</span>}]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;kind&#34;</span>:<span style=color:#b44>&#34;None&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;metadata&#34;</span>:{<span style=color:green;font-weight:700>&#34;name&#34;</span>:<span style=color:#b44>&#34;127.0.0.2&#34;</span>},
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;status&#34;</span>:{
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;capacity&#34;</span>:{<span style=color:green;font-weight:700>&#34;cpu&#34;</span>:<span style=color:#b44>&#34;8&#34;</span>},
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>&#34;addresses&#34;</span>:[
</span></span><span style=display:flex><span>          {<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;LegacyHostIP&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.2&#34;</span>},
</span></span><span style=display:flex><span>          {<span style=color:green;font-weight:700>&#34;type&#34;</span>: <span style=color:#b44>&#34;another&#34;</span>, <span style=color:green;font-weight:700>&#34;address&#34;</span>:<span style=color:#b44>&#34;127.0.0.3&#34;</span>}
</span></span><span style=display:flex><span>        ]
</span></span><span style=display:flex><span>      }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ],
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>&#34;users&#34;</span>:[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;myself&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;user&#34;</span>: {}
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;name&#34;</span>: <span style=color:#b44>&#34;e2e&#34;</span>,
</span></span><span style=display:flex><span>      <span style=color:green;font-weight:700>&#34;user&#34;</span>: {<span style=color:green;font-weight:700>&#34;username&#34;</span>: <span style=color:#b44>&#34;admin&#34;</span>, <span style=color:green;font-weight:700>&#34;password&#34;</span>: <span style=color:#b44>&#34;secret&#34;</span>}
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>  ]
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><table><thead><tr><th>Fonction</th><th>Description</th><th>Exemple</th><th>Résultat</th></tr></thead><tbody><tr><td><code>text</code></td><td>le texte en clair</td><td><code>le type est {.kind}</code></td><td><code>le type est List</code></td></tr><tr><td><code>@</code></td><td>l'objet courant</td><td><code>{@}</code></td><td>identique à l'entrée</td></tr><tr><td><code>.</code> ou <code>[]</code></td><td>opérateur fils</td><td><code>{.kind}</code>, <code>{['kind']}</code> ou <code>{['name\.type']}</code></td><td><code>List</code></td></tr><tr><td><code>..</code></td><td>descente récursive</td><td><code>{..name}</code></td><td><code>127.0.0.1 127.0.0.2 myself e2e</code></td></tr><tr><td><code>*</code></td><td>joker. Tous les objets</td><td><code>{.items[*].metadata.name}</code></td><td><code>[127.0.0.1 127.0.0.2]</code></td></tr><tr><td><code>[start:end:step]</code></td><td>opérateur d'indice</td><td><code>{.users[0].name}</code></td><td><code>myself</code></td></tr><tr><td><code>[,]</code></td><td>opérateur d'union</td><td><code>{.items[*]['metadata.name', 'status.capacity']}</code></td><td><code>127.0.0.1 127.0.0.2 map[cpu:4] map[cpu:8]</code></td></tr><tr><td><code>?()</code></td><td>filtre</td><td><code>{.users[?(@.name=="e2e")].user.password}</code></td><td><code>secret</code></td></tr><tr><td><code>range</code>, <code>end</code></td><td>itération de liste</td><td><code>{range .items[*]}[{.metadata.name}, {.status.capacity}] {end}</code></td><td><code>[127.0.0.1, map[cpu:4]] [127.0.0.2, map[cpu:8]]</code></td></tr><tr><td><code>''</code></td><td>protège chaîne interprétée</td><td><code>{range .items[*]}{.metadata.name}{'\t'}{end}</code></td><td><code>127.0.0.1 127.0.0.2</code></td></tr></tbody></table><p>Exemples utilisant <code>kubectl</code> et des expressions JSONPath :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>kubectl get pods -o json
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{@}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[0]}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[0].metadata.name}&#39;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;{.items[*][&#39;metadata.name&#39;, &#39;status.capacity&#39;]}&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -o<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{.metadata.name}{&#34;\t&#34;}{.status.startTime}{&#34;\n&#34;}{end}&#39;</span>
</span></span></code></pre></div><div class="alert alert-info note callout" role=alert><strong>Note:</strong><p>Sous Windows, vous devez utiliser des guillemets <em>doubles</em> autour des modèles JSONPath qui contiennent des espaces (et non des guillemets simples comme ci-dessus pour bash). Ceci entraîne que vous devez utiliser un guillemet simple ou un double guillemet échappé autour des chaînes litérales dans le modèle. Par exemple :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cmd data-lang=cmd><span style=display:flex><span>kubectl get pods -o=jsonpath=<span style=color:#b44>&#34;{range .items[*]}{.metadata.name}{&#39;\t&#39;}{.status.startTime}{&#39;\n&#39;}{end}&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -o=jsonpath=<span style=color:#b44>&#34;{range .items[*]}{.metadata.name}{\&#34;</span>\t\<span style=color:#b44>&#34;}{.status.startTime}{\&#34;</span>\n\<span style=color:#b44>&#34;}{end}&#34;</span>
</span></span></code></pre></div></div></div><div class=td-content style=page-break-before:always><h1 id=pg-8aba901ac13f124e5782b90ddb166ee2>3 - Aide-mémoire kubectl</h1><div class=lead>Cheatsheet kubectl aide-mémoire</div><p>Voir aussi : <a href=/docs/reference/kubectl/overview/>Aperçu Kubectl</a> et <a href=/docs/reference/kubectl/jsonpath>Guide JsonPath</a>.</p><p>Cette page donne un aperçu de la commande <code>kubectl</code>.</p><h1 id=aide-mémoire-kubectl>Aide-mémoire kubectl</h1><h2 id=auto-complétion-avec-kubectl>Auto-complétion avec Kubectl</h2><h3 id=bash>BASH</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion bash<span style=color:#666>)</span> <span style=color:#080;font-style:italic># active l&#39;auto-complétion pour bash dans le shell courant, le paquet bash-completion devant être installé au préalable</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;source &lt;(kubectl completion bash)&#34;</span> &gt;&gt; ~/.bashrc <span style=color:#080;font-style:italic># ajoute l&#39;auto-complétion de manière permanente à votre shell bash</span>
</span></span></code></pre></div><p>Vous pouvez de plus déclarer un alias pour <code>kubectl</code> qui fonctionne aussi avec l'auto-complétion :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>alias</span> <span style=color:#b8860b>k</span><span style=color:#666>=</span>kubectl
</span></span><span style=display:flex><span><span style=color:#a2f>complete</span> -o default -F __start_kubectl k
</span></span></code></pre></div><h3 id=zsh>ZSH</h3><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#a2f>source</span> &lt;<span style=color:#666>(</span>kubectl completion zsh<span style=color:#666>)</span>  <span style=color:#080;font-style:italic># active l&#39;auto-complétion pour zsh dans le shell courant</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#b44>&#34;[[ </span><span style=color:#b8860b>$commands</span><span style=color:#b44>[kubectl] ]] &amp;&amp; source &lt;(kubectl completion zsh)&#34;</span> &gt;&gt; ~/.zshrc <span style=color:#080;font-style:italic># ajoute l&#39;auto-complétion de manière permanente à votre shell zsh</span>
</span></span></code></pre></div><h2 id=contexte-et-configuration-de-kubectl>Contexte et configuration de Kubectl</h2><p>Indique avec quel cluster Kubernetes <code>kubectl</code> communique et modifie les informations de configuration. Voir la documentation <a href=/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>Authentification multi-clusters avec kubeconfig</a> pour des informations détaillées sur le fichier de configuration.
Information. Voir la documentation <a href=/docs/tasks/access-application-cluster/configure-access-multiple-clusters/>Authentification à travers des clusters avec kubeconfig</a>
pour des informations détaillées sur le fichier de configuration.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl config view <span style=color:#080;font-style:italic># Affiche les paramètres fusionnés de kubeconfig</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Utilise plusieurs fichiers kubeconfig en même temps et affiche la configuration fusionnée</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>KUBECONFIG</span><span style=color:#666>=</span>~/.kube/config:~/.kube/kubconfig2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config view
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche le mot de passe pour l&#39;utilisateur e2e</span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[?(@.name == &#34;e2e&#34;)].user.password}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[].name}&#39;</span>  <span style=color:#080;font-style:italic># Affiche le premier utilisateur</span>
</span></span><span style=display:flex><span>kubectl config view -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.users[*].name}&#39;</span> <span style=color:#080;font-style:italic># Affiche une liste d&#39;utilisateurs</span>
</span></span><span style=display:flex><span>kubectl config get-contexts                        <span style=color:#080;font-style:italic># Affiche la liste des contextes</span>
</span></span><span style=display:flex><span>kubectl config current-context                     <span style=color:#080;font-style:italic># Affiche le contexte courant (current-context)</span>
</span></span><span style=display:flex><span>kubectl config use-context my-cluster-name         <span style=color:#080;font-style:italic># Définit my-cluster-name comme contexte courant</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Ajoute un nouveau cluster à votre kubeconf, prenant en charge l&#39;authentification de base (basic auth)</span>
</span></span><span style=display:flex><span>kubectl config set-credentials kubeuser/foo.kubernetes.com --username<span style=color:#666>=</span>kubeuser --password<span style=color:#666>=</span>kubepassword
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Enregistre de manière permanente le namespace pour toutes les commandes kubectl suivantes dans ce contexte</span>
</span></span><span style=display:flex><span>kubectl config set-context --current --namespace<span style=color:#666>=</span>ggckad-s2
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Définit et utilise un contexte qui utilise un nom d&#39;utilisateur et un namespace spécifiques</span>
</span></span><span style=display:flex><span>kubectl config set-context gce --user<span style=color:#666>=</span>cluster-admin --namespace<span style=color:#666>=</span>foo <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  <span style=color:#666>&amp;&amp;</span> kubectl config use-context gce
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl config <span style=color:#a2f>unset</span> users.foo                       <span style=color:#080;font-style:italic># Supprime l&#39;utilisateur foo</span>
</span></span></code></pre></div><h2 id=apply>Apply</h2><p><code>apply</code> gère des applications en utilisant des fichiers définissant des ressources Kubernetes. Elle crée et met à jour des ressources dans un cluster en exécutant <code>kubectl apply</code>. C'est la manière recommandée de gérer des applications Kubernetes en production. Voir le <a href=https://kubectl.docs.kubernetes.io>Livre Kubectl</a>.</p><h2 id=création-d-objets>Création d'objets</h2><p>Les manifests Kubernetes peuvent être définis en YAML ou JSON. Les extensions de fichier <code>.yaml</code>,
<code>.yml</code>, et <code>.json</code> peuvent être utilisés.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl apply -f ./my-manifest.yaml            <span style=color:#080;font-style:italic># Crée une ou plusieurs ressources</span>
</span></span><span style=display:flex><span>kubectl apply -f ./my1.yaml -f ./my2.yaml      <span style=color:#080;font-style:italic># Crée depuis plusieurs fichiers</span>
</span></span><span style=display:flex><span>kubectl apply -f ./dir                         <span style=color:#080;font-style:italic># Crée une ou plusieurs ressources depuis tous les manifests dans dir</span>
</span></span><span style=display:flex><span>kubectl apply -f https://git.io/vPieo          <span style=color:#080;font-style:italic># Crée une ou plusieurs ressources depuis une url</span>
</span></span><span style=display:flex><span>kubectl create deployment nginx --image<span style=color:#666>=</span>nginx  <span style=color:#080;font-style:italic># Démarre une instance unique de nginx</span>
</span></span><span style=display:flex><span>kubectl explain pods                           <span style=color:#080;font-style:italic># Affiche la documentation pour les manifests pod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Crée plusieurs objets YAML depuis l&#39;entrée standard (stdin)</span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: busybox-sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>  - name: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    image: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    args:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>    - &#34;1000000&#34;
</span></span></span><span style=display:flex><span><span style=color:#b44>---
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: busybox-sleep-less
</span></span></span><span style=display:flex><span><span style=color:#b44>spec:
</span></span></span><span style=display:flex><span><span style=color:#b44>  containers:
</span></span></span><span style=display:flex><span><span style=color:#b44>  - name: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    image: busybox
</span></span></span><span style=display:flex><span><span style=color:#b44>    args:
</span></span></span><span style=display:flex><span><span style=color:#b44>    - sleep
</span></span></span><span style=display:flex><span><span style=color:#b44>    - &#34;1000&#34;
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Crée un Secret contenant plusieurs clés</span>
</span></span><span style=display:flex><span>cat <span style=color:#b44>&lt;&lt;EOF | kubectl apply -f -
</span></span></span><span style=display:flex><span><span style=color:#b44>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#b44>kind: Secret
</span></span></span><span style=display:flex><span><span style=color:#b44>metadata:
</span></span></span><span style=display:flex><span><span style=color:#b44>  name: mysecret
</span></span></span><span style=display:flex><span><span style=color:#b44>type: Opaque
</span></span></span><span style=display:flex><span><span style=color:#b44>data:
</span></span></span><span style=display:flex><span><span style=color:#b44>  password: $(echo -n &#34;s33msi4&#34; | base64 -w0)
</span></span></span><span style=display:flex><span><span style=color:#b44>  username: $(echo -n &#34;jane&#34; | base64 -w0)
</span></span></span><span style=display:flex><span><span style=color:#b44>EOF</span>
</span></span></code></pre></div><h2 id=visualisation-et-recherche-de-ressources>Visualisation et Recherche de ressources</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># Commandes Get avec un affichage basique</span>
</span></span><span style=display:flex><span>kubectl get services                     <span style=color:#080;font-style:italic># Liste tous les services d&#39;un namespace</span>
</span></span><span style=display:flex><span>kubectl get pods --all-namespaces        <span style=color:#080;font-style:italic># Liste tous les Pods de tous les namespaces</span>
</span></span><span style=display:flex><span>kubectl get pods -o wide                 <span style=color:#080;font-style:italic># Liste tous les Pods du namespace courant, avec plus de détails</span>
</span></span><span style=display:flex><span>kubectl get deployment my-dep            <span style=color:#080;font-style:italic># Liste un déploiement particulier</span>
</span></span><span style=display:flex><span>kubectl get pods                         <span style=color:#080;font-style:italic># Liste tous les Pods dans un namespace</span>
</span></span><span style=display:flex><span>kubectl get pod my-pod -o yaml           <span style=color:#080;font-style:italic># Affiche le YAML du Pod</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Commandes Describe avec un affichage verbeux</span>
</span></span><span style=display:flex><span>kubectl describe nodes my-node
</span></span><span style=display:flex><span>kubectl describe pods my-pod
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste les services triés par nom</span>
</span></span><span style=display:flex><span>kubectl get services --sort-by<span style=color:#666>=</span>.metadata.name
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste les pods classés par nombre de redémarrages</span>
</span></span><span style=display:flex><span>kubectl get pods --sort-by<span style=color:#666>=</span><span style=color:#b44>&#39;.status.containerStatuses[0].restartCount&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche les volumes persistants classés par capacité de stockage</span>
</span></span><span style=display:flex><span>kubectl get pv --sort-by<span style=color:#666>=</span>.spec.capacity.storage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche la version des labels de tous les pods ayant un label app=cassandra</span>
</span></span><span style=display:flex><span>kubectl get pods --selector<span style=color:#666>=</span><span style=color:#b8860b>app</span><span style=color:#666>=</span>cassandra -o <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>  <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[*].metadata.labels.version}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche tous les noeuds (en utilisant un sélecteur pour exclure ceux ayant un label</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># nommé &#39;node-role.kubernetes.io/master&#39;)</span>
</span></span><span style=display:flex><span>kubectl get node --selector<span style=color:#666>=</span><span style=color:#b44>&#39;!node-role.kubernetes.io/master&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche tous les pods en cours d&#39;exécution (Running) dans le namespace</span>
</span></span><span style=display:flex><span>kubectl get pods --field-selector<span style=color:#666>=</span>status.phase<span style=color:#666>=</span>Running
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche les IPs externes (ExternalIPs) de tous les noeuds</span>
</span></span><span style=display:flex><span>kubectl get nodes -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{.items[*].status.addresses[?(@.type==&#34;ExternalIP&#34;)].address}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste les noms des pods appartenant à un ReplicationController particulier</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># &#34;jq&#34; est une commande utile pour des transformations non prises en charge par jsonpath, il est disponible ici : https://stedolan.github.io/jq/</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>sel</span><span style=color:#666>=</span><span style=color:#b68;font-weight:700>${</span><span style=color:#a2f;font-weight:700>$(</span>kubectl get rc my-rc --output<span style=color:#666>=</span>json | jq -j <span style=color:#b44>&#39;.spec.selector | to_entries | .[] | &#34;\(.key)=\(.value),&#34;&#39;</span><span style=color:#a2f;font-weight:700>)</span>%?<span style=color:#b68;font-weight:700>}</span>
</span></span><span style=display:flex><span><span style=color:#a2f>echo</span> <span style=color:#a2f;font-weight:700>$(</span>kubectl get pods --selector<span style=color:#666>=</span><span style=color:#b8860b>$sel</span> --output<span style=color:#666>=</span><span style=color:#b8860b>jsonpath</span><span style=color:#666>={</span>.items..metadata.name<span style=color:#666>}</span><span style=color:#a2f;font-weight:700>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Affiche les labels pour tous les pods (ou tout autre objet Kubernetes prenant en charge les labels)</span>
</span></span><span style=display:flex><span>kubectl get pods --show-labels
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Vérifie quels noeuds sont prêts</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>JSONPATH</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*]}{@.metadata.name}:{range @.status.conditions[*]}{@.type}={@.status};{end}{end}&#39;</span> <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span> <span style=color:#666>&amp;&amp;</span> kubectl get nodes -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#34;</span><span style=color:#b8860b>$JSONPATH</span><span style=color:#b44>&#34;</span> | grep <span style=color:#b44>&#34;Ready=True&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste tous les Secrets actuellement utilisés par un pod</span>
</span></span><span style=display:flex><span>kubectl get pods -o json | jq <span style=color:#b44>&#39;.items[].spec.containers[].env[]?.valueFrom.secretKeyRef.name&#39;</span> | grep -v null | sort | uniq
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste les containerIDs des initContainer de tous les Pods</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Utile lors du nettoyage des conteneurs arrêtés, tout en évitant de retirer les initContainers.</span>
</span></span><span style=display:flex><span>kubectl get pods --all-namespaces -o <span style=color:#b8860b>jsonpath</span><span style=color:#666>=</span><span style=color:#b44>&#39;{range .items[*].status.initContainerStatuses[*]}{.containerID}{&#34;\n&#34;}{end}&#39;</span> | cut -d/ -f3
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Liste les événements (Events) classés par timestamp</span>
</span></span><span style=display:flex><span>kubectl get events --sort-by<span style=color:#666>=</span>.metadata.creationTimestamp
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Compare l&#39;état actuel du cluster à l&#39;état du cluster si le manifeste était appliqué.</span>
</span></span><span style=display:flex><span>kubectl diff -f ./my-manifest.yaml
</span></span></code></pre></div><h2 id=mise-à-jour-de-ressources>Mise à jour de ressources</h2><p>Depuis la version 1.11, <code>rolling-update</code> a été déprécié (voir <a href=https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG/CHANGELOG-1.11.md>CHANGELOG-1.11.md</a>), utilisez plutôt <code>rollout</code>.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl <span style=color:#a2f>set</span> image deployment/frontend <span style=color:#b8860b>www</span><span style=color:#666>=</span>image:v2               <span style=color:#080;font-style:italic># Rolling update du conteneur &#34;www&#34; du déploiement &#34;frontend&#34;, par mise à jour de son image</span>
</span></span><span style=display:flex><span>kubectl rollout <span style=color:#a2f>history</span> deployment/frontend                      <span style=color:#080;font-style:italic># Vérifie l&#39;historique de déploiements incluant la révision</span>
</span></span><span style=display:flex><span>kubectl rollout undo deployment/frontend                         <span style=color:#080;font-style:italic># Rollback du déploiement précédent</span>
</span></span><span style=display:flex><span>kubectl rollout undo deployment/frontend --to-revision<span style=color:#666>=</span><span style=color:#666>2</span>         <span style=color:#080;font-style:italic># Rollback à une version spécifique</span>
</span></span><span style=display:flex><span>kubectl rollout status -w deployment/frontend                    <span style=color:#080;font-style:italic># Écoute (Watch) le status du rolling update du déploiement &#34;frontend&#34; jusqu&#39;à ce qu&#39;il se termine</span>
</span></span><span style=display:flex><span>kubectl rollout restart deployment/frontend                      <span style=color:#080;font-style:italic># Rolling restart du déploiement &#34;frontend&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cat pod.json | kubectl replace -f -                              <span style=color:#080;font-style:italic># Remplace un pod, en utilisant un JSON passé en entrée standard</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Remplace de manière forcée (Force replace), supprime puis re-crée la ressource. Provoque une interruption de service.</span>
</span></span><span style=display:flex><span>kubectl replace --force -f ./pod.json
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Crée un service pour un nginx repliqué, qui rend le service sur le port 80 et se connecte aux conteneurs sur le port 8000</span>
</span></span><span style=display:flex><span>kubectl expose rc nginx --port<span style=color:#666>=</span><span style=color:#666>80</span> --target-port<span style=color:#666>=</span><span style=color:#666>8000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Modifie la version (tag) de l&#39;image du conteneur unique du pod à v4</span>
</span></span><span style=display:flex><span>kubectl get pod mypod -o yaml | sed <span style=color:#b44>&#39;s/\(image: myimage\):.*$/\1:v4/&#39;</span> | kubectl replace -f -
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl label pods my-pod new-label<span style=color:#666>=</span>awesome                      <span style=color:#080;font-style:italic># Ajoute un Label</span>
</span></span><span style=display:flex><span>kubectl annotate pods my-pod icon-url<span style=color:#666>=</span>http://goo.gl/XXBTWq       <span style=color:#080;font-style:italic># Ajoute une annotation</span>
</span></span><span style=display:flex><span>kubectl autoscale deployment foo --min<span style=color:#666>=</span><span style=color:#666>2</span> --max<span style=color:#666>=</span><span style=color:#666>10</span>                <span style=color:#080;font-style:italic># Mise à l&#39;échelle automatique (Auto scale) d&#39;un déploiement &#34;foo&#34;</span>
</span></span></code></pre></div><h2 id=mise-à-jour-partielle-de-ressources>Mise à jour partielle de ressources</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># Mise à jour partielle d&#39;un node</span>
</span></span><span style=display:flex><span>kubectl patch node k8s-node-1 -p <span style=color:#b44>&#39;{&#34;spec&#34;:{&#34;unschedulable&#34;:true}}&#39;</span> <span style=color:#080;font-style:italic># Met à jour partiellement un noeud</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Met à jour l&#39;image d&#39;un conteneur ; spec.containers[*].name est requis car c&#39;est une clé du merge</span>
</span></span><span style=display:flex><span>kubectl patch pod valid-pod -p <span style=color:#b44>&#39;{&#34;spec&#34;:{&#34;containers&#34;:[{&#34;name&#34;:&#34;kubernetes-serve-hostname&#34;,&#34;image&#34;:&#34;new image&#34;}]}}&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Met à jour l&#39;image d&#39;un conteneur en utilisant un patch json avec tableaux indexés</span>
</span></span><span style=display:flex><span>kubectl patch pod valid-pod --type<span style=color:#666>=</span><span style=color:#b44>&#39;json&#39;</span> -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;replace&#34;, &#34;path&#34;: &#34;/spec/containers/0/image&#34;, &#34;value&#34;:&#34;new image&#34;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Désactive la livenessProbe d&#39;un déploiement en utilisant un patch json avec tableaux indexés</span>
</span></span><span style=display:flex><span>kubectl patch deployment valid-deployment  --type json   -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;remove&#34;, &#34;path&#34;: &#34;/spec/template/spec/containers/0/livenessProbe&#34;}]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Ajoute un nouvel élément à un tableau indexé</span>
</span></span><span style=display:flex><span>kubectl patch sa default --type<span style=color:#666>=</span><span style=color:#b44>&#39;json&#39;</span> -p<span style=color:#666>=</span><span style=color:#b44>&#39;[{&#34;op&#34;: &#34;add&#34;, &#34;path&#34;: &#34;/secrets/1&#34;, &#34;value&#34;: {&#34;name&#34;: &#34;whatever&#34; } }]&#39;</span>
</span></span></code></pre></div><h2 id=édition-de-ressources>Édition de ressources</h2><p>Édite n'importe quelle ressource de l'API dans un éditeur.</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl edit svc/docker-registry                      <span style=color:#080;font-style:italic># Édite le service nommé docker-registry</span>
</span></span><span style=display:flex><span><span style=color:#b8860b>KUBE_EDITOR</span><span style=color:#666>=</span><span style=color:#b44>&#34;nano&#34;</span> kubectl edit svc/docker-registry   <span style=color:#080;font-style:italic># Utilise un autre éditeur</span>
</span></span></code></pre></div><h2 id=mise-à-l-échelle-de-ressources>Mise à l'échelle de ressources</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>3</span> rs/foo                                 <span style=color:#080;font-style:italic># Scale un replicaset nommé &#39;foo&#39; à 3</span>
</span></span><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>3</span> -f foo.yaml                            <span style=color:#080;font-style:italic># Scale une ressource spécifiée dans foo.yaml&#34; à 3</span>
</span></span><span style=display:flex><span>kubectl scale --current-replicas<span style=color:#666>=</span><span style=color:#666>2</span> --replicas<span style=color:#666>=</span><span style=color:#666>3</span> deployment/mysql  <span style=color:#080;font-style:italic># Si la taille du déploiement nommé mysql est actuellement 2, scale mysql à 3</span>
</span></span><span style=display:flex><span>kubectl scale --replicas<span style=color:#666>=</span><span style=color:#666>5</span> rc/foo rc/bar rc/baz                   <span style=color:#080;font-style:italic># Scale plusieurs contrôleurs de réplication</span>
</span></span></code></pre></div><h2 id=suppression-de-ressources>Suppression de ressources</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl delete -f ./pod.json                                              <span style=color:#080;font-style:italic># Supprime un pod en utilisant le type et le nom spécifiés dans pod.json</span>
</span></span><span style=display:flex><span>kubectl delete pod,service baz foo                                        <span style=color:#080;font-style:italic># Supprime les pods et services ayant les mêmes noms &#34;baz&#34; et &#34;foo&#34;</span>
</span></span><span style=display:flex><span>kubectl delete pods,services -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel                              <span style=color:#080;font-style:italic># Supprime les pods et services ayant le label name=myLabel</span>
</span></span><span style=display:flex><span>kubectl -n my-ns delete pod,svc --all                                     <span style=color:#080;font-style:italic># Supprime tous les pods et services dans le namespace my-ns</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Supprime tous les pods correspondants à pattern1 ou pattern2 avec awk</span>
</span></span><span style=display:flex><span>kubectl get pods  -n mynamespace --no-headers<span style=color:#666>=</span><span style=color:#a2f>true</span> | awk <span style=color:#b44>&#39;/pattern1|pattern2/{print $1}&#39;</span> | xargs  kubectl delete -n mynamespace pod
</span></span></code></pre></div><h2 id=interaction-avec-des-pods-en-cours-d-exécution>Interaction avec des Pods en cours d'exécution</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl logs my-pod                                 <span style=color:#080;font-style:italic># Affiche les logs du pod (stdout)</span>
</span></span><span style=display:flex><span>kubectl logs -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel                        <span style=color:#080;font-style:italic># Affiche les logs des pods ayant le label name=myLabel (stdout)</span>
</span></span><span style=display:flex><span>kubectl logs my-pod --previous                      <span style=color:#080;font-style:italic># Affiche les logs du pod (stdout) pour une instance précédente du conteneur</span>
</span></span><span style=display:flex><span>kubectl logs my-pod -c my-container                 <span style=color:#080;font-style:italic># Affiche les logs d&#39;un conteneur particulier du pod (stdout, cas d&#39;un pod multi-conteneurs)</span>
</span></span><span style=display:flex><span>kubectl logs -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel -c my-container        <span style=color:#080;font-style:italic># Affiche les logs des pods avec le label name=myLabel (stdout, cas d&#39;un pod multi-conteneurs)</span>
</span></span><span style=display:flex><span>kubectl logs my-pod -c my-container --previous      <span style=color:#080;font-style:italic># Affiche les logs d&#39;un conteneur particulier du pod (stdout, cas d&#39;un pod multi-conteneurs) pour une instance précédente du conteneur</span>
</span></span><span style=display:flex><span>kubectl logs -f my-pod                              <span style=color:#080;font-style:italic># Fait défiler (stream) les logs du pod (stdout)</span>
</span></span><span style=display:flex><span>kubectl logs -f my-pod -c my-container              <span style=color:#080;font-style:italic># Fait défiler (stream) les logs d&#39;un conteneur particulier du pod (stdout, cas d&#39;un pod multi-conteneurs)</span>
</span></span><span style=display:flex><span>kubectl logs -f -l <span style=color:#b8860b>name</span><span style=color:#666>=</span>myLabel --all-containers    <span style=color:#080;font-style:italic># Fait défiler (stream) les logs de tous les pods ayant le label name=myLabel (stdout)</span>
</span></span><span style=display:flex><span>kubectl run -i --tty busybox --image<span style=color:#666>=</span>busybox -- sh  <span style=color:#080;font-style:italic># Exécute un pod comme un shell interactif</span>
</span></span><span style=display:flex><span>kubectl run nginx --image<span style=color:#666>=</span>nginx --restart<span style=color:#666>=</span>Never -n
</span></span><span style=display:flex><span>mynamespace                                         <span style=color:#080;font-style:italic># Exécute le pod nginx dans un namespace spécifique</span>
</span></span><span style=display:flex><span>kubectl run nginx --image<span style=color:#666>=</span>nginx --restart<span style=color:#666>=</span>Never     <span style=color:#080;font-style:italic># Simule l&#39;exécution du pod nginx et écrit sa spécification dans un fichier pod.yaml</span>
</span></span><span style=display:flex><span>--dry-run -o yaml &gt; pod.yaml
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>kubectl attach my-pod -i                            <span style=color:#080;font-style:italic># Attache à un conteneur en cours d&#39;exécution</span>
</span></span><span style=display:flex><span>kubectl port-forward my-pod 5000:6000               <span style=color:#080;font-style:italic># Écoute le port 5000 de la machine locale et forwarde vers le port 6000 de my-pod</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> my-pod -- ls /                         <span style=color:#080;font-style:italic># Exécute une commande dans un pod existant (cas d&#39;un seul conteneur)</span>
</span></span><span style=display:flex><span>kubectl <span style=color:#a2f>exec</span> my-pod -c my-container -- ls /         <span style=color:#080;font-style:italic># Exécute une commande dans un pod existant (cas multi-conteneurs)</span>
</span></span><span style=display:flex><span>kubectl top pod POD_NAME --containers               <span style=color:#080;font-style:italic># Affiche les métriques pour un pod donné et ses conteneurs</span>
</span></span></code></pre></div><h2 id=interaction-avec-des-noeuds-et-clusters>Interaction avec des Noeuds et Clusters</h2><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl cordon mon-noeud                                              <span style=color:#080;font-style:italic># Marque mon-noeud comme non assignable (unschedulable)</span>
</span></span><span style=display:flex><span>kubectl drain mon-noeud                                               <span style=color:#080;font-style:italic># Draine mon-noeud en préparation d&#39;une mise en maintenance</span>
</span></span><span style=display:flex><span>kubectl uncordon mon-noeud                                            <span style=color:#080;font-style:italic># Marque mon-noeud comme assignable</span>
</span></span><span style=display:flex><span>kubectl top node mon-noeud                                            <span style=color:#080;font-style:italic># Affiche les métriques pour un noeud donné</span>
</span></span><span style=display:flex><span>kubectl cluster-info                                                  <span style=color:#080;font-style:italic># Affiche les adresses du master et des services</span>
</span></span><span style=display:flex><span>kubectl cluster-info dump                                             <span style=color:#080;font-style:italic># Affiche l&#39;état courant du cluster sur stdout</span>
</span></span><span style=display:flex><span>kubectl cluster-info dump --output-directory<span style=color:#666>=</span>/path/to/cluster-state   <span style=color:#080;font-style:italic># Affiche l&#39;état courant du cluster sur /path/to/cluster-state</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Si une teinte avec cette clé et cet effet existe déjà, sa valeur est remplacée comme spécifié.</span>
</span></span><span style=display:flex><span>kubectl taint nodes foo <span style=color:#b8860b>dedicated</span><span style=color:#666>=</span>special-user:NoSchedule
</span></span></code></pre></div><h3 id=types-de-ressources>Types de ressources</h3><p>Liste tous les types de ressources pris en charge avec leurs noms courts (shortnames), <a href=/docs/concepts/overview/kubernetes-api/#api-groups>groupe d'API (API group)</a>, si elles sont <a href=/docs/concepts/overview/working-with-objects/namespaces>cantonnées à un namespace (namespaced)</a>, et leur <a href=/docs/concepts/overview/working-with-objects/kubernetes-objects>Genre (Kind)</a>:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl api-resources
</span></span></code></pre></div><p>Autres opérations pour explorer les ressources de l'API :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>kubectl api-resources --namespaced<span style=color:#666>=</span><span style=color:#a2f>true</span>      <span style=color:#080;font-style:italic># Toutes les ressources cantonnées à un namespace</span>
</span></span><span style=display:flex><span>kubectl api-resources --namespaced<span style=color:#666>=</span><span style=color:#a2f>false</span>     <span style=color:#080;font-style:italic># Toutes les ressources non cantonnées à un namespace</span>
</span></span><span style=display:flex><span>kubectl api-resources -o name                <span style=color:#080;font-style:italic># Toutes les ressources avec un affichage simple (uniquement le nom de la ressource)</span>
</span></span><span style=display:flex><span>kubectl api-resources -o wide                <span style=color:#080;font-style:italic># Toutes les ressources avec un affichage étendu (alias &#34;wide&#34;)</span>
</span></span><span style=display:flex><span>kubectl api-resources --verbs<span style=color:#666>=</span>list,get       <span style=color:#080;font-style:italic># Toutes les ressources prenant en charge les verbes de requête &#34;list&#34; et &#34;get&#34;</span>
</span></span><span style=display:flex><span>kubectl api-resources --api-group<span style=color:#666>=</span>extensions <span style=color:#080;font-style:italic># Toutes les ressources dans le groupe d&#39;API &#34;extensions&#34;</span>
</span></span></code></pre></div><h3 id=formattage-de-l-affichage>Formattage de l'affichage</h3><p>Pour afficher les détails sur votre terminal dans un format spécifique, utilisez l'option <code>-o</code> (ou <code>--output</code>) avec les commandes <code>kubectl</code> qui la prend en charge.</p><table><thead><tr><th>Format d'affichage</th><th>Description</th></tr></thead><tbody><tr><td><code>-o=custom-columns=&lt;spec></code></td><td>Affiche un tableau en spécifiant une liste de colonnes séparées par des virgules</td></tr><tr><td><code>-o=custom-columns-file=&lt;filename></code></td><td>Affiche un tableau en utilisant les colonnes spécifiées dans le fichier <code>&lt;filename></code></td></tr><tr><td><code>-o=json</code></td><td>Affiche un objet de l'API formaté en JSON</td></tr><tr><td><code>-o=jsonpath=&lt;template></code></td><td>Affiche les champs définis par une expression <a href=/docs/reference/kubectl/jsonpath>jsonpath</a></td></tr><tr><td><code>-o=jsonpath-file=&lt;filename></code></td><td>Affiche les champs définis par l'expression <a href=/docs/reference/kubectl/jsonpath>jsonpath</a> dans le fichier <code>&lt;filename></code></td></tr><tr><td><code>-o=name</code></td><td>Affiche seulement le nom de la ressource et rien de plus</td></tr><tr><td><code>-o=wide</code></td><td>Affiche dans le format texte avec toute information supplémentaire, et pour des pods, le nom du noeud est inclus</td></tr><tr><td><code>-o=yaml</code></td><td>Affiche un objet de l'API formaté en YAML</td></tr></tbody></table><p>Exemples utilisant <code>-o=custom-columns</code> :</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#080;font-style:italic># Toutes les images s&#39;exécutant dans un cluster</span>
</span></span><span style=display:flex><span>kubectl get pods -A -o<span style=color:#666>=</span>custom-columns<span style=color:#666>=</span><span style=color:#b44>&#39;DATA:spec.containers[*].image&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span> <span style=color:#080;font-style:italic># Toutes les images excepté &#34;k8s.gcr.io/coredns:1.6.2&#34;</span>
</span></span><span style=display:flex><span>kubectl get pods -A -o<span style=color:#666>=</span>custom-columns<span style=color:#666>=</span><span style=color:#b44>&#39;DATA:spec.containers[?(@.image!=&#34;k8s.gcr.io/coredns:1.6.2&#34;)].image&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># Tous les champs dans metadata quel que soit leur nom</span>
</span></span><span style=display:flex><span>kubectl get pods -A -o<span style=color:#666>=</span>custom-columns<span style=color:#666>=</span><span style=color:#b44>&#39;DATA:metadata.*&#39;</span>
</span></span></code></pre></div><p>Plus d'exemples dans la <a href=/fr/docs/reference/kubectl/overview/#colonnes-personnalis%C3%A9es>documentation de référence</a> de kubectl.</p><h3 id=verbosité-de-l-affichage-de-kubectl-et-débogage>Verbosité de l'affichage de Kubectl et débogage</h3><p>La verbosité de Kubectl est contrôlée par une des options <code>-v</code> ou <code>--v</code> suivie d'un entier représentant le niveau de log. Les conventions générales de logging de Kubernetes et les niveaux de log associés sont décrits <a href=https://github.com/kubernetes/community/blob/master/contributors/devel/sig-instrumentation/logging.md>ici</a>.</p><table><thead><tr><th>Verbosité</th><th>Description</th></tr></thead><tbody><tr><td><code>--v=0</code></td><td>Le minimum qui doit <em>toujours</em> être affiché à un opérateur.</td></tr><tr><td><code>--v=1</code></td><td>Un niveau de log par défaut raisonnable si vous n'avez pas besoin de verbosité.</td></tr><tr><td><code>--v=2</code></td><td>Informations utiles sur l'état stable du service et messages de logs importants qui peuvent être corrélés à des changements significatifs dans le système. C'est le niveau de log par défaut recommandé pour la plupart des systèmes.</td></tr><tr><td><code>--v=3</code></td><td>Informations étendues sur les changements.</td></tr><tr><td><code>--v=4</code></td><td>Verbosité de Debug.</td></tr><tr><td><code>--v=6</code></td><td>Affiche les ressources requêtées.</td></tr><tr><td><code>--v=7</code></td><td>Affiche les entêtes des requêtes HTTP.</td></tr><tr><td><code>--v=8</code></td><td>Affiche les contenus des requêtes HTTP.</td></tr><tr><td><code>--v=9</code></td><td>Affiche les contenus des requêtes HTTP sans les tronquer.</td></tr></tbody></table><h2 id=a-suivre>A suivre</h2><ul><li><p>En savoir plus sur l'<a href=/docs/reference/kubectl/overview/>Aperçu de kubectl</a>.</p></li><li><p>Voir les options <a href=/docs/reference/kubectl/kubectl/>kubectl</a>.</p></li><li><p>Voir aussi les <a href=/docs/reference/kubectl/conventions/>Conventions d'usage de kubectl</a> pour comprendre comment l'utiliser dans des scripts réutilisables.</p></li><li><p>Voir plus d'<a href=https://github.com/dennyzhang/cheatsheet-kubernetes-A4>aides-mémoire kubectl</a>.</p></li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-d7ffbf04ffbefb241fd0722423b80f5a>4 - Commandes kubectl</h1><div class=lead>Commandes kubectl</div><p><a href=/docs/reference/generated/kubectl/kubectl-commands/>Référence des commandes kubectl</a></p></div><div class=td-content style=page-break-before:always><h1 id=pg-8de6aceb8bf692c06cced446bac5bc92>5 - Conventions d'utilisation de kubectl</h1><div class=lead>kubectl conventions</div><p>Conventions d'utilisation recommandées pour <code>kubectl</code>.</p><h2 id=utiliser-kubectl-dans-des-scripts-réutilisables>Utiliser <code>kubectl</code> dans des scripts réutilisables</h2><p>Pour une sortie stable dans un script :</p><ul><li>Demandez un des formats de sortie orienté machine, comme <code>-o name</code>, <code>-o json</code>, <code>-o yaml</code>, <code>-o go-template</code> ou <code>-o jsonpath</code>.</li><li>Spécifiez complètement la version. Par exemple, <code>jobs.v1.batch/monjob</code>. Cela va assurer que kubectl n'utilise pas sa version par défaut, qui risque d'évoluer avec le temps.</li><li>Ne vous basez pas sur un contexte, des préférences ou tout autre état implicite.</li></ul><h2 id=bonnes-pratiques>Bonnes pratiques</h2><h3 id=kubectl-run><code>kubectl run</code></h3><p>Pour que <code>kubectl run</code> satisfasse l'infrastructure as code :</p><ul><li>Taggez les images avec un tag spécifique à une version et n'utilisez pas ce tag pour une nouvelle version. Par exemple, utilisez <code>:v1234</code>, <code>v1.2.3</code>, <code>r03062016-1-4</code>, plutôt que <code>:latest</code> (Pour plus d'informations, voir <a href=/docs/concepts/configuration/overview/#container-images>Bonnes pratiques pour la configuration</a>).</li><li>Capturez le script pour une image fortement paramétrée.</li><li>Passez à des fichiers de configuration enregistrés dans un système de contrôle de source pour des fonctionnalités désirées mais non exprimables avec des flags de <code>kubectl run</code>.</li></ul><p>Vous pouvez utiliser l'option <code>--dry-run</code> pour prévisualiser l'objet qui serait envoyé à votre cluster, sans réellement l'envoyer.</p><div class="alert alert-info note callout" role=alert><strong>Note:</strong> Tous les générateurs <code>kubectl</code> sont dépréciés. Voir la documentation de Kubernetes v1.17 pour une <a href=https://v1-17.docs.kubernetes.io/fr/docs/reference/kubectl/conventions/#g%C3%A9n%C3%A9rateurs>liste</a> de générateurs et comment ils étaient utilisés.</div><h4 id=générateurs>Générateurs</h4><p>Vous pouvez générer les ressources suivantes avec une commande kubectl, <code>kubectl create --dry-run -o yaml</code>:</p><pre tabindex=0><code>  clusterrole         Crée un ClusterRole.
  clusterrolebinding  Crée un ClusterRoleBinding pour un ClusterRole particulier.
  configmap           Crée une configmap à partir d&#39;un fichier local, un répertoire ou une valeur litérale.
  cronjob             Crée un cronjob avec le nom spécifié.
  deployment          Crée un deployment avec le nom spécifié.
  job                 Crée un job avec le nom spécifié.
  namespace           Crée un namespace avec le nom spécifié.
  poddisruptionbudget Crée un pod disruption budget avec le nom spécifié.
  priorityclass       Crée une priorityclass avec le nom spécifié.
  quota               Crée un quota avec le nom spécifié.
  role                Crée un role avec une unique règle.
  rolebinding         Crée un RoleBinding pour un Role ou ClusterRole particulier.
  secret              Crée un secret en utilisant la sous-commande spécifiée.
  service             Crée un service en utilisant la sous-commande spécifiée.
  serviceaccount      Crée un service account avec le nom spécifié.
</code></pre><h3 id=kubectl-apply><code>kubectl apply</code></h3><ul><li>Vous pouvez utiliser <code>kubectl apply</code> pour créer ou mettre à jour des ressources. Pour plus d'informations sur l'utilisation de <code>kubectl apply</code> pour la mise à jour de ressources, voir le <a href=https://kubectl.docs.kubernetes.io>livre Kubectl</a>.</li></ul></div><div class=td-content style=page-break-before:always><h1 id=pg-4d3e62632c189fcc3c1357cd8fb8799c>6 - kubectl</h1><div class=lead>Référence kubectl</div><h2 id=synopsis>Synopsis</h2><p>kubectl contrôle le manager d'un cluster Kubernetes</p><p>Vous trouverez plus d'informations ici : <a href=https://kubernetes.io/fr/docs/reference/kubectl/overview/>https://kubernetes.io/fr/docs/reference/kubectl/overview/</a></p><pre tabindex=0><code>kubectl [flags]
</code></pre><h2 id=options>Options</h2><table style=width:100%;table-layout:fixed><col span=1 style=width:10px><col span=1><tbody><tr><td colspan=2>--add-dir-header</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si vrai, ajoute le répertoire du fichier à l'entête</td></tr><tr><td colspan=2>--alsologtostderr</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>log sur l'erreur standard en plus d'un fichier</td></tr><tr><td colspan=2>--application-metrics-count-limit int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : 100</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nombre max de métriques d'applications à stocker (par conteneur)</td></tr><tr><td colspan=2>--as chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nom d'utilisateur à utiliser pour l'opération</td></tr><tr><td colspan=2>--as-group tableauDeChaînes</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Groupe à utiliser pour l'opération, ce flag peut être répété pour spécifier plusieurs groupes</td></tr><tr><td colspan=2>--azure-container-registry-config chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Chemin du fichier contenant les informations de configuration du registre de conteneurs Azure</td></tr><tr><td colspan=2>--boot-id-file string&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "/proc/sys/kernel/random/boot_id"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Liste séparée par des virgules de fichiers dans lesquels rechercher le boot-id. Utilise le premier trouvé.</td></tr><tr><td colspan=2>--cache-dir chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: "/home/karen/.kube/http-cache"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Répertoire de cache HTTP par défaut</td></tr><tr><td colspan=2>--certificate-authority chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Chemin vers un fichier cert pour l'autorité de certification</td></tr><tr><td colspan=2>--client-certificate chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Chemin vers un fichier de certificat client pour TLS</td></tr><tr><td colspan=2>--client-key chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Chemin vers un fichier de clé client pour TLS</td></tr><tr><td colspan=2>--cloud-provider-gce-lb-src-cidrs cidrs&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: 130.211.0.0/22,209.85.152.0/22,209.85.204.0/22,35.191.0.0/16</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>CIDRs ouverts dans le firewall GCE pour le proxy de trafic LB & health checks</td></tr><tr><td colspan=2>--cluster chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Le nom du cluster kubeconfig à utiliser</td></tr><tr><td colspan=2>--container-hints chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "/etc/cadvisor/container_hints.json"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>location du fichier hints du conteneur</td></tr><tr><td colspan=2>--containerd chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "/run/containerd/containerd.sock"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Point de terminaison de containerd</td></tr><tr><td colspan=2>--containerd-namespace chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "k8s.io"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>namespace de containerd</td></tr><tr><td colspan=2>--context chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Le nom du contexte kubeconfig à utiliser</td></tr><tr><td colspan=2>--default-not-ready-toleration-seconds int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: 300</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Indique les tolerationSeconds de la tolérance pour notReady:NoExecute qui sont ajoutées par défaut à tous les pods qui n'ont pas défini une telle tolérance</td></tr><tr><td colspan=2>--default-unreachable-toleration-seconds int&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: 300</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Indique les tolerationSeconds de la tolérance pour unreachable:NoExecute qui sont ajoutées par défaut à tous les pods qui n'ont pas défini une telle tolérance</td></tr><tr><td colspan=2>--disable-root-cgroup-stats</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Désactive la collecte des stats du Cgroup racine</td></tr><tr><td colspan=2>--docker chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "unix:///var/run/docker.sock"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Point de terminaison docker</td></tr><tr><td colspan=2>--docker-env-metadata-whitelist chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>une liste séparée par des virgules de variables d'environnement qui doivent être collectées pour les conteneurs docker</td></tr><tr><td colspan=2>--docker-only</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Remonte uniquement les stats Docker en plus des stats racine</td></tr><tr><td colspan=2>--docker-root chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "/var/lib/docker"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>DÉPRÉCIÉ : la racine de docker est lue depuis docker info (ceci est une solution de secours, défaut : /var/lib/docker)</td></tr><tr><td colspan=2>--docker-tls</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>utiliser TLS pour se connecter à docker</td></tr><tr><td colspan=2>--docker-tls-ca chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "ca.pem"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>chemin vers CA de confiance</td></tr><tr><td colspan=2>--docker-tls-cert chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "cert.pem"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>chemin vers le certificat client</td></tr><tr><td colspan=2>--docker-tls-key chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "key.pem"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>chemin vers la clef privée</td></tr><tr><td colspan=2>--enable-load-reader</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Activer le lecteur de la charge CPU</td></tr><tr><td colspan=2>--event-storage-age-limit chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "default=0"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Durée maximale pendant laquelle stocker les événements (par type). La valeur est une liste séparée par des virgules de clefs/valeurs, où les clefs sont des types d'événements (par ex: creation, oom) ou "default" et la valeur est la durée. La valeur par défaut est appliquée à tous les types d'événements non spécifiés</td></tr><tr><td colspan=2>--event-storage-event-limit chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "default=0"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nombre max d'événements à stocker (par type). La valeur est une liste séparée par des virgules de clefs/valeurs, où les clefs sont les types d'événements (par ex: creation, oom) ou "default" et la valeur est un entier. La valeur par défaut est appliquée à tous les types d'événements non spécifiés</td></tr><tr><td colspan=2>--global-housekeeping-interval durée&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : 1m0s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Intevalle entre ménages globaux</td></tr><tr><td colspan=2>-h, --help</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>aide pour kubectl</td></tr><tr><td colspan=2>--housekeeping-interval durée&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : 10s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Intervalle entre ménages des conteneurs</td></tr><tr><td colspan=2>--insecure-skip-tls-verify</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si vrai, la validité du certificat du serveur ne sera pas vérifiée. Ceci rend vos connexions HTTPS non sécurisées</td></tr><tr><td colspan=2>--kubeconfig chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Chemin du fichier kubeconfig à utiliser pour les requêtes du CLI</td></tr><tr><td colspan=2>--log-backtrace-at traceLocation&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: :0</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>lorsque les logs arrivent à la ligne fichier:N, émet une stack trace</td></tr><tr><td colspan=2>--log-cadvisor-usage</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Activer les logs d'usage du conteneur cAdvisor</td></tr><tr><td colspan=2>--log-dir chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si non vide, écrit les fichiers de log dans ce répertoire</td></tr><tr><td colspan=2>--log-file chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si non vide, utilise ce fichier de log</td></tr><tr><td colspan=2>--log-file-max-size uint&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : 1800</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Définit la taille maximale d'un fichier de log. L'unité est le mega-octet. Si la valeur est 0, la taille de fichier maximale est illimitée.</td></tr><tr><td colspan=2>--log-flush-frequency durée&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: 5s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nombre de secondes maximum entre flushs des logs</td></tr><tr><td colspan=2>--logtostderr&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: true</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>log sur l'erreur standard plutôt que dans un fichier</td></tr><tr><td colspan=2>--machine-id-file chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "/etc/machine-id,/var/lib/dbus/machine-id"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>liste séparée par des virgules de fichiers dans lesquels rechercher le machine-id. Utiliser le premier trouvé.</td></tr><tr><td colspan=2>--match-server-version</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>La version du serveur doit correspondre à la version du client</td></tr><tr><td colspan=2>-n, --namespace chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si présent, la portée de namespace pour la requête du CLI</td></tr><tr><td colspan=2>--password chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Mot de passe pour l'authentification de base au serveur d'API</td></tr><tr><td colspan=2>--profile chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: "none"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nom du profil à capturer. Parmi (none|cpu|heap|goroutine|threadcreate|block|mutex)</td></tr><tr><td colspan=2>--profile-output chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: "profile.pprof"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nom du fichier dans lequel écrire le profil</td></tr><tr><td colspan=2>--request-timeout chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: "0"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>La durée à attendre avant d'abandonner une requête au serveur. Les valeurs non égales à zéro doivent contenir une unité de temps correspondante (ex 1s, 2m, 3h). Une valeur à zéro indique de ne pas abandonner les requêtes</td></tr><tr><td colspan=2>-s, --server chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>L'adresse et le port de l'API server Kubernetes</td></tr><tr><td colspan=2>--skip-headers</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si vrai, n'affiche pas les entêtes dans les messages de log</td></tr><tr><td colspan=2>--skip-log-headers</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Si vrai, évite les entêtes lors de l'ouverture des fichiers de log</td></tr><tr><td colspan=2>--stderrthreshold sévérité&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut: 2</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>logs à cette sévérité et au dessus de ce seuil vont dans stderr</td></tr><tr><td colspan=2>--storage-driver-buffer-duration durée&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : 1m0s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Les écritures dans le driver de stockage seront bufferisés pour cette durée, et seront envoyés aux backends non-mémoire en une seule transaction</td></tr><tr><td colspan=2>--storage-driver-db chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "cadvisor"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>nom de la base de données</td></tr><tr><td colspan=2>--storage-driver-host chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "localhost:8086"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>hôte:port de la base de données</td></tr><tr><td colspan=2>--storage-driver-password chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "root"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Mot de passe de la base de données</td></tr><tr><td colspan=2>--storage-driver-secure</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>utiliser une connexion sécurisée avec la base de données</td></tr><tr><td colspan=2>--storage-driver-table chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "stats"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nom de la table dans la base de données</td></tr><tr><td colspan=2>--storage-driver-user chaîne&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : "root"</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>nom d'utilisateur de la base de données</td></tr><tr><td colspan=2>--token chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Bearer token pour l'authentification auprès de l'API server</td></tr><tr><td colspan=2>--update-machine-info-interval durée&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Défaut : 5m0s</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Intevalle entre mises à jour des infos machine.</td></tr><tr><td colspan=2>--user chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Le nom de l'utilisateur kubeconfig à utiliser</td></tr><tr><td colspan=2>--username chaîne</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Nom d'utilisateur pour l'authentification de base au serveur d'API</td></tr><tr><td colspan=2>-v, --v Niveau</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Niveau de verbosité des logs</td></tr><tr><td colspan=2>--version version[=true]</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Affiche les informations de version et quitte</td></tr><tr><td colspan=2>--vmodule moduleSpec</td></tr><tr><td></td><td style=line-height:130%;word-wrap:break-word>Liste de settings pattern=N séparés par des virgules pour le logging filtré par fichiers</td></tr></tbody></table><h2 id=see-also>See Also</h2><ul><li><a href=/docs/reference/generated/kubectl/kubectl-commands#alpha>kubectl alpha</a> - Commandes pour fonctionnalités alpha</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#annotate>kubectl annotate</a> - Met à jour les annotations d'une ressource</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#api-resources>kubectl api-resources</a> - Affiche les ressources de l'API prises en charge sur le serveur</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#api-versions>kubectl api-versions</a> - Affiche les versions de l'API prises en charge sur le serveur, sous la forme "groupe/version"</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#apply>kubectl apply</a> - Applique une configuration à une ressource depuis un fichier ou stdin</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#attach>kubectl attach</a> - Attache à un conteneur en cours d'exécution</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#auth>kubectl auth</a> - Inspecte les autorisations</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#autoscale>kubectl autoscale</a> - Auto-scale un Deployment, ReplicaSet, ou ReplicationController</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#certificate>kubectl certificate</a> - Modifie des ressources certificat</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#cluster-info>kubectl cluster-info</a> - Affiche les informations du cluster</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#completion>kubectl completion</a> - Génère le code de complétion pour le shell spécifié (bash ou zsh)</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#config>kubectl config</a> - Modifie les fichiers kubeconfig</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#convert>kubectl convert</a> - Convertit des fichiers de config entre différentes versions d'API</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#cordon>kubectl cordon</a> - Marque un nœud comme non assignable (unschedulable)</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#cp>kubectl cp</a> - Copie des fichiers et répertoires depuis et vers des conteneurs</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#create>kubectl create</a> - Crée une ressource depuis un fichier ou stdin</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#delete>kubectl delete</a> - Supprime des ressources par fichiers ou stdin, par ressource et nom, ou par ressource et sélecteur de label</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#describe>kubectl describe</a> - Affiche les informations d'une ressource spécifique ou d'un groupe de ressources</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#diff>kubectl diff</a> - Différence entre la version live et la version désirée</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#drain>kubectl drain</a> - Draine un nœud en préparation d'une mise en maintenance</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#edit>kubectl edit</a> - Édite une ressource du serveur</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#exec>kubectl exec</a> - Exécute une commande dans un conteneur</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#explain>kubectl explain</a> - Documentation sur les ressources</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#expose>kubectl expose</a> - Prend un replication controller, service, deployment ou pod et l'expose comme un nouveau Service Kubernetes</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#get>kubectl get</a> - Affiche une ou plusieurs ressources</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#kustomize>kubectl kustomize</a> - Construit une cible kustomization à partir d'un répertoire ou d'une URL distante.</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#label>kubectl label</a> - Met à jour les labels d'une ressource</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#logs>kubectl logs</a> - Affiche les logs d'un conteneur dans un pod</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#options>kubectl options</a> - Affiche la liste des flags hérités par toutes les commandes</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#patch>kubectl patch</a> - Met à jour un ou plusieurs champs d'une ressource par merge patch stratégique</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#plugin>kubectl plugin</a> - Fournit des utilitaires pour interagir avec des plugins</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#port-forward>kubectl port-forward</a> - Redirige un ou plusieurs ports vers un pod</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#proxy>kubectl proxy</a> - Exécute un proxy vers l'API server Kubernetes</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#replace>kubectl replace</a> - Remplace une ressource par fichier ou stdin</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#rollout>kubectl rollout</a> - Gère le rollout d'une ressource</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#run>kubectl run</a> - Exécute une image donnée dans le cluster</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#scale>kubectl scale</a> - Définit une nouvelle taille pour un Deployment, ReplicaSet ou Replication Controller</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#set>kubectl set</a> - Définit des fonctionnalités spécifiques sur des objets</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#taint>kubectl taint</a> - Met à jour les marques (taints) sur un ou plusieurs nœuds</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#top>kubectl top</a> - Affiche l'utilisation de ressources matérielles (CPU/Memory/Storage)</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#uncordon>kubectl uncordon</a> - Marque un nœud comme assignable (schedulable)</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#version>kubectl version</a> - Affiche les informations de version du client et du serveur</li><li><a href=/docs/reference/generated/kubectl/kubectl-commands#wait>kubectl wait</a> - Expérimental : Attend une condition particulière sur une ou plusieurs ressources</li></ul></div></main></div></div><footer class=d-print-none><div class=footer__links><nav><a class=text-white href=/fr/docs/home/>Accueil</a>
<a class=text-white href=/fr/blog/>Blog</a>
<a class=text-white href=/fr/partners/>Partenaires</a>
<a class=text-white href=/fr/community/>Communauté</a>
<a class=text-white href=/fr/case-studies/>Études de cas</a></nav></div><div class=container-fluid><div class=row><div class="col-6 col-sm-2 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="User mailing list" aria-label="User mailing list"><a class=text-white target=_blank href=https://discuss.kubernetes.io><i class="fa fa-envelope"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter><a class=text-white target=_blank href=https://twitter.com/kubernetesio><i class="fab fa-twitter"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Calendar aria-label=Calendar><a class=text-white target=_blank href="https://calendar.google.com/calendar/embed?src=calendar%40kubernetes.io"><i class="fas fa-calendar-alt"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Youtube aria-label=Youtube><a class=text-white target=_blank href=https://youtube.com/kubernetescommunity><i class="fab fa-youtube"></i></a></li></ul></div><div class="col-6 col-sm-2 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank href=https://github.com/kubernetes/kubernetes><i class="fab fa-github"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Slack aria-label=Slack><a class=text-white target=_blank href=https://slack.k8s.io><i class="fab fa-slack"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Contribute aria-label=Contribute><a class=text-white target=_blank href=https://git.k8s.io/community/contributors/guide><i class="fas fa-edit"></i></a></li><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Stack Overflow" aria-label="Stack Overflow"><a class=text-white target=_blank href=https://stackoverflow.com/questions/tagged/kubernetes><i class="fab fa-stack-overflow"></i></a></li></ul></div><div class="col-12 col-sm-8 text-center order-sm-2"><small class=text-white>&copy; 2023 The Kubernetes Authors | Documentation Distributed under <a href=https://git.k8s.io/website/LICENSE class=light-text>CC BY 4.0</a></small><br><small class=text-white>Copyright &copy; 2023 The Linux Foundation &reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our <a href=https://www.linuxfoundation.org/trademark-usage class=light-text>Trademark Usage page</a></small><br><small class=text-white>ICP license: 京ICP备17074266号-3</small></div></div></div></footer></div><script src=/js/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script src=/js/popper-1.16.1.min.js intregrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=/js/bootstrap-4.6.1.min.js integrity=sha384-VHvPCCyXqtD5DqJeNxl2dtTyhF78xXNXdkwX1CZeRusQfRKp+tA7hAShOK/B/fQ2 crossorigin=anonymous></script>
<script src=/js/script.js></script>
<script async src=/js/mermaid-8.13.4.min.js integrity=sha384-5hHNvPeMrNH14oM3IcQofDoBhiclNK3g2+hnEinKzQ07C4AliMeVpnvxuiwEGpaO crossorigin=anonymous></script>
<script src=/js/main.min.5c0bf7f21dc4f66485f74efbbeeff28a7e4f8cddaac1bae47043159c922ff3a3.js integrity="sha256-XAv38h3E9mSF9077vu/yin5PjN2qwbrkcEMVnJIv86M=" crossorigin=anonymous></script></body></html>